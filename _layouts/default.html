<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% if page.title %}{{ page.title }} - {{ site.title }}{% else %}{{ site.title }}{% endif %}</title>
    <meta name="description" content="{% if page.description %}{{ page.description }}{% else %}{{ site.description }}{% endif %}">
    <meta name="robots" content="index, follow">
    
    <!-- Canonical URL -->
    {% if page.canonical_url %}
    <link rel="canonical" href="{{ page.canonical_url }}">
    {% else %}
    <link rel="canonical" href="{{ page.url | absolute_url }}">
    {% endif %}
    
    <!-- Open Graph -->
    <meta property="og:title" content="{% if page.title %}{{ page.title }}{% else %}{{ site.title }}{% endif %}">
    <meta property="og:description" content="{% if page.description %}{{ page.description }}{% else %}{{ site.description }}{% endif %}">
    <meta property="og:type" content="{% if page.layout == 'post' %}article{% else %}website{% endif %}">
    <meta property="og:url" content="{{ page.url | absolute_url }}">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{% if page.title %}{{ page.title }}{% else %}{{ site.title }}{% endif %}">
    <meta name="twitter:description" content="{% if page.description %}{{ page.description }}{% else %}{{ site.description }}{% endif %}">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{{ '/favicon.ico' | relative_url }}">
    
    <!-- CSS -->
    <link rel="stylesheet" href="{{ '/assets/css/main.css' | relative_url }}">
    <link rel="stylesheet" href="{{ '/assets/css/blog.css' | relative_url }}">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Montserrat:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    {% include header.html %}
    
    <!-- Main Content -->
    <main class="main-content">
        {{ content }}
    </main>
    
    <!-- Footer -->
    {% include footer.html %}
    
    <!-- Scroll to top button -->
    <button class="icon-btn scroll-to-top" id="scrollToTop" aria-label="Scroll to top">
        <i class="fas fa-arrow-up"></i>
    </button>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>

    <!-- JavaScript -->
    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyB9hr0IWM4EREzkKDxBxYoYinV6LJXWXV4",
            authDomain: "specify-ai.firebaseapp.com",
            projectId: "specify-ai",
            storageBucket: "specify-ai.firebasestorage.app",
            messagingSenderId: "734278787482",
            appId: "1:734278787482:web:0e312fb6f197e849695a23",
            measurementId: "G-4YR9LK63MR"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();

        // Auth UI functions
        function updateAuthUI(user) {
            const authButtons = document.getElementById('auth-buttons');
            if (!authButtons) return;
            
            if (user) {
                // User is logged in
                const displayName = user.displayName || user.email.split('@')[0];
                const firstLetter = displayName.charAt(0).toUpperCase();
                
                authButtons.innerHTML = `
                    <div class="user-dropdown">
                        <div class="user-info" onclick="toggleUserDropdown()">
                            <div class="user-avatar">${firstLetter}</div>
                            <span>${displayName}</span>
                        </div>
                        <div class="user-dropdown-content">
                            <a href="{{ '/pages/profile.html' | relative_url }}">Profile</a>
                            <button onclick="logout()">Sign Out</button>
                        </div>
                    </div>
                `;
            } else {
                // User is not logged in
                authButtons.innerHTML = `
                    <button class="auth-btn" onclick="showLoginModal()">Login</button>
                `;
            }
        }

        // Global auth functions
        window.showLoginModal = function() {
            window.location.href = '{{ "/pages/auth.html" | relative_url }}';
        };

        window.showRegisterModal = function() {
            window.location.href = '{{ "/pages/auth.html" | relative_url }}';
        };

        window.logout = function() {
            auth.signOut()
                .then(() => {
                    console.log('Logged out successfully');
                })
                .catch(error => {
                    console.error('Error logging out:', error);
                });
        };

        window.toggleUserDropdown = function() {
            const dropdown = document.querySelector('.user-dropdown-content');
            if (dropdown && dropdown.classList.contains('show')) {
                dropdown.classList.remove('show');
            } else if (dropdown) {
                dropdown.classList.add('show');
            }
        };

        // Close user dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const userDropdown = document.querySelector('.user-dropdown');
            const userInfo = document.querySelector('.user-info');
            const dropdown = document.querySelector('.user-dropdown-content');
            
            if (userDropdown && dropdown && dropdown.classList.contains('show') && 
                !userInfo.contains(event.target)) {
                dropdown.classList.remove('show');
            }
        });

        // Listen to auth state changes
        auth.onAuthStateChanged((user) => {
            updateAuthUI(user);
        });

        // Initialize auth buttons with default state
        document.addEventListener('DOMContentLoaded', function() {
            const authButtons = document.getElementById('auth-buttons');
            if (authButtons && !authButtons.innerHTML.trim()) {
                authButtons.innerHTML = `
                    <button class="auth-btn login-btn">Login</button>
                `;
                
                const loginBtn = authButtons.querySelector('.login-btn');
                if (loginBtn) {
                    loginBtn.addEventListener('click', function(event) {
                        event.stopPropagation();
                        window.location.href = '{{ "/pages/auth.html" | relative_url }}';
                    });
                }
            }
        });

        // Scroll to top functionality
        document.addEventListener('DOMContentLoaded', function() {
            const scrollToTopBtn = document.getElementById('scrollToTop');
            
            if (scrollToTopBtn) {
                scrollToTopBtn.addEventListener("click", () => {
                    window.scrollTo({ top: 0, behavior: "smooth" });
                });
                
                // Show/hide scroll to top button
                window.addEventListener("scroll", () => {
                    if (window.scrollY > 300) {
                        scrollToTopBtn.style.display = "flex";
                    } else {
                        scrollToTopBtn.style.display = "none";
                    }
                });
            }
        });
    </script>
</body>
</html>

