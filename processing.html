<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Answer guided questions to refine your app idea and generate a detailed specification with specifys.ai.">
  <meta name="keywords" content="processing app idea, guided questions, AI specification, app development, specifys.ai">
  <meta name="author" content="specifys.ai Team">
  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow">
  <meta name="bingbot" content="index, follow">
  <meta name="revisit-after" content="7 days">
  <meta name="language" content="English">
  <meta name="copyright" content="Â© 2025 specifys.ai">
  <meta name="publisher" content="specifys.ai">
  <meta name="distribution" content="global">
  <meta name="rating" content="general">
  <meta name="theme-color" content="#0078d4">
  <meta property="og:title" content="specifys.ai - Processing Your Idea">
  <meta property="og:description" content="Answer guided questions to refine your app idea and generate a detailed specification with specifys.ai.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://specifys.ai/processing.html">
  <meta property="og:image" content="https://specifys.ai/assets/og-image.jpg">
  <meta property="og:image:alt" content="Processing Your Idea with specifys.ai">
  <meta property="og:site_name" content="Specifys.ai">
  <meta property="og:locale" content="en_US">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="specifys.ai - Processing Your Idea">
  <meta name="twitter:description" content="Answer guided questions to refine your app idea and generate a detailed specification with specifys.ai.">
  <meta name="twitter:image" content="https://specifys.ai/assets/og-image.jpg">
  <meta name="twitter:site" content="@specifys_ai">
  <meta name="twitter:creator" content="@specifys_ai">
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "headline": "specifys.ai - Processing Your Idea",
      "description": "Answer guided questions to refine your app idea and generate a detailed specification with specifys.ai.",
      "image": "https://specifys.ai/assets/og-image.jpg",
      "author": {
        "@type": "Organization",
        "name": "specifys.ai Team"
      },
      "publisher": {
        "@type": "Organization",
        "name": "Specifys.ai",
        "logo": {
          "@type": "ImageObject",
          "url": "https://specifys.ai/assets/logo.png"
        }
      },
      "url": "https://specifys.ai/processing.html",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://specifys.ai/processing.html"
      },
      "keywords": "processing app idea, guided questions, AI specification, app development, specifys.ai"
    }
  </script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-RWBT69JCM7');
    gtag('config', 'AW-1000505244');
  </script>
  <title>specifys.ai - Processing Your Idea</title>
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="stylesheet" href="common-header-footer.css">
  <script defer src="https://unpkg.com/jspdf@latest/dist/jspdf.umd.min.js"></script>
  <script defer src="processing.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;700&display=swap');

    :root {
      --bg-color: #f8f9fa;
      --text-color: #333;
      --primary-color: #0078d4;
      --secondary-color: #6c757d;
      --light-gray: #e9ecef;
      --border-color: #dee2e6;
      --chat-bg: #fff;
      --system-msg-bg: #f8f9fa;
      --user-msg-bg: #0078d4;
      --user-msg-text: #fff;
      --input-bg: #fff;
      --input-border: #dee2e6;
      --button-hover: #005ea2;
      --progress-bg: #e9ecef;
      --progress-fill: #0078d4;
      --header-bg: rgba(255, 255, 255, 0.9);
      --header-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      --chat-header-bg: #0078d4;
      --chat-header-text: #fff;
    }

    /* Dark Mode Variables */
    body.dark-mode {
      --bg-color: #1a1a1a;
      --text-color: #e0e0e0;
      --primary-color: #0078d4;
      --secondary-color: #999;
      --light-gray: #2a2a2a;
      --border-color: #444;
      --chat-bg: #2a2a2a;
      --system-msg-bg: #333;
      --user-msg-bg: #0078d4;
      --user-msg-text: #fff;
      --input-bg: #333;
      --input-border: #555;
      --button-hover: #005ea2;
      --progress-bg: #444;
      --progress-fill: #0078d4;
      --header-bg: rgba(30, 30, 30, 0.9);
      --header-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      --chat-header-bg: #005ea2;
      --chat-header-text: #fff;
    }

    /* Header Restructuring for Auth System */
    .thematic-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 20px;
      background: var(--header-bg);
      backdrop-filter: blur(10px);
      box-shadow: var(--header-shadow);
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 1000;
      height: 70px;
    }

    .header-left {
      display: flex;
      align-items: center;
    }

    .header-center {
      display: flex;
      align-items: center;
      justify-content: center;
      flex: 1;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .auth-buttons {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .auth-btn {
      padding: 8px 16px;
      border: 1px solid var(--primary-color);
      background: transparent;
      color: var(--primary-color);
      border-radius: 6px;
      text-decoration: none;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 5px;
    }

    .auth-btn:hover {
      background: var(--primary-color);
      color: white;
    }

    .auth-btn.primary {
      background: var(--primary-color);
      color: white;
    }

    .auth-btn.primary:hover {
      background: var(--button-hover);
    }

    .user-info {
      display: flex;
      align-items: center;
      gap: 8px;
      color: var(--text-color);
    }

    .user-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--primary-color);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 14px;
    }

    /* Dark mode overrides for auth system */
    body.dark-mode .auth-btn {
      border-color: var(--primary-color);
      color: var(--primary-color);
    }

    body.dark-mode .auth-btn:hover {
      background: var(--primary-color);
      color: white;
    }

    body.dark-mode .user-info {
      color: var(--text-color);
    }

    body.dark-mode .user-avatar {
      background: var(--primary-color);
      color: white;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Montserrat', sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      line-height: 1.6;
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    /* Header Dark Mode Overrides */
    body.dark-mode .thematic-header {
      background: var(--header-bg) !important;
      box-shadow: var(--header-shadow) !important;
    }

    body.dark-mode .thematic-header .logo a {
      color: #e0e0e0 !important;
    }

    body.dark-mode .theme-toggle,
    body.dark-mode .menu-toggle {
      background: none !important;
      border: none !important;
      color: #e0e0e0 !important;
      box-shadow: none !important;
    }

    body.dark-mode .theme-toggle:hover,
    body.dark-mode .menu-toggle:hover {
      background: rgba(255, 255, 255, 0.1) !important;
      color: #fff !important;
    }

    body.dark-mode .header-links a {
      color: #e0e0e0 !important;
    }

    body.dark-mode .header-links a:hover {
      color: #0078d4 !important;
    }

    .chat-container {
      max-width: 800px;
      margin: 20px auto;
      background: var(--chat-bg);
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      height: calc(100vh - 80px);
      min-height: 700px;
      display: flex;
      flex-direction: column;
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
    }

    body.dark-mode .chat-container {
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
    }

    .chat-header {
      background: var(--chat-header-bg);
      color: var(--chat-header-text);
      padding: 20px;
      text-align: center;
      margin-top: 80px;
      transition: background-color 0.3s ease;
      position: relative;
    }



    .chat-header {
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }

            .back-button {
          position: absolute;
          right: 20px;
          width: 36px;
          height: 36px;
          border: 1px solid var(--chat-header-text);
          background: transparent;
          color: var(--chat-header-text);
          border-radius: 50%;
          cursor: pointer;
          transition: all 0.3s ease;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 18px;
          opacity: 0;
          visibility: hidden;
          transform: scale(0.8);
        }

    .back-button:hover {
      background: var(--chat-header-text);
      color: var(--chat-header-bg);
      transform: scale(1.1);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    .back-button.show {
      opacity: 1;
      visibility: visible;
      transform: scale(1);
    }

            .back-button i {
          font-size: 18px;
        }

    .chat-header h1 {
      font-size: 1.5rem;
      font-weight: 600;
      margin: 0;
      text-align: center;
    }

    .chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
      background: var(--chat-bg);
      transition: background-color 0.3s ease;
    }

    .message {
      margin-bottom: 20px;
      display: flex;
      align-items: flex-start;
      gap: 12px;
      animation: fadeIn 0.3s ease-in;
    }

    .message.system {
      flex-direction: row;
    }

    .message.user {
      flex-direction: row-reverse;
    }

    .message-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      font-weight: 600;
      flex-shrink: 0;
    }

    .message.system .message-avatar {
      background: var(--secondary-color);
      color: white;
    }

    .message.user .message-avatar {
      background: var(--primary-color);
      color: white;
    }

    .message-content {
      flex: 1;
      max-width: 70%;
    }

    .message.system .message-content {
      background: var(--system-msg-bg);
      padding: 16px;
      border-radius: 18px;
      border: 1px solid var(--border-color);
      color: var(--text-color);
      transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
    }

    .message.user .message-content {
      background: var(--user-msg-bg);
      color: var(--user-msg-text);
      padding: 16px;
      border-radius: 18px;
      position: relative;
    }

    .message-text {
      margin-bottom: 12px;
      line-height: 1.5;
    }

    .yes-no-buttons {
      display: flex;
      gap: 12px;
      margin-top: 12px;
    }

    .yes-no-btn {
      padding: 10px 24px;
      border: 2px solid var(--border-color);
      background: var(--input-bg);
      color: var(--text-color);
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.2s ease;
      font-weight: 500;
    }

    .yes-no-btn:hover {
      border-color: var(--primary-color);
      background: var(--primary-color);
      color: white;
    }

    .yes-no-btn.selected {
      border-color: var(--primary-color);
      background: var(--primary-color);
      color: white;
    }

    .message-examples,
    .message-tips {
      background: rgba(255, 255, 255, 0.5);
      padding: 12px;
      border-radius: 8px;
      margin-top: 8px;
      font-size: 0.9rem;
      opacity: 0.7;
      transition: background-color 0.3s ease;
    }

    body.dark-mode .message-examples,
    body.dark-mode .message-tips {
      background: rgba(0, 0, 0, 0.3);
      color: #ccc;
    }

    .message-examples.hidden,
    .message-tips.hidden {
      display: none;
    }

    .chat-input-container {
      padding: 20px;
      background: var(--chat-bg);
      border-top: 1px solid var(--border-color);
      transition: background-color 0.3s ease, border-color 0.3s ease;
    }

    .chat-input-wrapper {
      display: flex;
      gap: 12px;
      align-items: flex-end;
    }

    .chat-input {
      flex: 1;
      padding: 12px 16px;
      border: 2px solid var(--input-border);
      border-radius: 24px;
      font-size: 1rem;
      font-family: inherit;
      resize: none;
      min-height: 48px;
      max-height: 120px;
      transition: border-color 0.2s ease, background-color 0.3s ease, color 0.3s ease;
      background: var(--input-bg);
      color: var(--text-color);
    }

    .chat-input:focus {
      outline: none;
      border-color: var(--primary-color);
    }

    .send-button {
      padding: 12px 24px;
      background: var(--primary-color);
      color: white;
      border: none;
      border-radius: 24px;
      cursor: pointer;
      font-weight: 500;
      transition: background-color 0.2s ease;
      min-width: 80px;
    }

    .send-button:hover {
      background: var(--button-hover);
    }

    .send-button:disabled {
      background: var(--secondary-color);
      cursor: not-allowed;
    }

    .progress-container {
      padding: 0 20px 20px;
      background: var(--chat-bg);
      transition: background-color 0.3s ease;
    }

    .progress-bar {
      width: 100%;
      height: 6px;
      background: var(--progress-bg);
      border-radius: 3px;
      overflow: hidden;
      transition: background-color 0.3s ease;
    }

    .progress-fill {
      height: 100%;
      background: var(--progress-fill);
      transition: width 0.3s ease;
      border-radius: 3px;
    }

    .progress-text {
      text-align: center;
      margin-top: 8px;
      font-size: 0.9rem;
      color: var(--secondary-color);
      transition: color 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @media (max-width: 768px) {
      .chat-container {
        margin: 10px;
        height: calc(100vh - 60px);
        min-height: 600px;
      }
      
      .chat-header {
        padding: 15px;
        margin-top: 60px;
      }
      

      
      .back-button {
        right: 15px;
        width: 34px;
        height: 34px;
        font-size: 16px;
      }
      
      .back-button i {
        font-size: 16px;
      }
      
      .message-content {
        max-width: 85%;
      }
      
      .yes-no-buttons {
        flex-direction: column;
      }
      
      .yes-no-btn {
        text-align: center;
      }
    }
    
    @media (max-width: 480px) {
      .chat-container {
        margin: 5px;
        height: calc(100vh - 40px);
        min-height: 500px;
      }
      
      .back-button {
        right: 12px;
        width: 32px;
        height: 32px;
        font-size: 14px;
      }
      
      .back-button i {
        font-size: 14px;
      }
      
      .chat-header {
        padding: 12px;
        margin-top: 50px;
      }
      

    }
  </style>
</head>
<body>
  <header class="thematic-header" role="banner">
    <div class="header-left">
      <div class="logo">
        <a href="index.html" aria-label="Specifys.ai homepage">Specifys.ai</a>
      </div>
    </div>
    <div class="header-center">
      <div class="auth-buttons" id="auth-buttons">
        <!-- Auth buttons will be populated by JavaScript -->
      </div>
    </div>
    <div class="header-right">
      <button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode"><i class="fas fa-moon"></i></button>
      <button class="menu-toggle" aria-label="Toggle navigation menu" aria-expanded="false"><i class="fas fa-bars"></i></button>
      <div class="header-links">
        <a href="blog.html" aria-label="Visit our blog">Blog</a>
        <a href="about.html" aria-label="Learn more about specifys.ai">About Us</a>
        <a href="how.html" aria-label="Learn how specifys.ai works">How It Works</a>
        <a href="map/vibe-coding-tools-map.html" aria-label="Explore Vibe Coding Tools Map">Vibe Coding Tools Map</a>
        <a href="ToolPicker.html" aria-label="Use our Tool Finder">Tool Finder</a>
      </div>
    </div>
  </header>

  <div class="chat-container">
    <div class="chat-header">
                  <button id="backButton" class="back-button" title="Go back to previous question">
              <i class="fas fa-undo"></i>
            </button>
      <h1>Plan Your App</h1>
      <p>Let's build your app together! Answer a few questions to get started.</p>
    </div>

    <div class="chat-messages" id="chatMessages">
      <!-- Messages will be added here dynamically -->
        </div>

        <div class="progress-container">
          <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-text" id="progressText">Question 1 of 5</div>
  </div>

    <div class="chat-input-container">
      <div class="chat-input-wrapper">
        <textarea 
          class="chat-input" 
          id="chatInput" 
          placeholder="Type your answer here..."
          rows="1"
        ></textarea>
        <button class="send-button" id="sendButton">
          <i class="fas fa-paper-plane"></i>
        </button>
      </div>
    </div>
    </div>

  <script src="common-header-footer.js"></script>

  <!-- Firebase SDK -->
  <script type="module">
    // Import Firebase modules
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js';
    import { 
      getAuth, 
      createUserWithEmailAndPassword, 
      signInWithEmailAndPassword, 
      signOut, 
      signInWithPopup, 
      GoogleAuthProvider,
      onAuthStateChanged 
    } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js';
    import { 
      getFirestore, 
      collection, 
      addDoc, 
      serverTimestamp,
      query,
      where,
      orderBy,
      getDocs
    } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js';

    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyB9hr0IWM4EREzkKDxBxYoYinV6LJXWXV4",
      authDomain: "specify-ai.firebaseapp.com",
      projectId: "specify-ai",
      storageBucket: "specify-ai.firebasestorage.app",
      messagingSenderId: "734278787482",
      appId: "1:734278787482:web:0e312fb6f197e849695a23",
      measurementId: "G-4YR9LK63MR"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // Auto-save function instead of manual save button
    async function autoSaveSpec() {
      if (!auth.currentUser) {
        console.log('User not authenticated, skipping auto-save');
        return;
      }
      
      const specContent = localStorage.getItem('generatedContent');
      if (!specContent) {
        console.log('No spec content to save');
        return;
      }
      
      try {
        // Extract title from spec content
        let title = "App Specification";
        const lines = specContent.split('\n');
        for (let line of lines) {
          line = line.trim();
          if (line.startsWith('# ') || line.startsWith('## ')) {
            title = line.replace(/^#+\s*/, '');
            break;
          } else if (line.length > 10 && line.length < 100) {
            title = line;
            break;
          }
        }
        
        const mode = localStorage.getItem('currentMode') || 'developers';
        const answers = JSON.parse(localStorage.getItem('devAnswers') || '{}');
        
        const specDoc = {
          title: title,
          content: specContent,
          userId: auth.currentUser.uid,
          mode: mode,
          answers: answers,
          createdAt: serverTimestamp(),
          updatedAt: serverTimestamp()
        };
        
        const docRef = await addDoc(collection(db, 'specs'), specDoc);
        console.log('Spec auto-saved successfully:', docRef.id);
        
        // Show small notification
        showSaveNotification();
      } catch (error) {
        console.error('Error auto-saving spec:', error);
      }
    }

    function showSaveNotification() {
      const notification = document.createElement('div');
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: #28a745;
        color: white;
        padding: 10px 20px;
        border-radius: 8px;
        z-index: 1000;
        font-size: 14px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      `;
      notification.textContent = 'Specification auto-saved!';
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.remove();
      }, 3000);
    }

    // Update auth UI
    function updateAuthUI(user) {
      const authButtons = document.getElementById('auth-buttons');
      
      if (user) {
        // User is logged in
        authButtons.innerHTML = `
          <div class="user-info">
            <div class="user-avatar">${user.displayName ? user.displayName.charAt(0).toUpperCase() : user.email.charAt(0).toUpperCase()}</div>
            <span>${user.displayName || user.email.split('@')[0]}</span>
          </div>
          <a href="profile.html" class="auth-btn">Profile</a>
          <button class="auth-btn" onclick="logout()">Logout</button>
        `;
      } else {
        // User is not logged in
        authButtons.innerHTML = `
          <button class="auth-btn" onclick="showLoginModal()">Login</button>
          <button class="auth-btn primary" onclick="showRegisterModal()">Register</button>
        `;
      }
    }

    // Global functions
    window.showLoginModal = function() {
      window.location.href = 'auth.html';
    };

    window.showRegisterModal = function() {
      window.location.href = 'auth.html';
    };

    window.logout = function() {
      signOut(auth)
        .then(() => {
          alert('Logged out successfully');
        })
        .catch(error => {
          alert('Error logging out: ' + error.message);
        });
    };

    // Listen to auth state changes
    onAuthStateChanged(auth, (user) => {
      updateAuthUI(user);
      
      // Auto-save spec if user is authenticated and content exists
      if (user) {
        const specContent = localStorage.getItem('generatedContent');
        if (specContent) {
          setTimeout(() => {
            autoSaveSpec();
          }, 2000); // Wait for page to load
        }
      }
    });
  </script>

  <script>
    // Lightweight Developer Chat to show first question and collect answers
    (function() {
      class DeveloperChat {
        constructor() {
          this.currentQuestionIndex = 0;
          this.answers = {};
          this.questions = [
            { id: 0, name: 'App Purpose', question: 'What is the general purpose and idea of your app?' },
            { id: 1, name: 'User Workflow', question: 'Describe the typical workflow of a user using your app.' },
            { id: 2, name: 'Development Preferences', question: 'What development preferences or constraints do you have (e.g., agile, code style, CI/CD)?' },
            { id: 3, name: 'Technologies', question: 'List the technologies you prefer or must use (languages, frameworks, services).' },
            { id: 4, name: 'Data Information', question: 'What data will be stored or processed (entities, fields, relationships, privacy)?' }
          ];
        }

        init() {
          // Mark current mode
          localStorage.setItem('currentMode', 'developers');

          // Load saved answers if any
          const saved = localStorage.getItem('devAnswers');
          if (saved) {
            try { this.answers = JSON.parse(saved) || {}; } catch (_) { this.answers = {}; }
          }

          // Restore progress
          const keys = Object.keys(this.answers).filter(k => /^(0|1|2|3|4)$/.test(k));
          if (keys.length > 0) {
            // Move index to next unanswered
            for (let i = 0; i < this.questions.length; i++) {
              if (!this.answers[i] || !String(this.answers[i]).trim()) { this.currentQuestionIndex = i; break; }
              this.currentQuestionIndex = i + 1;
            }
          }

          this.setupEvents();
          this.updateProgress();
          this.start();
        }

        setupEvents() {
          const chatInput = document.getElementById('chatInput');
          const sendButton = document.getElementById('sendButton');
          if (!chatInput || !sendButton) return;

          sendButton.addEventListener('click', () => this.handleSend());
          chatInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); this.handleSend(); }
          });
          chatInput.addEventListener('input', () => { this.autoResize(chatInput); sendButton.disabled = !chatInput.value.trim(); });
          // Initial state
          sendButton.disabled = true;
        }

        start() {
          // If there are already answers, re-render them and ask next
          const chatMessages = document.getElementById('chatMessages');
          chatMessages.innerHTML = '';
          for (let i = 0; i < this.currentQuestionIndex; i++) {
            this.addSystem(this.questions[i].question);
            this.addUser(this.answers[i]);
          }
          // Ask current question or show intro messages
          if (this.currentQuestionIndex < this.questions.length) {
            if (this.currentQuestionIndex === 0 && Object.keys(this.answers).length === 0) {
              // First time - show intro messages
              this.showIntroMessages();
            } else {
              // Show current question
              this.addSystem(this.questions[this.currentQuestionIndex].question);
            }
          }
          this.scrollToBottom();
        }

        showIntroMessages() {
          const introMessages = [
            "Hi! ðŸ‘‹",
            "I'm your personal assistant and my job is to help you reach the perfect application!",
            "You can talk to me in any language you want, but for convenience you'll receive the final document in English",
            "Let's start with a few questions to understand your app idea better..."
          ];

          let messageIndex = 0;
          const showNextMessage = () => {
            if (messageIndex < introMessages.length) {
              this.addSystem(introMessages[messageIndex]);
              messageIndex++;
              
              // Show next message after 1.5 seconds
              setTimeout(showNextMessage, 1500);
            } else {
              // After all intro messages, display the first question
              setTimeout(() => {
                this.addSystem(this.questions[this.currentQuestionIndex].question);
                this.scrollToBottom();
              }, 500);
            }
          };

          showNextMessage();
        }

        handleSend() {
          const chatInput = document.getElementById('chatInput');
          const message = (chatInput.value || '').trim();
          if (!message) return;
          const qIndex = this.currentQuestionIndex;
          if (qIndex >= this.questions.length) return;

          // Save and render
          this.answers[qIndex] = message;
          localStorage.setItem('devAnswers', JSON.stringify(this.answers));
          this.addUser(message);
          chatInput.value = '';
          this.autoResize(chatInput);

          // Move to next question or generate
          this.currentQuestionIndex++;
          this.updateProgress();
          if (this.currentQuestionIndex < this.questions.length) {
            setTimeout(() => { this.addSystem(this.questions[this.currentQuestionIndex].question); this.scrollToBottom(); }, 300);
          } else {
            // All answers collected â†’ generate
            setTimeout(() => {
              if (typeof generateSpecificationFromProcessingJs === 'function') {
                generateSpecificationFromProcessingJs();
              }
            }, 500);
          }
        }

        addSystem(text) {
          const chatMessages = document.getElementById('chatMessages');
          const div = document.createElement('div');
          div.className = 'message system';
          div.innerHTML = `<div class="message-avatar">S</div><div class="message-content"><div class="message-text"><strong>${this.escape(text)}</strong></div></div>`;
          chatMessages.appendChild(div);
        }

        addUser(text) {
          const chatMessages = document.getElementById('chatMessages');
          const div = document.createElement('div');
          div.className = 'message user';
          div.innerHTML = `<div class="message-avatar">U</div><div class="message-content"><div class="message-text">${this.escape(text)}</div></div>`;
          chatMessages.appendChild(div);
          this.scrollToBottom();
        }

        updateProgress() {
          const progressFill = document.getElementById('progressFill');
          const progressText = document.getElementById('progressText');
          const total = this.questions.length;
          const current = Math.min(this.currentQuestionIndex + 1, total);
          if (progressFill) progressFill.style.width = `${(current / total) * 100}%`;
          if (progressText) progressText.textContent = `Question ${current} of ${total}`;
        }

        autoResize(textarea) {
          textarea.style.height = 'auto';
          textarea.style.height = Math.min(textarea.scrollHeight, 120) + 'px';
        }

        scrollToBottom() {
          const chatMessages = document.getElementById('chatMessages');
          chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        escape(str) {
          return String(str).replace(/[&<>]/g, s => ({'&':'&amp;','<':'&lt;','>':'&gt;'}[s]));
        }
      }

      document.addEventListener('DOMContentLoaded', () => {
        // Initialize developer chat
        const devChat = new DeveloperChat();
        devChat.init();
      });
    })();
  </script>

  <noscript>
    <div style="text-align: center; padding: 20px; background: #fff; color: #333;">
      <p>This website requires JavaScript to function properly. Please enable JavaScript in your browser settings.</p>
    </div>
  </noscript>
</body>
</html>