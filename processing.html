<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Answer guided questions to refine your app idea and generate a detailed specification with specifys.ai.">
  <meta name="keywords" content="processing app idea, guided questions, AI specification, app development, specifys.ai">
  <meta name="author" content="specifys.ai Team">
  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow">
  <meta name="bingbot" content="index, follow">
  <meta name="revisit-after" content="7 days">
  <meta name="language" content="English">
  <meta name="copyright" content="Â© 2025 specifys.ai">
  <meta name="publisher" content="specifys.ai">
  <meta name="distribution" content="global">
  <meta name="rating" content="general">
  <meta name="theme-color" content="#0078d4">
  <meta property="og:title" content="specifys.ai - Processing Your Idea">
  <meta property="og:description" content="Answer guided questions to refine your app idea and generate a detailed specification with specifys.ai.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://specifys.ai/processing.html">
  <meta property="og:image" content="https://specifys.ai/assets/og-image.jpg">
  <meta property="og:image:alt" content="Processing Your Idea with specifys.ai">
  <meta property="og:site_name" content="Specifys.ai">
  <meta property="og:locale" content="en_US">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="specifys.ai - Processing Your Idea">
  <meta name="twitter:description" content="Answer guided questions to refine your app idea and generate a detailed specification with specifys.ai.">
  <meta name="twitter:image" content="https://specifys.ai/assets/og-image.jpg">
  <meta name="twitter:site" content="@specifys_ai">
  <meta name="twitter:creator" content="@specifys_ai">
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "headline": "specifys.ai - Processing Your Idea",
      "description": "Answer guided questions to refine your app idea and generate a detailed specification with specifys.ai.",
      "image": "https://specifys.ai/assets/og-image.jpg",
      "author": {
        "@type": "Organization",
        "name": "specifys.ai Team"
      },
      "publisher": {
        "@type": "Organization",
        "name": "Specifys.ai",
        "logo": {
          "@type": "ImageObject",
          "url": "https://specifys.ai/assets/logo.png"
        }
      },
      "url": "https://specifys.ai/processing.html",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://specifys.ai/processing.html"
      },
      "keywords": "processing app idea, guided questions, AI specification, app development, specifys.ai"
    }
  </script>
  <title>specifys.ai - Processing Your Idea</title>
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <script defer src="https://unpkg.com/jspdf@latest/dist/jspdf.umd.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <script defer src="processing.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;700&display=swap');

    :root {
      --bg-color: #f5f5f5;
      --text-color: #333;
      --header-bg: rgba(255, 255, 255, 0.9);
      --header-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      --content-bg: #fff;
      --content-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      --textarea-border: #ddd;
      --textarea-bg: #fff;
      --example-button-bg: #fff;
      --example-button-text: #333;
      --progress-bg: #ddd;
      --indicator-text: #333;
      --footer-bg: #fff;
      --footer-shadow: 0 -2px 4px rgba(0, 0, 0, 0.1);
      --footer-text: #333;
      --footer-link: #333;
      --spinner-border: #f3f3f3;
      --tooltip-bg: #333;
      --tooltip-text: #fff;
    }

    [data-theme="dark"] {
      --bg-color: #1a1a1a;
      --text-color: #e0e0e0;
      --header-bg: rgba(30, 30, 30, 0.9);
      --header-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      --content-bg: rgba(30, 30, 30, 0.95);
      --content-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      --textarea-border: #444;
      --textarea-bg: #2a2a2a;
      --example-button-bg: #2a2a2a;
      --example-button-text: #e0e0e0;
      --progress-bg: #444;
      --indicator-text: #e0e0e0;
      --footer-bg: #1a1a1a;
      --footer-shadow: 0 -2px 4px rgba(0, 0, 0, 0.3);
      --footer-text: #e0e0e0;
      --footer-link: #e0e0e0;
      --spinner-border: #444;
      --tooltip-bg: #444;
      --tooltip-text: #fff;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      height: 100%;
    }

    body {
      font-family: 'Montserrat', sans-serif;
      display: flex;
      flex-direction: column;
      min-height: 100%;
      background: var(--bg-color);
      color: var(--text-color);
      transition: background 0.3s ease, color 0.3s ease;
    }

    .thematic-header {
      position: fixed;
      top: 0;
      width: 100%;
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      z-index: 1000;
      background: var(--header-bg);
      box-shadow: var(--header-shadow);
    }

    .thematic-header .logo a {
      text-decoration: none;
      color: var(--text-color);
      font-size: 1.6rem;
      font-weight: 700;
      transition: color 0.3s ease;
    }

    .thematic-header .logo a:hover {
      color: #0078d4;
    }

    .theme-toggle {
      background: none;
      border: none;
      color: var(--text-color);
      font-size: 1.4rem;
      cursor: pointer;
      transition: color 0.3s ease, transform 0.3s ease;
    }

    .theme-toggle:hover {
      color: #0078d4;
      transform: scale(1.2);
    }

    .carousel-container {
      flex-grow: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 5rem 1rem;
      position: relative;
    }

    .carousel-content {
      background: var(--content-bg);
      border-radius: 20px;
      padding: 2rem;
      box-shadow: var(--content-shadow);
      width: 100%;
      max-width: 900px;
      min-height: 400px;
      z-index: 1000;
      position: relative;
      animation: fadeIn 0.3s ease-in-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .step-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    #stepTitle {
      font-size: 2.2rem;
      font-weight: 700;
      color: var(--text-color);
      margin-bottom: 1rem;
      transition: color 0.3s ease;
    }

    #stepTitle:hover {
      color: #0078d4;
    }

    .question-wrapper {
      display: flex;
      align-items: center;
      width: 100%;
      justify-content: center;
      position: relative;
      margin-bottom: 1.5rem;
    }

    .question-label {
      font-size: 1.2rem;
      color: var(--text-color);
      line-height: 1.5;
      flex: 1;
    }

    .tip-icon {
      color: #999;
      font-size: 1.4rem;
      cursor: pointer;
      margin-left: 0.8rem;
      transition: color 0.3s ease, transform 0.3s ease;
    }

    .tip-icon:hover {
      color: #0078d4;
      transform: scale(1.2);
    }

    .tip-tooltip {
      display: none;
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      font-size: 0.85rem;
      color: var(--tooltip-text);
      background: var(--tooltip-bg);
      padding: 0.8rem;
      border-radius: 8px;
      width: 90%;
      max-width: 400px;
      text-align: left;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      z-index: 10;
      max-height: 200px;
      overflow-y: auto;
    }

    .tip-icon:hover + .tip-tooltip,
    .tip-tooltip:hover {
      display: block;
    }

    .close-tip {
      position: absolute;
      top: 5px;
      right: 10px;
      font-size: 1.2rem;
      cursor: pointer;
      color: var(--tooltip-text);
    }

    .step-textarea {
      width: 100%;
      min-height: 160px;
      padding: 1rem;
      border: 2px solid var(--textarea-border);
      border-radius: 12px;
      font-size: 1rem;
      resize: vertical;
      background: var(--textarea-bg);
      color: var(--text-color);
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
    }

    .step-textarea:focus {
      outline: none;
      border-color: #0078d4;
      box-shadow: 0 0 8px rgba(0, 120, 212, 0.2);
    }

    .example-button {
      background: var(--example-button-bg);
      color: var(--example-button-text);
      border: 2px solid var(--textarea-border);
      border-radius: 20px;
      padding: 0.5rem 1.2rem;
      font-size: 0.9rem;
      font-weight: 700;
      cursor: pointer;
      transition: background-color 0.3s ease, color 0.3s ease, transform 0.3s ease;
      margin-top: 1rem;
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
    }

    .example-button:hover {
      background: #0078d4;
      color: #fff;
      border-color: #0078d4;
      transform: translateY(-2px);
    }

    .example-button i {
      font-size: 0.9rem;
    }

    .char-count {
      font-size: 0.85rem;
      color: #999;
      margin-top: 0.5rem;
      align-self: flex-end;
    }

    #errorMessage {
      font-size: 0.9rem;
      color: #fff;
      margin-top: 1rem;
      padding: 0.5rem;
      border-radius: 4px;
      display: none;
      opacity: 0;
      transform: translateY(5px);
      transition: opacity 0.3s ease, transform 0.3s ease;
    }

    #errorMessage.show {
      opacity: 1;
      transform: translateY(0);
    }

    #errorMessage.analyzing {
      background-color: #666;
    }

    #errorMessage.feedback {
      background-color: #ff9800;
    }

    #errorMessage.success {
      background-color: #28a745;
    }

    .toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #28a745;
      color: #fff;
      padding: 0.8rem 1.2rem;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      z-index: 2000;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .toast.show {
      opacity: 1;
    }

    .progress-container {
      width: 100%;
      margin: 2rem 0;
    }

    .progress-bar {
      width: 100%;
      background: var(--progress-bg);
      border-radius: 12px;
      overflow: hidden;
      height: 12px;
      box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
    }

    .progress-fill {
      height: 100%;
      background: #0078d4;
      transition: width 0.5s ease;
    }

    .discipline-indicators {
      display: flex;
      justify-content: space-around;
      margin-top: 1.2rem;
      flex-wrap: wrap;
      gap: 0.8rem;
    }

    .indicator-item {
      display: flex;
      align-items: center;
      margin: 0.5rem;
      color: var(--indicator-text);
      font-size: 0.9rem;
      font-weight: 600;
    }

    .indicator-status {
      width: 24px;
      height: 24px;
      margin-right: 0.5rem;
      display: none;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      color: #fff;
      background: #28a745;
      transition: transform 0.3s ease;
    }

    .indicator-status.completed {
      display: flex;
      transform: scale(1.15);
    }

    .indicator-status::before {
      font-family: 'Font Awesome 6 Free';
      font-weight: 900;
      content: '\f00c';
    }

    .carousel-button-left, .carousel-button-right, .generate-spec-button {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: #0078d4;
      color: #fff;
      border: none;
      border-radius: 50%;
      width: 45px;
      height: 45px;
      font-size: 1.4rem;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      z-index: 1100;
    }

    .carousel-button-left {
      left: -22.5px;
    }

    .carousel-button-right, .generate-spec-button {
      right: -22.5px;
    }

    .carousel-button-left:hover, .carousel-button-right:hover, .generate-spec-button:hover {
      background: #005ea2;
      transform: translateY(-50%) translateY(-3px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }

    .generate-spec-button:disabled {
      background: var(--textarea-border);
      color: #999;
      cursor: not-allowed;
      transform: translateY(-50%);
      box-shadow: none;
    }

    .loading-spinner {
      position: absolute;
      top: 50%;
      right: -22.5px;
      transform: translateY(-50%);
      width: 45px;
      height: 45px;
      border: 4px solid var(--spinner-border);
      border-top: 4px solid #0078d4;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      display: none;
      z-index: 1100;
    }

    @keyframes spin {
      0% { transform: translateY(-50%) rotate(0deg); }
      100% { transform: translateY(-50%) rotate(360deg); }
    }

    footer {
      padding: 20px;
      text-align: center;
      color: var(--footer-text);
      flex-shrink: 0;
      background: var(--footer-bg);
      box-shadow: var(--footer-shadow);
    }

    .footer-content {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
      gap: 15px;
      margin-bottom: 10px;
    }

    .footer-links a {
      color: var(--footer-link);
      text-decoration: none;
      font-weight: 600;
      margin: 0 10px;
      transition: color 0.3s ease;
    }

    .footer-links a:hover {
      color: #0078d4;
    }

    .footer-divider {
      color: var(--footer-text);
      font-size: 1.2rem;
      font-weight: 300;
    }

    .footer-social a {
      color: var(--footer-link);
      font-size: 1.2rem;
      margin: 0 10px;
      transition: color 0.3s ease, transform 0.3s ease;
    }

    .footer-social a:hover {
      color: #0078d4;
      transform: scale(1.2);
    }

    .footer-copyright {
      font-size: 0.9rem;
      color: #999;
      margin-top: 10px;
    }

    @media (max-width: 768px) {
      .thematic-header .logo a {
        font-size: 1.4rem;
      }

      .carousel-content {
        padding: 1.5rem;
        min-height: 350px;
        max-width: 95%;
      }

      #stepTitle {
        font-size: 1.8rem;
      }

      .question-label {
        font-size: 1rem;
      }

      .tip-icon {
        font-size: 1.2rem;
      }

      .tip-tooltip {
        font-size: 0.8rem;
        padding: 0.6rem;
        width: 95%;
      }

      .step-textarea {
        min-height: 140px;
        font-size: 0.9rem;
      }

      .char-count {
        font-size: 0.8rem;
      }

      .carousel-button-left, .carousel-button-right, .generate-spec-button {
        width: 40px;
        height: 40px;
        font-size: 1.2rem;
      }

      .carousel-button-left {
        left: -20px;
      }

      .carousel-button-right, .generate-spec-button {
        right: -20px;
      }

      .progress-bar {
        height: 10px;
      }

      .indicator-item {
        font-size: 0.8rem;
      }

      .indicator-status {
        width: 20px;
        height: 20px;
      }

      .indicator-status::before {
        font-size: 0.9rem;
      }

      .loading-spinner {
        width: 40px;
        height: 40px;
        right: -20px;
      }

      .footer-content {
        flex-direction: column;
        gap: 10px;
      }
    }

    @media (max-width: 480px) {
      .thematic-header .logo a {
        font-size: 1.2rem;
      }

      .carousel-container {
        padding: 4rem 0.5rem;
      }

      .carousel-content {
        padding: 1rem;
        min-height: 300px;
      }

      #stepTitle {
        font-size: 1.6rem;
      }

      .question-label {
        font-size: 0.9rem;
      }

      .tip-icon {
        font-size: 1.1rem;
      }

      .tip-tooltip {
        font-size: 0.75rem;
        padding: 0.5rem;
        width: 95%;
      }

      .step-textarea {
        min-height: 120px;
        font-size: 0.85rem;
      }

      .char-count {
        font-size: 0.75rem;
      }

      .carousel-button-left, .carousel-button-right, .generate-spec-button {
        width: 35px;
        height: 35px;
        font-size: 1rem;
      }

      .carousel-button-left {
        left: -17.5px;
      }

      .carousel-button-right, .generate-spec-button {
        right: -17.5px;
      }

      .indicator-item {
        font-size: 0.75rem;
      }

      .indicator-status {
        width: 18px;
        height: 18px;
      }

      .indicator-status::before {
        font-size: 0.8rem;
      }

      .loading-spinner {
        width: 35px;
        height: 35px;
        right: -17.5px;
      }

      .footer-content {
        gap: 5px;
      }
    }

    @media (prefers-reduced-motion: reduce) {
      .carousel-button-left, .carousel-button-right, .generate-spec-button, .tip-icon, .example-button, .loading-spinner, .carousel-content, #errorMessage, .indicator-status, .theme-toggle {
        animation: none;
        transition: none;
      }
    }
  </style>
</head>
<body class="page-default">
  <header class="thematic-header" role="banner">
    <div class="logo">
      <a href="index.html" aria-label="specifys.ai homepage">specifys.ai</a>
    </div>
    <button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode">
      <i class="fas fa-moon"></i>
    </button>
  </header>

  <div class="carousel-container">
    <div id="carouselContent" class="carousel-content">
      <button id="prevButton" class="carousel-button-left" onclick="prevStep()" aria-label="Previous step" style="display: none;">
        <i class="fas fa-arrow-left"></i>
      </button>
      <div class="step-container">
        <h3 id="stepTitle">App Purpose</h3>
        <div class="question-wrapper">
          <p id="stepQuestion" class="question-label" aria-describedby="tipText"></p>
          <i class="fas fa-lightbulb tip-icon" aria-label="Show tip"></i>
          <div id="tipText" class="tip-tooltip"><span class="close-tip" onclick="this.parentElement.style.display='none'">Ã</span></div>
        </div>
        <textarea id="stepTextarea" class="step-textarea" maxlength="1000" placeholder="Enter your response here (max 1000 characters)..." aria-label="Answer the current question"></textarea>
        <span id="charCount" class="char-count">0/1000</span>
        <button id="exampleButton" class="example-button" onmouseover="showExample()" onmouseout="restoreAnswer()" aria-label="Show example answer">
          <i class="fas fa-eye"></i> Example
        </button>
        <div id="errorMessage" role="alert"></div>
        <div class="progress-container">
          <div class="progress-bar">
            <div id="progressFill" class="progress-fill"></div>
          </div>
          <div class="discipline-indicators" role="group" aria-label="Progress indicators by category">
            <div class="indicator-item">
              <span class="indicator-status" id="app-purpose-indicator" aria-label="App Purpose progress"></span>
              <span>App Purpose</span>
            </div>
            <div class="indicator-item">
              <span class="indicator-status" id="user-workflow-indicator" aria-label="User Workflow progress"></span>
              <span>User Workflow</span>
            </div>
            <div class="indicator-item">
              <span class="indicator-status" id="development-preferences-indicator" aria-label="Development Preferences progress"></span>
              <span>Dev Preferences</span>
            </div>
            <div class="indicator-item">
              <span class="indicator-status" id="technologies-indicator" aria-label="Technologies progress"></span>
              <span>Technologies</span>
            </div>
            <div class="indicator-item">
              <span class="indicator-status" id="data-structure-indicator" aria-label="Data Structure progress"></span>
              <span>Data Structure</span>
            </div>
          </div>
        </div>
      </div>
      <button id="nextButton" class="carousel-button-right" onclick="nextStep()" aria-label="Next step">
        <i class="fas fa-arrow-right"></i>
      </button>
      <button id="generateSpecButton" class="carousel-button-right generate-spec-button" onclick="generateSpecification()" style="display: none;" disabled aria-label="Generate your app specification, disabled until all required questions are answered">
        <i class="fas fa-rocket"></i>
      </button>
      <div id="loadingSpinner" class="loading-spinner"></div>
    </div>
    <div id="toast" class="toast">Answers saved successfully!</div>
  </div>

  <footer>
    <div class="footer-content">
      <div class="footer-links">
        <a href="how.html" aria-label="Learn how specifys.ai works">How It Works</a>
        <a href="about.html" aria-label="Learn more about specifys.ai">About Us</a>
        <a href="/blog.html" aria-label="Visit our blog">Blog</a>
        <a href="map/vibe-coding-tools-map.html" aria-label="Explore Vibe Coding Tools Map">Vibe Coding Tools Map</a>
      </div>
      <span class="footer-divider">|</span>
      <div class="footer-social">
        <a href="https://www.linkedin.com/company/specifys-ai/" aria-label="Follow us on LinkedIn"><i class="fab fa-linkedin-in"></i></a>
        <a href="https://www.facebook.com/profile.php?id=61576402600129&locale=he_IL" target="_blank" aria-label="Follow us on Facebook"><i class="fab fa-facebook-f"></i></a>
        <a href="https://www.instagram.com/YOUR_PROFILE" aria-label="Follow us on Instagram"><i class="fab fa-instagram"></i></a>
        <a href="mailto:specifysai@gmail.com" aria-label="Send us an email"><i class="fas fa-envelope"></i></a>
        <a href="https://www.producthunt.com/products/specifys-ai" target="_blank" aria-label="Check us out on Product Hunt"><i class="fab fa-product-hunt"></i></a>
      </div>
    </div>
    <div class="footer-copyright">
      Â© 2025 specifys.ai. All rights reserved.
    </div>
  </footer>

  <script>
    const stepTitles = [
      "App Purpose",
      "User Workflow",
      "Dev Preferences",
      "Technologies",
      "Data Structure"
    ];

    const questions = [
      "What is the main goal of your app, who is the target audience, and what specific needs or challenges does it aim to address?",
      "Describe the main user flow: what steps does a user go through from start to completing a core action (include conditions or exceptions)?",
      "What are your preferences for development in terms of tools, environments, or methodologies? (e.g., IDE, CI/CD, Agile)",
      "What technologies, programming languages, or frameworks would you like to use, and why?",
      "What are the main types of information your app needs to store (e.g., users, tasks, products), and what are the key relationships between them (e.g., a user creates tasks)?"
    ];

    const tips = [
      "Focus on the core problem your app solves, its target users, and a measurable goal (e.g., 'reduce task completion time by 20%').",
      "Outline a clear sequence of user actions, including any conditional steps or error handling (e.g., 'if login fails, show error').",
      "Specify preferred tools like VS Code or methodologies like Agile to guide the development process.",
      "Choose technologies that align with your app's needs, like React for UI or Python for backend, and explain why.",
      "Define key data entities and their relationships, like 'Users have many Tasks' to clarify the app's structure."
    ];

    const exampleAnswers = [
      "TaskMaster aims to help busy professionals manage tasks. Target: adults 25-45. It addresses time management with task prioritization and reminders. Goal: 80% of users complete tasks within 24 hours.",
      "User logs in, views task list, adds a task with priority and due date. If offline, tasks sync later. On completion, app sends a confirmation notification.",
      "Prefer Agile with 2-week sprints, VS Code for coding, GitHub for version control, and Jenkins for CI/CD to ensure rapid iteration.",
      "Use React for responsive UI, Node.js (18+) for backend due to scalability, and MongoDB for flexible data storage.",
      "Store Users (id: PK, name: string), Tasks (id: PK, user_id: FK, title: string), and Categories (id: PK, name: string). Users create Tasks; Tasks belong to Categories."
    ];

    let currentStep = 0;
    const totalSteps = questions.length;
    let textarea, stepTitle, stepQuestion, prevButton, nextButton, generateSpecButton, progressFill, charCount, tipText, exampleButton, errorMessage, loadingSpinner, toast;
    const storageKey = "devAnswers";
    let answers = JSON.parse(localStorage.getItem(storageKey)) || {};
    let originalAnswer = "";
    const indicators = [
      "app-purpose-indicator",
      "user-workflow-indicator",
      "development-preferences-indicator",
      "technologies-indicator",
      "data-structure-indicator"
    ];
    let typingTimer, feedbackTimer, dotsTimer, dotsCount = 0;

    function showExample() {
      originalAnswer = textarea.value;
      textarea.value = exampleAnswers[currentStep];
      charCount.textContent = `${textarea.value.length}/1000`;
    }

    function restoreAnswer() {
      textarea.value = originalAnswer;
      charCount.textContent = `${textarea.value.length}/1000`;
    }

    function showToast() {
      toast.classList.add("show");
      setTimeout(() => {
        toast.classList.remove("show");
      }, 3000);
    }

    function showFeedbackMessage(message, type) {
      errorMessage.textContent = message;
      errorMessage.className = "show";
      if (type === "analyzing") {
        errorMessage.classList.add("analyzing");
        errorMessage.classList.remove("feedback", "success");
      } else if (type === "short") {
        errorMessage.classList.add("feedback");
        errorMessage.classList.remove("analyzing", "success");
      } else {
        errorMessage.classList.add("success");
        errorMessage.classList.remove("analyzing", "feedback");
      }
      errorMessage.style.display = "block";
    }

    function hideFeedbackMessage() {
      errorMessage.style.display = "none";
      errorMessage.classList.remove("show", "analyzing", "feedback", "success");
      clearInterval(dotsTimer);
    }

    function updateDots() {
      dotsCount = (dotsCount + 1) % 4;
      const dots = ".".repeat(dotsCount);
      errorMessage.textContent = `Analyzing answer${dots}`;
    }

    function updateUI() {
      stepTitle.textContent = stepTitles[currentStep];
      stepQuestion.textContent = questions[currentStep];
      tipText.innerHTML = tips[currentStep] + '<span class="close-tip" onclick="this.parentElement.style.display=\'none\'">Ã</span>';
      textarea.value = answers[currentStep] || "";
      charCount.textContent = `${textarea.value.length}/1000`;

      const progress = ((currentStep + 1) / totalSteps) * 100;
      progressFill.style.width = `${progress}%`;

      indicators.forEach((indicator, index) => {
        const element = document.getElementById(indicator);
        if (answers[index] && answers[index].trim()) {
          element.classList.add("completed");
        } else {
          element.classList.remove("completed");
        }
      });

      prevButton.style.display = currentStep === 0 ? "none" : "flex";
      nextButton.style.display = currentStep === totalSteps - 1 ? "none" : "flex";
      generateSpecButton.style.display = currentStep === totalSteps - 1 ? "flex" : "none";
      generateSpecButton.disabled = !indicators.every((indicator) => {
        const element = document.getElementById(indicator);
        return element.classList.contains("completed");
      });
      generateSpecButton.setAttribute("aria-label", generateSpecButton.disabled ? "Generate your app specification, disabled until all required questions are answered" : "Generate your app specification");
    }

    document.addEventListener("DOMContentLoaded", () => {
      if (localStorage.getItem("currentMode") !== "dev") {
        localStorage.removeItem("marketAnswers");
        localStorage.removeItem("noCodeAnswers");
        localStorage.setItem("currentMode", "dev");
        answers = {};
        localStorage.setItem(storageKey, JSON.stringify(answers));
      }

      textarea = document.getElementById("stepTextarea");
      stepTitle = document.getElementById("stepTitle");
      stepQuestion = document.getElementById("stepQuestion");
      prevButton = document.getElementById("prevButton");
      nextButton = document.getElementById("nextButton");
      generateSpecButton = document.getElementById("generateSpecButton");
      progressFill = document.getElementById("progressFill");
      charCount = document.getElementById("charCount");
      tipText = document.getElementById("tipText");
      exampleButton = document.getElementById("exampleButton");
      errorMessage = document.getElementById("errorMessage");
      loadingSpinner = document.getElementById("loadingSpinner");
      toast = document.getElementById("toast");

      const themeToggle = document.getElementById("themeToggle");
      const savedTheme = localStorage.getItem("theme") || (window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light");
      document.body.setAttribute("data-theme", savedTheme);
      updateThemeIcon(savedTheme);

      themeToggle.addEventListener("click", () => {
        const currentTheme = document.body.getAttribute("data-theme") === "dark" ? "light" : "dark";
        document.body.setAttribute("data-theme", currentTheme);
        localStorage.setItem("theme", currentTheme);
        updateThemeIcon(currentTheme);
      });

      function updateThemeIcon(theme) {
        themeToggle.innerHTML = `<i class="fas fa-${theme === "dark" ? "sun" : "moon"}"></i>`;
        themeToggle.setAttribute("aria-label", `Switch to ${theme === "dark" ? "light" : "dark"} mode`);
      }

      updateUI();

      textarea.addEventListener("input", () => {
        answers[currentStep] = textarea.value;
        localStorage.setItem(storageKey, JSON.stringify(answers));
        charCount.textContent = `${textarea.value.length}/1000`;

        clearTimeout(typingTimer);
        clearTimeout(feedbackTimer);
        clearInterval(dotsTimer);

        showFeedbackMessage("Analyzing answer.", "analyzing");
        dotsTimer = setInterval(updateDots, 500);

        typingTimer = setTimeout(() => {
          localStorage.setItem(storageKey, JSON.stringify(answers));
          showToast();
        }, 10000);

        feedbackTimer = setTimeout(() => {
          clearInterval(dotsTimer);
          const value = textarea.value.trim();
          if (value.length === 0) {
            hideFeedbackMessage();
          } else if (value.length < 50) {
            showFeedbackMessage("Your answer is a bit short. Try adding more details!", "short");
          } else if (value.length < 100) {
            showFeedbackMessage("Your answer length is okay, but could use more depth.", "success");
          } else {
            showFeedbackMessage("Great job! Your answer length is good.", "success");
          }
        }, 1500);

        updateUI();
      });

      textarea.addEventListener("keydown", () => {
        clearTimeout(feedbackTimer);
        clearInterval(dotsTimer);
        showFeedbackMessage("Analyzing answer.", "analyzing");
        dotsTimer = setInterval(updateDots, 500);
      });
    });

    window.prevStep = function() {
      if (currentStep > 0) {
        currentStep--;
        errorMessage.style.display = "none";
        clearInterval(dotsTimer);
        updateUI();
      }
    };

    window.nextStep = function() {
      const textareaValue = textarea.value.trim();
      if (!textareaValue) {
        showFeedbackMessage("Please answer the current question before proceeding.", "short");
        return;
      }

      answers[currentStep] = textareaValue;
      localStorage.setItem(storageKey, JSON.stringify(answers));
      showToast();

      if (currentStep < totalSteps - 1) {
        currentStep++;
        errorMessage.style.display = "none";
        clearInterval(dotsTimer);
        updateUI();
      }
    };

    window.generateSpecification = async function() {
      const answers = JSON.parse(localStorage.getItem(storageKey)) || {};
      if (Object.keys(answers).length < totalSteps) {
        showFeedbackMessage("Please complete all steps before generating the specification.", "short");
        return;
      }

      errorMessage.style.display = "none";
      clearInterval(dotsTimer);
      generateSpecButton.style.display = "none";
      loadingSpinner.style.display = "block";

      let rawContent = "# App Specification\n\n";
      rawContent += "## App Purpose\n\n" + (answers[0] || "No purpose provided.") + "\n\n";
      rawContent += "## User Workflow\n\n" + (answers[1] || "No workflow provided.") + "\n\n";
      rawContent += "## Development Preferences\n\n" + (answers[2] || "No preferences provided.") + "\n\n";
      rawContent += "## Technologies\n\n" + (answers[3] || "No technologies specified.") + "\n\n";
      rawContent += "## Data Structure\n\n" + (answers[4] || "No data structure specified.") + "\n";
      localStorage.setItem("rawContent", rawContent);

      const formData = {
        idea: answers[0] || '',
        topic: 'App Development',
        platform: 'Mobile (iOS and Android)',
        answers: answers
      };
      localStorage.setItem("formData", JSON.stringify(formData));
      showToast();

      try {
        if (typeof window.generateSpecificationOriginal !== "function") {
          throw new Error("External script (processing.js) failed to load or function is missing.");
        }
        await window.generateSpecificationOriginal();
      } catch (error) {
        console.error("Error calling API:", error);
        showFeedbackMessage(`Failed to generate specification: ${error.message}. Using raw content as fallback.`, "short");
        localStorage.setItem("generatedContent", rawContent);
      }
      loadingSpinner.style.display = "none";
      window.location.href = "result.html";
    };
  </script>

  <noscript>
    <div style="text-align: center; padding: 10px; background: var(--content-bg); color: var(--text-color);">
      <p>This website requires JavaScript to function properly. Please enable JavaScript in your browser.</p>
    </div>
  </noscript>
</body>
</html>