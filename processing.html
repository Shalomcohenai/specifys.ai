<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Processing Idea</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="page-default">
    <header class="thematic-header">
        <div class="logo">
            <a href="index.html">Thematic</a>
        </div>
        <div class="nav-links">
            <button class="auth-button" onclick="window.location.href='login.html'">Login</button>
            <button class="auth-button" onclick="window.location.href='register.html'">Register</button>
        </div>
    </header>

    <div class="instructions">
        <h1>Answer the Following Questions</h1>
        <p>Please provide details about your app idea to generate a development plan.</p>
    </div>

    <form id="detailsForm" onsubmit="submitForm(event)">
        <!-- Hidden fields for idea, topic, platform -->
        <input type="hidden" id="idea" name="idea">
        <input type="hidden" id="topic" name="topic">
        <input type="hidden" id="platform" name="platform">

        <div class="carousel-container">
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>
            <button type="button" id="prevButton" class="carousel-button" disabled>←</button>
            <button type="button" id="nextButton" class="carousel-button">→</button>
            <div class="carousel-content">
                <!-- Question 1 -->
                <div class="step-container">
                    <h3>Question 1</h3>
                    <label class="question-label" for="q1">What is the basic purpose of your app, and what problem does it solve?</label>
                    <textarea id="q1" name="q1" class="step-textarea" maxlength="500" placeholder="Enter your answer here..."></textarea>
                    <span class="char-count" id="charCount1">0/500</span>
                    <label class="question-label" for="q1_details">Add details or examples (optional):</label>
                    <textarea id="q1_details" name="q1_details" class="step-textarea" maxlength="500" placeholder="Add details..."></textarea>
                    <span class="char-count" id="charCount1_details">0/500</span>
                </div>

                <!-- Question 2 -->
                <div class="step-container" style="display: none;">
                    <h3>Question 2</h3>
                    <label class="question-label" for="q2">How will users interact with your app in a typical scenario (e.g., from opening the app to completing a task)?</label>
                    <textarea id="q2" name="q2" class="step-textarea" maxlength="500" placeholder="Enter your answer here..."></textarea>
                    <span class="char-count" id="charCount2">0/500</span>
                    <label class="question-label" for="q2_details">Add specific steps (optional):</label>
                    <textarea id="q2_details" name="q2_details" class="step-textarea" maxlength="500" placeholder="Add details..."></textarea>
                    <span class="char-count" id="charCount2_details">0/500</span>
                </div>

                <!-- Question 3 -->
                <div class="step-container" style="display: none;">
                    <h3>Question 3</h3>
                    <label class="question-label" for="q3">What are the 3-5 most important features your app must have?</label>
                    <textarea id="q3" name="q3" class="step-textarea" maxlength="500" placeholder="Enter your answer here..."></textarea>
                    <span class="char-count" id="charCount3">0/500</span>
                    <label class="question-label" for="q3_details">Add technical details if relevant (optional):</label>
                    <textarea id="q3_details" name="q3_details" class="step-textarea" maxlength="500" placeholder="Add details..."></textarea>
                    <span class="char-count" id="charCount3_details">0/500</span>
                </div>

                <!-- Question 4 -->
                <div class="step-container" style="display: none;">
                    <h3>Question 4</h3>
                    <label class="question-label" for="q4">What programming languages or frameworks would you prefer for the app’s core functionality?</label>
                    <textarea id="q4" name="q4" class="step-textarea" maxlength="500" placeholder="Enter your answer here..."></textarea>
                    <span class="char-count" id="charCount4">0/500</span>
                    <label class="question-label" for="q4_details">Add specific requirements (optional):</label>
                    <textarea id="q4_details" name="q4_details" class="step-textarea" maxlength="500" placeholder="Add details..."></textarea>
                    <span class="char-count" id="charCount4_details">0/500</span>
                </div>

                <!-- Question 5 -->
                <div class="step-container" style="display: none;">
                    <h3>Question 5</h3>
                    <label class="question-label" for="q5">Which development methodology will you use (e.g., Agile, Waterfall, Scrum)?</label>
                    <textarea id="q5" name="q5" class="step-textarea" maxlength="500" placeholder="Enter your answer here..."></textarea>
                    <span class="char-count" id="charCount5">0/500</span>
                    <label class="question-label" for="q5_details">Add details (optional):</label>
                    <textarea id="q5_details" name="q5_details" class="step-textarea" maxlength="500" placeholder="Add details..."></textarea>
                    <span class="char-count" id="charCount5_details">0/500</span>
                </div>

                <!-- Question 6 -->
                <div class="step-container" style="display: none;">
                    <h3>Question 6</h3>
                    <label class="question-label" for="q6">What tech stack or tools do you prefer (e.g., frontend, backend, database)?</label>
                    <textarea id="q6" name="q6" class="step-textarea" maxlength="500" placeholder="Enter your answer here..."></textarea>
                    <span class="char-count" id="charCount6">0/500</span>
                    <label class="question-label" for="q6_details">Specify versions or constraints (optional):</label>
                    <textarea id="q6_details" name="q6_details" class="step-textarea" maxlength="500" placeholder="Add details..."></textarea>
                    <span class="char-count" id="charCount6_details">0/500</span>
                </div>

                <!-- Question 7 -->
                <div class="step-container" style="display: none;">
                    <h3>Question 7</h3>
                    <label class="question-label" for="q7">How will you design the data architecture (e.g., relational database, NoSQL, caching)?</label>
                    <textarea id="q7" name="q7" class="step-textarea" maxlength="500" placeholder="Enter your answer here..."></textarea>
                    <span class="char-count" id="charCount7">0/500</span>
                    <label class="question-label" for="q7_details">Add details (optional):</label>
                    <textarea id="q7_details" name="q7_details" class="step-textarea" maxlength="500" placeholder="Add details..."></textarea>
                    <span class="char-count" id="charCount7_details">0/500</span>
                </div>

                <!-- Question 8 -->
                <div class="step-container" style="display: none;">
                    <h3>Question 8</h3>
                    <label class="question-label" for="q8">What APIs or external services will you integrate, and how?</label>
                    <textarea id="q8" name="q8" class="step-textarea" maxlength="500" placeholder="Enter your answer here..."></textarea>
                    <span class="char-count" id="charCount8">0/500</span>
                    <label class="question-label" for="q8_details">Specify protocols (optional):</label>
                    <textarea id="q8_details" name="q8_details" class="step-textarea" maxlength="500" placeholder="Add details..."></textarea>
                    <span class="char-count" id="charCount8_details">0/500</span>
                </div>

                <!-- Question 9 -->
                <div class="step-container" style="display: none;">
                    <h3>Question 9</h3>
                    <label class="question-label" for="q9">What security protocols or tools will you implement (e.g., OAuth, HTTPS, firewall)?</label>
                    <textarea id="q9" name="q9" class="step-textarea" maxlength="500" placeholder="Enter your answer here..."></textarea>
                    <span class="char-count" id="charCount9">0/500</span>
                    <label class="question-label" for="q9_details">Add specifics (optional):</label>
                    <textarea id="q9_details" name="q9_details" class="step-textarea" maxlength="500" placeholder="Add details..."></textarea>
                    <span class="char-count" id="charCount9_details">0/500</span>
                </div>

                <!-- Question 10 -->
                <div class="step-container" style="display: none;">
                    <h3>Question 10</h3>
                    <label class="question-label" for="q10">What notification system will you implement (e.g., WebSocket, email server)?</label>
                    <textarea id="q10" name="q10" class="step-textarea" maxlength="500" placeholder="Enter your answer here..."></textarea>
                    <span class="char-count" id="charCount10">0/500</span>
                    <label class="question-label" for="q10_details">Add tools (optional):</label>
                    <textarea id="q10_details" name="q10_details" class="step-textarea" maxlength="500" placeholder="Add details..."></textarea>
                    <span class="char-count" id="charCount10_details">0/500</span>
                </div>

                <!-- Question 11 -->
                <div class="step-container" style="display: none;">
                    <h3>Question 11</h3>
                    <label class="question-label" for="q11">What scalability strategy will you use (e.g., load balancing, microservices)?</label>
                    <textarea id="q11" name="q11" class="step-textarea" maxlength="500" placeholder="Enter your answer here..."></textarea>
                    <span class="char-count" id="charCount11">0/500</span>
                    <label class="question-label" for="q11_details">Add specifics (optional):</label>
                    <textarea id="q11_details" name="q11_details" class="step-textarea" maxlength="500" placeholder="Add details..."></textarea>
                    <span class="char-count" id="charCount11_details">0/500</span>
                </div>

                <!-- Question 12 -->
                <div class="step-container" style="display: none;">
                    <h3>Question 12</h3>
                    <label class="question-label" for="q12">What performance optimization techniques will you apply (e.g., lazy loading, CDN)?</label>
                    <textarea id="q12" name="q12" class="step-textarea" maxlength="500" placeholder="Enter your answer here..."></textarea>
                    <span class="char-count" id="charCount12">0/500</span>
                    <label class="question-label" for="q12_details">Add benchmarks (optional):</label>
                    <textarea id="q12_details" name="q12_details" class="step-textarea" maxlength="500" placeholder="Add details..."></textarea>
                    <span class="char-count" id="charCount12_details">0/500</span>
                </div>

                <!-- Question 13 -->
                <div class="step-container" style="display: none;">
                    <h3>Question 13</h3>
                    <label class="question-label" for="q13">What error management strategy will you use (e.g., try-catch, logging)?</label>
                    <textarea id="q13" name="q13" class="step-textarea" maxlength="500" placeholder="Enter your answer here..."></textarea>
                    <span class="char-count" id="charCount13">0/500</span>
                    <label class="question-label" for="q13_details">Add tools (optional):</label>
                    <textarea id="q13_details" name="q13_details" class="step-textarea" maxlength="500" placeholder="Add details..."></textarea>
                    <span class="char-count" id="charCount13_details">0/500</span>
                </div>

                <!-- Question 14 -->
                <div class="step-container" style="display: none;">
                    <h3>Question 14</h3>
                    <label class="question-label" for="q14">What testing framework or approach will you use (e.g., Jest, Selenium)?</label>
                    <textarea id="q14" name="q14" class="step-textarea" maxlength="500" placeholder="Enter your answer here..."></textarea>
                    <span class="char-count" id="charCount14">0/500</span>
                    <label class="question-label" for="q14_details">Add test types (optional):</label>
                    <textarea id="q14_details" name="q14_details" class="step-textarea" maxlength="500" placeholder="Add details..."></textarea>
                    <span class="char-count" id="charCount14_details">0/500</span>
                </div>

                <!-- Question 15 -->
                <div class="step-container" style="display: none;">
                    <h3>Question 15</h3>
                    <label class="question-label" for="q15">What deployment strategy will you use (e.g., cloud provider, CI/CD tools)?</label>
                    <textarea id="q15" name="q15" class="step-textarea" maxlength="500" placeholder="Enter your answer here..."></textarea>
                    <span class="char-count" id="charCount15">0/500</span>
                    <label class="question-label" for="q15_details">Add details (optional):</label>
                    <textarea id="q15_details" name="q15_details" class="step-textarea" maxlength="500" placeholder="Add details..."></textarea>
                    <span class="char-count" id="charCount15_details">0/500</span>
                </div>
            </div>
        </div>

        <div class="submit-button-container">
            <button type="submit" id="generateSpecButton" class="generate-spec-button">Generate Development Plan</button>
        </div>
    </form>

    <script src="processing.js"></script>
    <script>
        // Populate hidden fields with data from localStorage
        document.getElementById('idea').value = localStorage.getItem('idea') || '';
        document.getElementById('topic').value = localStorage.getItem('topic') || '';
        document.getElementById('platform').value = localStorage.getItem('platform') || '';

        let currentStep = 0;
        const steps = document.querySelectorAll('.step-container');
        const prevButton = document.getElementById('prevButton');
        const nextButton = document.getElementById('nextButton');
        const progressFill = document.getElementById('progressFill');
        const generateButton = document.getElementById('generateSpecButton');

        function updateCarousel() {
            steps.forEach((step, index) => {
                step.style.display = index === currentStep ? 'block' : 'none';
            });

            prevButton.disabled = currentStep === 0;
            nextButton.style.display = currentStep === steps.length - 1 ? 'none' : 'block';
            generateButton.style.display = currentStep === steps.length - 1 ? 'block' : 'none';
            updateProgress();
        }

        function updateProgress() {
            const progress = ((currentStep + 1) / steps.length) * 100;
            progressFill.style.width = `${progress}%`;
        }

        function updateCharCount(textarea, charCountElement) {
            const textLength = textarea.value.length;
            const maxLength = textarea.maxLength;
            charCountElement.textContent = `${textLength}/${maxLength}`;

            if (textLength >= maxLength) {
                charCountElement.classList.add('red');
            } else if (textLength >= maxLength * 0.8) {
                charCountElement.classList.add('orange');
            } else {
                charCountElement.classList.add('green');
            }
        }

        steps.forEach((step, index) => {
            const textarea = step.querySelector('textarea[id^="q"]');
            const detailsTextarea = step.querySelector('textarea[id$="_details"]');
            const charCount = step.querySelector(`#charCount${index + 1}`);
            const detailsCharCount = step.querySelector(`#charCount${index + 1}_details`);

            textarea.addEventListener('input', () => updateCharCount(textarea, charCount));
            detailsTextarea.addEventListener('input', () => updateCharCount(detailsTextarea, detailsCharCount));
        });

        prevButton.addEventListener('click', () => {
            if (currentStep > 0) {
                currentStep--;
                updateCarousel();
            }
        });

        nextButton.addEventListener('click', () => {
            if (currentStep < steps.length - 1) {
                currentStep++;
                updateCarousel();
            }
        });

        function submitForm(event) {
            event.preventDefault();
            const formData = new FormData(document.getElementById('detailsForm'));
            const details = {};
            formData.forEach((value, key) => {
                details[key] = value;
            });
            processIdea(details);
        }

        updateCarousel();
    </script>
</body>
</html>