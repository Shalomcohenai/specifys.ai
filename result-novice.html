<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="View your simple app plan with specifys.ai for NoCode Creators."
    />
    <meta
      name="keywords"
      content="app specification result, AI-generated plan, nocode creators, specifys.ai"
    />
    <meta name="author" content="specifys.ai Team" />
    <meta name="robots" content="index, follow" />
    <meta property="og:title" content="specifys.ai - NoCode Creators Result" />
    <meta
      property="og:description"
      content="View the simple app plan generated by specifys.ai for your idea as a NoCode Creator."
    />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://specifys.ai/result-novice.html" />
    <meta
      property="og:image"
      content="https://specifys.ai/assets/og-image.jpg"
    />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="specifys.ai - NoCode Creators Result" />
    <meta
      name="twitter:description"
      content="View the simple app plan generated by specifys.ai for your idea as a NoCode Creator."
    />
    <meta
      name="twitter:image"
      content="https://specifys.ai/assets/og-image.jpg"
    />
    <title>specifys.ai - NoCode Creators Result</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
    <style>
      body {
        margin: 0;
        padding: 0;
        font-family: "Montserrat", sans-serif;
        min-height: 100vh;
        background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
        background-size: 400% 400%;
        animation: gradient 15s ease infinite;
      }
      @keyframes gradient {
        0% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
        100% {
          background-position: 0% 50%;
        }
      }
      .carousel-container {
        max-width: 900px;
        width: 80%;
        margin: 80px auto 20px auto;
        padding: 20px;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 15px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        box-sizing: border-box;
      }
      .sections-grid {
        display: grid;
        gap: 20px;
        grid-template-columns: 1fr;
      }
      .section {
        background: #fff;
        padding: 15px;
        border-radius: 5px;
        color: #333;
        box-sizing: border-box;
        white-space: normal; /* Allows natural line wrapping */
        word-break: break-word; /* Breaks long words to wrap naturally */
        overflow-x: hidden; /* Removes horizontal scrolling for text */
        position: relative;
      }
      .section-title {
        font-size: 24px;
        color: #fff;
        background-color: #23a6d5;
        padding: 5px 10px;
        border-radius: 5px 5px 0 0;
        margin: -15px -15px 15px -15px;
      }
      .copy-button {
        position: absolute;
        top: 5px;
        right: 5px;
        padding: 5px 10px;
        border: none;
        border-radius: 3px;
        background-color: #23a6d5;
        color: white;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      .copy-button:hover {
        background-color: #1e87b0;
        transform: translateY(-2px);
      }
      .copy-button.copied {
        background-color: #23a6d5;
      }
      .submit-button-container {
        text-align: center;
        margin: 20px 0;
        background: rgba(255, 255, 255, 0.95);
        padding: 15px;
        border-radius: 15px;
        width: 95%;
        max-width: 900px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      }
      .export-btn {
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        font-size: 16px;
        cursor: pointer;
        transition: background-color 0.3s, transform 0.3s ease;
        margin: 0 10px;
      }
      .export-pdf-btn {
        background-color: #00b4d8;
        color: white;
      }
      .export-pdf-btn:hover {
        background-color: #00b4d8;
        transform: translateX(5px);
      }
      .popup {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(255, 255, 255, 0.95);
        padding: 20px;
        border-radius: 15px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        z-index: 1000;
        text-align: center;
        max-width: 500px;
        width: 90%;
      }
      .popup h1 {
        font-size: 36px;
        margin-bottom: 10px;
        color: #333;
      }
      .popup p {
        font-size: 18px;
        color: #333;
        margin-bottom: 20px;
      }
      .popup .close-btn {
        padding: 10px 20px;
        background-color: #00b4d8;
        color: #fff;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        transition: background-color 0.3s ease, transform 0.3s ease;
      }
      .popup .close-btn:hover {
        background-color: #00b4d8;
        transform: translateX(5px);
      }
      .popup-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 999;
      }
      /* יישור טקסט לשמאל עבור אנגלית */
      .section p,
      .section pre {
        font-family: "Montserrat", sans-serif;
        direction: ltr;
        text-align: left;
      }
      .section-title,
      .copy-button {
        direction: ltr;
        text-align: left;
      }
    </style>
  </head>
  <body class="page-default nocode">
    <header class="thematic-header" role="banner">
      <div class="logo">
        <a href="index.html" aria-label="specifys.ai homepage">specifys.ai</a>
      </div>
    </header>

    <div class="carousel-container">
      <div class="sections-grid" id="specContent"></div>
    </div>

    <div class="submit-button-container">
      <button
        id="downloadPdfButton"
        class="export-btn export-pdf-btn"
        onclick="downloadPdf()"
        aria-label="Download specification as PDF"
      >
        <i class="fas fa-file-pdf"></i> Download as PDF
      </button>
    </div>

    <footer style="text-align: center; padding: 20px; color: #fff">
      <a
        href="how.html"
        style="color: #fff; text-decoration: underline"
        aria-label="Learn how specifys.ai works"
        >How It Works</a
      >
    </footer>

    <div class="popup-overlay" id="popupOverlay" style="display: none"></div>
    <div class="popup" id="welcomePopup" style="display: none">
      <h1>Your Simple App Plan</h1>
      <p>
        Here’s your easy-to-follow app plan as a NoCode Creator. Review the
        sections below to bring your idea to life!
      </p>
      <button class="close-btn" onclick="closePopup()">Close</button>
    </div>

    <script
      defer
      src="https://unpkg.com/jspdf@2.5.1/dist/jspdf.umd.min.js"
    ></script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const specContent = document.getElementById("specContent");
        const generatedContent = localStorage.getItem("generatedContent");
        console.log("Generated content:", generatedContent); // לוג לבדיקה

        if (!generatedContent) {
          specContent.innerHTML =
            '<div class="section"><div class="section-title">Error</div><p>No specification available</p></div>';
          console.log("No generated content found in localStorage");
          return;
        }

        document.getElementById("popupOverlay").style.display = "block";
        document.getElementById("welcomePopup").style.display = "block";

        const sections = {};
        let currentSection = "";
        let sectionContent = [];
        const lines = generatedContent.split("\n").map((line) => line.trim());

        lines.forEach((line, index) => {
          if (!line) return;

          // ניקוי השורה והתחשבות בתווים נוספים כמו נקודותיים, רווחים, או תווים מיוחדים
          const normalizedLine = line
            .replace(/[:\s]+$/g, "")
            .replace(/^[\s]+/g, "")
            .trim();
          console.log(`Line ${index}: "${normalizedLine}"`); // לוג לבדיקה

          // זיהוי גמיש של שמות הסקציות
          if (normalizedLine.match(/^(General Information|מידע כללי)$/i)) {
            if (currentSection && sectionContent.length > 0) {
              sections[currentSection] = sectionContent.join("\n");
              console.log(
                `Section "${currentSection}" saved with content:`,
                sectionContent
              );
            }
            currentSection = "general-information";
            sectionContent = [];
          } else if (
            normalizedLine.match(/^(Problem Statement|הצהרת הבעיה)$/i)
          ) {
            if (currentSection && sectionContent.length > 0) {
              sections[currentSection] = sectionContent.join("\n");
              console.log(
                `Section "${currentSection}" saved with content:`,
                sectionContent
              );
            }
            currentSection = "problem-statement";
            sectionContent = [];
          } else if (normalizedLine.match(/^(Core Features|תכונות ליבה)$/i)) {
            if (currentSection && sectionContent.length > 0) {
              sections[currentSection] = sectionContent.join("\n");
              console.log(
                `Section "${currentSection}" saved with content:`,
                sectionContent
              );
            }
            currentSection = "core-features";
            sectionContent = [];
          } else if (normalizedLine.match(/^(User Flow|זרימת משתמש)$/i)) {
            if (currentSection && sectionContent.length > 0) {
              sections[currentSection] = sectionContent.join("\n");
              console.log(
                `Section "${currentSection}" saved with content:`,
                sectionContent
              );
            }
            currentSection = "user-flow";
            sectionContent = [];
          } else if (normalizedLine.match(/^(Screens|מסכים)$/i)) {
            if (currentSection && sectionContent.length > 0) {
              sections[currentSection] = sectionContent.join("\n");
              console.log(
                `Section "${currentSection}" saved with content:`,
                sectionContent
              );
            }
            currentSection = "screens";
            sectionContent = [];
          } else if (
            normalizedLine.match(
              /^(UI Components per Screen|רכיבי ממשק למסך)$/i
            )
          ) {
            if (currentSection && sectionContent.length > 0) {
              sections[currentSection] = sectionContent.join("\n");
              console.log(
                `Section "${currentSection}" saved with content:`,
                sectionContent
              );
            }
            currentSection = "ui-components";
            sectionContent = [];
          } else if (normalizedLine.match(/^(Navigation Map|מפת ניווט)$/i)) {
            if (currentSection && sectionContent.length > 0) {
              sections[currentSection] = sectionContent.join("\n");
              console.log(
                `Section "${currentSection}" saved with content:`,
                sectionContent
              );
            }
            currentSection = "navigation-map";
            sectionContent = [];
          } else if (
            normalizedLine.match(/^(Data Models|מודלים של נתונים)$/i)
          ) {
            if (currentSection && sectionContent.length > 0) {
              sections[currentSection] = sectionContent.join("\n");
              console.log(
                `Section "${currentSection}" saved with content:`,
                sectionContent
              );
            }
            currentSection = "data-models";
            sectionContent = [];
          } else if (
            normalizedLine.match(
              /^(Storage and Backend Logic|לוגיקת אחסון וצד שרת)$/i
            )
          ) {
            if (currentSection && sectionContent.length > 0) {
              sections[currentSection] = sectionContent.join("\n");
              console.log(
                `Section "${currentSection}" saved with content:`,
                sectionContent
              );
            }
            currentSection = "storage-backend-logic";
            sectionContent = [];
          } else if (normalizedLine.match(/^(Offline Mode|מצב לא מקוון)$/i)) {
            if (currentSection && sectionContent.length > 0) {
              sections[currentSection] = sectionContent.join("\n");
              console.log(
                `Section "${currentSection}" saved with content:`,
                sectionContent
              );
            }
            currentSection = "offline-mode";
            sectionContent = [];
          } else if (
            normalizedLine.match(
              /^(User Roles and Permissions|תפקידי משתמשים והרשאות)$/i
            )
          ) {
            if (currentSection && sectionContent.length > 0) {
              sections[currentSection] = sectionContent.join("\n");
              console.log(
                `Section "${currentSection}" saved with content:`,
                sectionContent
              );
            }
            currentSection = "user-roles";
            sectionContent = [];
          } else if (normalizedLine.match(/^(Notifications|התראות)$/i)) {
            if (currentSection && sectionContent.length > 0) {
              sections[currentSection] = sectionContent.join("\n");
              console.log(
                `Section "${currentSection}" saved with content:`,
                sectionContent
              );
            }
            currentSection = "notifications";
            sectionContent = [];
          } else if (
            normalizedLine.match(
              /^(Visual Style Guidelines|הנחיות סגנון ויזואלי)$/i
            )
          ) {
            if (currentSection && sectionContent.length > 0) {
              sections[currentSection] = sectionContent.join("\n");
              console.log(
                `Section "${currentSection}" saved with content:`,
                sectionContent
              );
            }
            currentSection = "visual-style-guidelines";
            sectionContent = [];
          } else if (
            normalizedLine.match(
              /^(Design & UX Principles|עקרונות עיצוב וחוויית משתמש)$/i
            )
          ) {
            if (currentSection && sectionContent.length > 0) {
              sections[currentSection] = sectionContent.join("\n");
              console.log(
                `Section "${currentSection}" saved with content:`,
                sectionContent
              );
            }
            currentSection = "design-ux-principles";
            sectionContent = [];
          } else if (
            normalizedLine.match(/^(Technical Requirements|דרישות טכניות)$/i)
          ) {
            if (currentSection && sectionContent.length > 0) {
              sections[currentSection] = sectionContent.join("\n");
              console.log(
                `Section "${currentSection}" saved with content:`,
                sectionContent
              );
            }
            currentSection = "technical-requirements";
            sectionContent = [];
          } else if (
            normalizedLine.match(/^(Development Phases|שלבי פיתוח)$/i)
          ) {
            if (currentSection && sectionContent.length > 0) {
              sections[currentSection] = sectionContent.join("\n");
              console.log(
                `Section "${currentSection}" saved with content:`,
                sectionContent
              );
            }
            currentSection = "development-phases";
            sectionContent = [];
          } else if (normalizedLine.match(/^(Appendix|נספח)$/i)) {
            if (currentSection && sectionContent.length > 0) {
              sections[currentSection] = sectionContent.join("\n");
              console.log(
                `Section "${currentSection}" saved with content:`,
                sectionContent
              );
            }
            currentSection = "appendix";
            sectionContent = [];
          } else if (currentSection) {
            sectionContent.push(line);
          }
        });

        if (currentSection && sectionContent.length > 0) {
          sections[currentSection] = sectionContent.join("\n");
          console.log(
            `Final section "${currentSection}" saved with content:`,
            sectionContent
          );
        }

        console.log("Parsed sections:", sections); // לוג לבדיקה

        const orderedSections = [
          "general-information",
          "problem-statement",
          "core-features",
          "user-flow",
          "screens",
          "ui-components",
          "navigation-map",
          "data-models",
          "storage-backend-logic",
          "offline-mode",
          "user-roles",
          "notifications",
          "visual-style-guidelines",
          "design-ux-principles",
          "technical-requirements",
          "development-phases",
          "appendix",
        ];

        const sectionTitles = {
          "general-information": "General Information",
          "problem-statement": "Problem Statement",
          "core-features": "Core Features",
          "user-flow": "User Flow",
          screens: "Screens",
          "ui-components": "UI Components per Screen",
          "navigation-map": "Navigation Map",
          "data-models": "Data Models",
          "storage-backend-logic": "Storage and Backend Logic",
          "offline-mode": "Offline Mode",
          "user-roles": "User Roles and Permissions",
          notifications: "Notifications",
          "visual-style-guidelines": "Visual Style Guidelines",
          "design-ux-principles": "Design & UX Principles",
          "technical-requirements": "Technical Requirements",
          "development-phases": "Development Phases",
          appendix: "Appendix",
          "raw-content": "Raw Content (Debug)",
        };

        let htmlContent = "";
        let hasContent = false;

        orderedSections.forEach((section) => {
          if (!sections[section]) {
            console.log(`Section "${section}" not found in parsed sections`);
            return;
          }

          let content = sections[section].trim();
          if (!content) {
            console.log(`Section "${section}" is empty after trimming`);
            return;
          }

          content = content.replace(/\*\*(.*?)\*\*/g, "<strong>$1</strong>");

          htmlContent += `<div class="section" data-section-id="${section}">`;
          htmlContent += `<div class="section-title">${sectionTitles[section]}</div>`;
          htmlContent += `<button class="copy-button" onclick="copySectionContent('${section}')"><i class="fas fa-copy"></i> Copy</button>`;

          if (
            section === "ui-components" ||
            section === "navigation-map" ||
            section === "notifications" ||
            section === "data-models" ||
            section === "storage-backend-logic"
          ) {
            htmlContent += `<pre><code>${content}</code></pre>`;
          } else {
            htmlContent += `<p>${content.split("\n").join("</p><p>")}</p>`;
          }

          htmlContent += `</div>`;
          hasContent = true;
        });

        // הצגת Raw Content רק אם לא זוהו סקציות כלל
        if (!hasContent) {
          let rawContent = generatedContent.trim();
          rawContent = rawContent.replace(
            /\*\*(.*?)\*\*/g,
            "<strong>$1</strong>"
          );

          htmlContent += `<div class="section" data-section-id="raw-content">`;
          htmlContent += `<div class="section-title">${sectionTitles["raw-content"]}</div>`;
          htmlContent += `<button class="copy-button" onclick="copySectionContent('raw-content')"><i class="fas fa-copy"></i> Copy</button>`;
          htmlContent += `<pre><code>${rawContent}</code></pre>`;
          htmlContent += `</div>`;
        }

        specContent.innerHTML = htmlContent;

        window.copySectionContent = function (sectionId) {
          const section = document.querySelector(
            `[data-section-id="${sectionId}"]`
          );
          if (!section) return;

          const sectionTitle = section
            .querySelector(".section-title")
            .textContent.trim();
          const sectionClone = section.cloneNode(true);
          sectionClone.querySelector(".section-title").remove();
          sectionClone.querySelector(".copy-button").remove();
          const sectionContent = sectionClone.textContent.trim();

          const textToCopy = `${sectionTitle}\n${sectionContent}`;

          navigator.clipboard
            .writeText(textToCopy)
            .then(() => {
              const button = section.querySelector(".copy-button");
              button.classList.add("copied");
              button.innerHTML = '<i class="fas fa-check"></i> Copied!';
              setTimeout(() => {
                button.classList.remove("copied");
                button.innerHTML = '<i class="fas fa-copy"></i> Copy';
              }, 2000);
            })
            .catch((err) => {
              alert("Failed to copy content. Please copy it manually.");
              console.error("Copy failed:", err);
            });
        };

        window.downloadPdf = function () {
          const { jsPDF } = window.jspdf;
          if (!jsPDF) {
            alert("jsPDF library not loaded");
            return;
          }

          const doc = new jsPDF();
          const margin = 10;
          const pageWidth = doc.internal.pageSize.getWidth();
          const pageHeight = doc.internal.pageSize.getHeight();
          const maxLineWidth = pageWidth - 2 * margin;
          let yPosition = margin;

          doc.setFontSize(16);
          doc.text("App Plan for NoCode Creators", margin, yPosition);
          yPosition += 10;

          doc.setFontSize(12);
          doc.setTextColor(100);

          const lines = doc.splitTextToSize(
            generatedContent || "No specification available",
            maxLineWidth
          );
          for (let i = 0; i < lines.length; i++) {
            if (yPosition + 10 > pageHeight - margin) {
              doc.addPage();
              yPosition = margin;
            }
            doc.text(lines[i], margin, yPosition);
            yPosition += 7;
          }

          doc.save("app-plan-nocode.pdf");
        };

        window.closePopup = function () {
          document.getElementById("popupOverlay").style.display = "none";
          document.getElementById("welcomePopup").style.display = "none";
        };
      });
    </script>

    <style>
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
    </style>

    <noscript>
      <div
        style="text-align: center; padding: 20px; background: #fff; color: #333"
      >
        <p>
          This website requires JavaScript to function properly. Please enable
          JavaScript in your browser settings.
        </p>
      </div>
    </noscript>
  </body>
</html>
