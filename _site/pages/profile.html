<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <meta name="theme-color" content="#000000">
    <title>My Profile - Specifys.ai</title>
    <meta name="description" content="Manage your Specifys.ai profile and apps">
    <meta name="keywords" content="AI development tools, app specification generator, no-code platform, AI-powered planning, vibe coding, AI app builder, specification generator, market research tool, app planning tool, development tools, AI tools">
    <meta name="author" content="Specifys.ai">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    
    <!-- Content Security Policy - Removed to fix Google Analytics/Ads issues -->
    
    <!-- Canonical URL -->
    
    <link rel="canonical" href="https://specifys-ai.com/pages/profile.html">
    
    
    <!-- Open Graph -->
    <meta property="og:site_name" content="Specifys.ai">
    <meta property="og:title" content="My Profile">
    <meta property="og:description" content="Manage your Specifys.ai profile and apps">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://specifys-ai.com/pages/profile.html">
    <meta property="og:image" content="https://specifys-ai.com/assets/images/og-image.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:locale" content="en_US">
    
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@specifysai">
    <meta name="twitter:creator" content="@specifysai">
    <meta name="twitter:title" content="My Profile">
    <meta name="twitter:description" content="Manage your Specifys.ai profile and apps">
    <meta name="twitter:image" content="https://specifys-ai.com/assets/images/og-image.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/main.css">
    
      
        <link rel="stylesheet" href="/assets/css/pages/profile.css">
      
    
    
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Montserrat:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Mermaid for diagrams (used in demo, spec, research pages) -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.9.1/dist/mermaid.min.js"></script>
    
    <!-- Marked for markdown parsing -->
    <script src="https://cdn.jsdelivr.net/npm/marked@4.3.0/marked.min.js"></script>
    
    <!-- Highlight.js for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- jsPDF for PDF export (used in research pages) -->
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RWBT69JCM7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-RWBT69JCM7');
</script>


    <script>
// Central Analytics Event Tracking System for Specifys.ai
// This file contains reusable tracking functions for consistent analytics across the site

// Check if gtag is available
function isGtagAvailable() {
  return typeof gtag !== 'undefined';
}

// Track button clicks with detailed categorization
function trackButtonClick(buttonName, category, source, additionalData = {}) {
  if (isGtagAvailable()) {
    gtag('event', 'click', {
      'event_category': category || 'Button Click',
      'event_label': buttonName,
      'event_source': source || 'unknown',
      ...additionalData
    });
  }
}

// Track CTA (Call-to-Action) clicks
function trackCTA(ctaName, location) {
  if (isGtagAvailable()) {
    gtag('event', 'cta_click', {
      'event_category': 'CTA',
      'event_label': ctaName,
      'cta_location': location
    });
  }
}

// Track navigation events
function trackNavigation(destination, source) {
  if (isGtagAvailable()) {
    gtag('event', 'navigation', {
      'event_category': 'Navigation',
      'event_label': destination,
      'navigation_source': source
    });
  }
}

// Track tool usage
function trackToolUsage(toolName, action) {
  if (isGtagAvailable()) {
    gtag('event', 'tool_usage', {
      'event_category': 'Tools',
      'event_label': toolName,
      'tool_action': action
    });
  }
}

// Track form submissions
function trackFormSubmit(formName, formType) {
  if (isGtagAvailable()) {
    gtag('event', 'form_submit', {
      'event_category': 'Form',
      'event_label': formName,
      'form_type': formType
    });
  }
}

// Track user authentication events
function trackAuthEvent(action, method) {
  if (isGtagAvailable()) {
    gtag('event', action, {
      'event_category': 'Authentication',
      'event_label': action,
      'auth_method': method || 'email'
    });
  }
}

// Track downloads
function trackDownload(fileName, fileType) {
  if (isGtagAvailable()) {
    gtag('event', 'download', {
      'event_category': 'Downloads',
      'event_label': fileName,
      'file_type': fileType
    });
  }
}

// Track spec/result generations
function trackGeneration(type, mode) {
  if (isGtagAvailable()) {
    gtag('event', 'generation_start', {
      'event_category': 'Generation',
      'event_label': type,
      'generation_mode': mode
    });
  }
}

// Track generation completion
function trackGenerationComplete(type, mode, success) {
  if (isGtagAvailable()) {
    gtag('event', 'generation_complete', {
      'event_category': 'Generation',
      'event_label': type,
      'generation_mode': mode,
      'success': success
    });
  }
}

// Track external link clicks
function trackExternalLink(linkUrl, linkText) {
  if (isGtagAvailable()) {
    gtag('event', 'click', {
      'event_category': 'External Link',
      'event_label': linkText || linkUrl,
      'link_url': linkUrl
    });
  }
}

// Track modal interactions
function trackModal(modalName, action) {
  if (isGtagAvailable()) {
    gtag('event', 'modal_' + action, {
      'event_category': 'Modal',
      'event_label': modalName,
      'modal_action': action
    });
  }
}

// Track FAQ interactions
function trackFAQ(question, action) {
  if (isGtagAvailable()) {
    gtag('event', 'faq_' + action, {
      'event_category': 'FAQ',
      'event_label': question,
      'faq_action': action
    });
  }
}

// Track search actions
function trackSearch(searchTerm, searchType) {
  if (isGtagAvailable()) {
    gtag('event', 'search', {
      'event_category': 'Search',
      'search_term': searchTerm,
      'search_type': searchType
    });
  }
}

// Track video/demo views
function trackDemoView(demoName, viewDuration) {
  if (isGtagAvailable()) {
    gtag('event', 'demo_view', {
      'event_category': 'Demo',
      'event_label': demoName,
      'view_duration': viewDuration
    });
  }
}

// Track user engagement time
function trackEngagement(pageName, timeSpent) {
  if (isGtagAvailable()) {
    gtag('event', 'user_engagement', {
      'event_category': 'Engagement',
      'event_label': pageName,
      'engagement_time_msec': timeSpent
    });
  }
}

// Track errors
function trackError(errorType, errorMessage, errorLocation) {
  if (isGtagAvailable()) {
    gtag('event', 'error', {
      'event_category': 'Error',
      'event_label': errorType,
      'error_message': errorMessage,
      'error_location': errorLocation
    });
  }
}

// Track user preferences
function trackPreference(preferenceName, preferenceValue) {
  if (isGtagAvailable()) {
    gtag('event', 'preference_change', {
      'event_category': 'Preferences',
      'event_label': preferenceName,
      'preference_value': preferenceValue
    });
  }
}

// Track scroll depth
let scrollDepthTracked = {25: false, 50: false, 75: false, 100: false};
function initScrollTracking(pageName) {
  window.addEventListener('scroll', function() {
    const scrollPercent = Math.round((window.scrollY / (document.documentElement.scrollHeight - window.innerHeight)) * 100);
    
    if (scrollPercent >= 25 && !scrollDepthTracked[25]) {
      scrollDepthTracked[25] = true;
      if (isGtagAvailable()) {
        gtag('event', 'scroll', {
          'event_category': 'Scroll Depth',
          'event_label': pageName,
          'scroll_depth': '25%'
        });
      }
    }
    if (scrollPercent >= 50 && !scrollDepthTracked[50]) {
      scrollDepthTracked[50] = true;
      if (isGtagAvailable()) {
        gtag('event', 'scroll', {
          'event_category': 'Scroll Depth',
          'event_label': pageName,
          'scroll_depth': '50%'
        });
      }
    }
    if (scrollPercent >= 75 && !scrollDepthTracked[75]) {
      scrollDepthTracked[75] = true;
      if (isGtagAvailable()) {
        gtag('event', 'scroll', {
          'event_category': 'Scroll Depth',
          'event_label': pageName,
          'scroll_depth': '75%'
        });
      }
    }
    if (scrollPercent >= 100 && !scrollDepthTracked[100]) {
      scrollDepthTracked[100] = true;
      if (isGtagAvailable()) {
        gtag('event', 'scroll', {
          'event_category': 'Scroll Depth',
          'event_label': pageName,
          'scroll_depth': '100%'
        });
      }
    }
  });
}

// Auto-initialize scroll tracking when DOM is ready
document.addEventListener('DOMContentLoaded', function() {
  const pageName = document.title || window.location.pathname;
  initScrollTracking(pageName);
});
</script>


    <!-- Structured Data (JSON-LD) for SEO -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "Organization",
      "name": "Specifys.ai",
      "url": "https://specifys-ai.com",
      "logo": "https://specifys-ai.com/favicon.ico",
      "description": "AI-powered app planning and specification generation platform",
      "sameAs": [
        "https://www.linkedin.com/company/specifys-ai/"
      ],
      "contactPoint": {
        "@type": "ContactPoint",
        "email": "specifysai@gmail.com",
        "contactType": "Customer Service"
      }
    },
    {
      "@type": "WebSite",
      "name": "Specifys.ai",
      "url": "https://specifys-ai.com",
      "description": "Plan your app smarter with AI-driven insights and tools",
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://specifys-ai.com/pages/ToolPicker.html?q={search_term_string}",
        "query-input": "required name=search_term_string"
      }
    },
    {
      "@type": "SoftwareApplication",
      "name": "Specifys.ai",
      "applicationCategory": "DevelopmentApplication",
      "operatingSystem": "Web",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.8",
        "ratingCount": "250"
      },
      "description": "AI-powered app planning platform with specification generator, market research tools, and vibe coding tools map"
    }
  ]
}
</script>


</head>


<body>
    <!-- Header -->
    <!-- Skip to main content link for accessibility -->
<a href="#main-content" class="skip-link">Skip to main content</a>

<!-- Header -->
<header class="thematic-header" role="banner">
    <div class="header-center">
        <div class="logo">
            <a href="/" aria-label="Specifys.ai homepage">
                <span class="logo-text">Specifys<span class="logo-dot">.</span>AI</span>
            </a>
        </div>
    </div>
    <div class="header-right">
        <div class="auth-buttons" id="auth-buttons">
            <!-- Will be populated by auth system -->
        </div>
    </div>
</header>

<style>
/* Logo dark grey color - adjusted size */
.logo a,
.logo-text {
    color: #333 !important;
    font-size: 1.66rem !important;
}

/* Only the dot in cyan */
.logo-dot {
    color: #0078d4 !important;
}

.logo a:hover {
    color: #444 !important;
}

.logo a:hover .logo-dot {
    color: #005ea2 !important;
}

/* Mobile adjustments */
@media (max-width: 768px) {
    .logo a,
    .logo-text {
        font-size: 1.22rem !important;
    }
}

@media (max-width: 480px) {
    .logo a,
    .logo-text {
        font-size: 1.11rem !important;
    }
}
</style>


    
    <!-- Main Content -->
    <main id="main-content" class="main-content">
            <main class="profile-container">
        <!-- User Profile Header -->
        <div class="profile-header">
            <div class="profile-avatar-section">
                <div class="avatar-placeholder" id="user-avatar">
                    <span id="avatar-initial">👤</span>
                </div>
                <div class="profile-actions-buttons">
                    <button class="admin-dashboard-btn" id="admin-dashboard-btn" style="display: none;" onclick="window.location.href='/pages/admin-dashboard.html'" title="Admin Dashboard">
                        <i class="fas fa-user-shield"></i> Admin Dashboard
                    </button>
                    <button class="logout-btn-small" onclick="logout()" title="Sign Out">
                        Sign Out
                    </button>
                </div>
            </div>
            <div class="profile-info">
                <h2 id="user-name">Loading...</h2>
                <p id="user-email">Loading...</p>
            </div>
            <div class="profile-stats">
                <div class="stat-item">
                    <div class="stat-number" id="apps-count">0</div>
                    <div class="stat-label">Apps</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="specs-count">0</div>
                    <div class="stat-label">Specs</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="research-count">0</div>
                    <div class="stat-label">Research</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="saved-tools-count">0</div>
                    <div class="stat-label">Tools</div>
                </div>
            </div>
        </div>


        <!-- User's Apps Section -->
        <div class="profile-specs-section">
            <div class="section-header">
                <h3>My Apps</h3>
                <div class="section-actions">
                    <button class="create-app-btn" onclick="showCreateAppModal()">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
            </div>

            <div id="apps-container" class="apps-grid">
                <div class="loading">Loading apps...</div>
            </div>
        </div>

        <!-- User's Content Section (Tabbed) -->
        <div class="profile-specs-section">
            <div class="section-header">
                <h3>My Content</h3>
            </div>
            
            <div class="tabbed-section">
                <div class="tab-header">
                    <div class="tab-buttons">
                        <button class="tab-button active" onclick="switchProfileTab('specs')" data-tab="specs">
                            <i class="fas fa-clipboard-list"></i> Specifications
                        </button>
                        <button class="tab-button" onclick="switchProfileTab('research')" data-tab="research">
                            <i class="fas fa-search"></i> Market Research
                        </button>
                        <button class="tab-button" onclick="switchProfileTab('tools')" data-tab="tools">
                            <i class="fas fa-wrench"></i> Saved Tools
                        </button>
                    </div>
                    <div class="tab-actions" id="profile-tab-actions">
                        <div class="action-buttons">
                            <!-- Filters removed as requested -->
                        </div>
                    </div>
                </div>
                <div class="tab-content expanded">
                    <div class="tab-pane active" id="specs-tab">
                        <div id="specs-container" class="apps-grid">
                            <div class="loading">Loading specifications...</div>
                        </div>
                    </div>
                    <div class="tab-pane" id="research-tab">
                        <div id="research-container" class="apps-grid">
                            <div class="loading">Loading market research...</div>
                        </div>
                    </div>
                    <div class="tab-pane" id="tools-tab">
                        <div id="tools-container" class="apps-grid">
                            <div class="loading">Loading tools...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <!-- Admin Dashboard Button - Only visible for admins -->
    <div class="admin-section" style="margin: 40px auto; text-align: center; padding: 20px; max-width: 1200px; display: none;">
        <a href="admin-dashboard.html" class="btn btn-primary">
            <i class="fas fa-tachometer-alt"></i>
            Admin Dashboard
        </a>
    </div>

    <script src="../assets/js/script.js"></script>

    <!-- Header and Theme JavaScript -->
    <script>
        // Basic header functionality
        document.addEventListener('DOMContentLoaded', function() {
            
            
            
        });

        // Auth UI functions will be handled by the modern Firebase v9+ script below
    </script>

    <!-- Auth System Script -->
    <script type="module">
        // Import Firebase SDK
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { 
            createUserWithEmailAndPassword, 
            signInWithEmailAndPassword, 
            signOut, 
            onAuthStateChanged,
            GoogleAuthProvider,
            signInWithPopup,
            getAuth
        } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
        import { doc as firestoreDoc, setDoc as firestoreSetDoc, serverTimestamp as firestoreServerTimestamp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        import { 
            collection, 
            addDoc, 
            getDocs, 
            query, 
            where, 
            orderBy,
            serverTimestamp,
            getFirestore,
            deleteDoc,
            doc,
            setDoc,
            getDoc
        } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyB9hr0IWM4EREzkKDxBxYoYinV6LJXWXV4",
            authDomain: "specify-ai.firebaseapp.com",
            projectId: "specify-ai",
            storageBucket: "specify-ai.firebasestorage.app",
            messagingSenderId: "734278787482",
            appId: "1:734278787482:web:0e312fb6f197e849695a23",
            measurementId: "G-4YR9LK63MR"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const googleProvider = new GoogleAuthProvider();

        // Create user document in Firestore
        async function createUserDocumentInProfile(user) {
            try {
                const userRef = firestoreDoc(db, 'users', user.uid);
                await firestoreSetDoc(userRef, {
                    email: user.email,
                    displayName: user.displayName || user.email.split('@')[0],
                    emailVerified: user.emailVerified,
                    createdAt: firestoreServerTimestamp(),
                    lastActive: firestoreServerTimestamp(),
                    newsletterSubscription: false
                }, { merge: true });
            } catch (error) {
                console.error('❌ Error creating user document:', error);
            }
        }

        let currentUser = null;
        let userSpecs = [];
        let userApps = [];
        let userSavedTools = [];
        let userMarketResearch = [];
        
        // Prevent multiple event listeners and debouncing
        let eventListenersSetup = false;
        let updateTimeout;

        // Auth state change handler
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                currentUser = user;
                
                // Create/update user document in Firestore
                await createUserDocumentInProfile(user);
                
                updateProfileInfo(user);
                loadUserApps();
                loadUserSpecs();
                loadUserSavedTools();
                loadUserMarketResearch();
                updateAuthUI(user);
            } else {
                // Redirect to login if not authenticated
                window.location.href = '../index.html';
            }
        });

        // Update profile information
        function updateProfileInfo(user) {
            const userName = document.getElementById('user-name');
            const userEmail = document.getElementById('user-email');
            const avatarInitial = document.getElementById('avatar-initial');

            if (userName) {
                userName.textContent = user.displayName || user.email.split('@')[0];
            }
            
            if (userEmail) {
                userEmail.textContent = user.email;
            }
            
            if (avatarInitial) {
                if (user.displayName) {
                    avatarInitial.textContent = user.displayName.charAt(0).toUpperCase();
                } else {
                    avatarInitial.textContent = user.email.charAt(0).toUpperCase();
                }
            }
            
            // Check admin access and show/hide admin dashboard button
            checkAdminAccess(user);
        }

        // Load user apps
        async function loadUserApps() {
            if (!currentUser) return;
            
            try {
                const q = query(
                    collection(db, 'apps'),
                    where('userId', '==', currentUser.uid),
                    orderBy('createdAt', 'desc')
                );
                
                const querySnapshot = await getDocs(q);
                userApps = [];
                
                querySnapshot.forEach((doc) => {
                    const appData = {
                        id: doc.id,
                        ...doc.data()
                    };
                    userApps.push(appData);
                });
                
                document.getElementById('apps-count').textContent = userApps.length;
                renderApps();
                
                // Update button appearance after loading apps
                setTimeout(updateLinkButtonAppearance, 200);
            } catch (error) {
                console.error('Error loading apps:', error);
                document.getElementById('apps-container').innerHTML = '<div class="error">Error loading apps</div>';
            }
        }

        // Load user specs
        async function loadUserSpecs() {
            if (!currentUser) return;
            
            try {
                const q = query(
                    collection(db, 'specs'),
                    where('userId', '==', currentUser.uid),
                    orderBy('createdAt', 'desc')
                );
                
                const querySnapshot = await getDocs(q);
                userSpecs = [];
                
                querySnapshot.forEach((doc) => {
                    userSpecs.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                
                document.getElementById('specs-count').textContent = userSpecs.length;
                renderSpecs();
                setTimeout(updateLinkButtonAppearance, 100);
            } catch (error) {
                console.error('Error loading specs:', error);
                document.getElementById('specs-container').innerHTML = '<div class="error">Error loading specifications</div>';
            }
        }

        // Load user saved tools
        async function loadUserSavedTools() {
            if (!currentUser) return;
            
            try {
                const q = query(
                    collection(db, 'userTools', currentUser.uid, 'savedTools'),
                    orderBy('addedAt', 'desc')
                );
                
                const querySnapshot = await getDocs(q);
                userSavedTools = [];
                
                querySnapshot.forEach((doc) => {
                    userSavedTools.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                
                document.getElementById('saved-tools-count').textContent = userSavedTools.length;
                renderSavedTools(userSavedTools);
            } catch (error) {
                console.error('Error loading saved tools:', error);
                document.getElementById('tools-container').innerHTML = '<div class="error">Error loading saved tools</div>';
            }
        }

        // Load user market research
        async function loadUserMarketResearch() {
            if (!currentUser) return;
            
            try {
                // Load from marketResearch collection (new)
                const q1 = query(
                    collection(db, 'marketResearch'),
                    where('userId', '==', currentUser.uid)
                );
                
                const querySnapshot1 = await getDocs(q1);
                userMarketResearch = [];
                
                querySnapshot1.forEach((doc) => {
                    userMarketResearch.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                
                // Load from specs collection with mode: "market" (old)
                const q2 = query(
                    collection(db, 'specs'),
                    where('userId', '==', currentUser.uid),
                    where('mode', '==', 'market')
                );
                
                const querySnapshot2 = await getDocs(q2);
                
                querySnapshot2.forEach((doc) => {
                    userMarketResearch.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                
                // Sort by creation date
                userMarketResearch.sort((a, b) => {
                    const dateA = a.createdAt?.toDate?.() || a.createdAt;
                    const dateB = b.createdAt?.toDate?.() || b.createdAt;
                    return new Date(dateB) - new Date(dateA);
                });
                
                document.getElementById('research-count').textContent = userMarketResearch.length;
                renderMarketResearch();
                setTimeout(updateLinkButtonAppearance, 100);
            } catch (error) {
                console.error('Error loading market research:', error);
                document.getElementById('research-count').textContent = '0';
            }
        }

        // Render saved tools in grid layout
        function renderSavedTools(tools) {
            const toolsContainer = document.getElementById('tools-container');
            
            if (tools.length === 0) {
                toolsContainer.innerHTML = `
                    <div class="no-specs">
                        <div class="no-specs-icon"><i class="fas fa-wrench"></i></div>
                        <h4>No saved tools yet</h4>
                        <p>Add tools from the Tools Map to see them here!</p>
                        <a href="../tools/map/vibe-coding-tools-map.html" class="btn">Explore Tools Map</a>
                    </div>
                `;
                return;
            }

            toolsContainer.innerHTML = tools.map(tool => `
                <div class="app-card" data-tool-id="${tool.id}">
                    <div class="app-card-header">
                        <h4 class="app-card-title">
                            <span class="spec-link">${tool.name || 'Unknown Tool'}</span>
                        </h4>
                        <div class="app-card-actions">
                            <button class="btn-icon" onclick="removeSavedTool('${tool.id}')" title="Remove from saved tools">
                                <i class="fas fa-trash"></i>
                            </button>
                            ${tool.link && tool.link !== '#' ? `<button class="btn-icon" onclick="window.open('${tool.link}', '_blank')" title="Visit tool website"><i class="fas fa-external-link-alt"></i></button>` : ''}
                        </div>
                    </div>
                    <div class="app-card-content">
                        <div class="app-stats-minimal">
                            <div class="app-stat-minimal">
                                <i class="fas fa-wrench"></i>
                                <span>Tool</span>
                            </div>
                        </div>
                    </div>
                    <div class="app-card-footer">
                        <small>Saved: ${new Date(tool.addedAt).toLocaleDateString()}</small>
                    </div>
                </div>
            `).join('');
        }

        // Render apps in grid layout
        function renderApps() {
            const appsContainer = document.getElementById('apps-container');
            
            if (userApps.length === 0) {
                appsContainer.innerHTML = `
                    <div class="no-specs">
                        <div class="no-specs-icon"><i class="fas fa-mobile-alt"></i></div>
                        <h4>No apps yet</h4>
                        <p>Create your first app to get started!</p>
                        <button class="btn" onclick="showCreateAppModal()">
                            Create New App
                        </button>
                    </div>
                `;
                return;
            }
            
            appsContainer.innerHTML = userApps.map(app => {
                const specsCount = app.linkedSpecs ? app.linkedSpecs.length : 0;
                const researchCount = app.linkedResearch ? app.linkedResearch.length : 0;
                
                return `
                    <div class="app-card" data-app-id="${app.id}">
                        <div class="app-card-header">
                            <h4 class="app-card-title">
                                <a href="app-dashboard.html?id=${app.id}" class="spec-link">${app.name}</a>
                            </h4>
                            <div class="app-card-actions">
                                <button class="btn-icon" onclick="editAppCard('${app.id}')" title="Edit">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn-icon" onclick="deleteAppCard('${app.id}')" title="Delete">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <div class="app-card-content">
                            
                            <!-- App Statistics - Simplified -->
                            <div class="app-stats-minimal">
                                <div class="app-stat-minimal">
                                    <i class="fas fa-file-alt"></i>
                                    <span>${specsCount} Specs</span>
                                </div>
                                <div class="app-stat-minimal">
                                    <i class="fas fa-search"></i>
                                    <span>${researchCount} Research</span>
                                </div>
                            </div>
                        </div>
                        <div class="app-card-footer">
                            <small>Created: ${new Date(app.createdAt?.toDate?.() || app.createdAt).toLocaleDateString('en-US')}</small>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Render specs in grid layout
        function renderSpecs() {
            const specsContainer = document.getElementById('specs-container');
            
            if (userSpecs.length === 0) {
                specsContainer.innerHTML = `
                    <div class="no-specs">
                        <div class="no-specs-icon"><i class="fas fa-file-alt"></i></div>
                        <h4>No specifications yet</h4>
                        <p>Create your first specification to get started!</p>
                        <button class="btn" onclick="window.location.href='processing-unified.html'">
                            Create New Specification
                        </button>
                    </div>
                `;
                return;
            }
            
            specsContainer.innerHTML = userSpecs.map(spec => `
                <div class="app-card" data-spec-id="${spec.id}">
                    <div class="app-card-header">
                        <h4 class="app-card-title">
                            <a href="spec.html?id=${spec.id}" class="spec-link">${spec.title}</a>
                        </h4>
                        <div class="app-card-actions">
                            <button class="btn-icon link-spec-btn" data-spec-id="${spec.id}" title="Link to App">
                                <i class="fas fa-link"></i>
                            </button>
                            <button class="btn-icon" onclick="editSpecCard('${spec.id}')" title="Edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn-icon" onclick="deleteSpecCard('${spec.id}')" title="Delete">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="app-card-content">
                        <div class="app-stats-minimal">
                            <div class="app-stat-minimal">
                                <i class="fas fa-file-alt"></i>
                                <span>Specification</span>
                            </div>
                        </div>
                    </div>
                    <div class="app-card-footer">
                        <small>Created: ${new Date(spec.createdAt?.toDate?.() || spec.createdAt).toLocaleDateString('en-US')}</small>
                    </div>
                </div>
            `).join('');
            
            // Update link button appearance after rendering specs
            setTimeout(updateLinkButtonAppearance, 50);
        }

        // Render market research in grid layout
        function renderMarketResearch() {
            const researchContainer = document.getElementById('research-container');
            
            if (userMarketResearch.length === 0) {
                researchContainer.innerHTML = `
                    <div class="no-specs">
                        <div class="no-specs-icon"><i class="fas fa-search"></i></div>
                        <h4>No market research yet</h4>
                        <p>Create your first market research to get started!</p>
                        <button class="btn" onclick="window.location.href='processing-market.html'">
                            Create New Market Research
                        </button>
                    </div>
                `;
                return;
            }
            
            researchContainer.innerHTML = userMarketResearch.map(research => `
                <div class="app-card" data-research-id="${research.id}">
                    <div class="app-card-header">
                        <h4 class="app-card-title">
                            <a href="research.html?id=${research.id}" class="spec-link">${research.title}</a>
                        </h4>
                        <div class="app-card-actions">
                            <button class="btn-icon link-research-btn" data-research-id="${research.id}" title="Link to App">
                                <i class="fas fa-link"></i>
                            </button>
                            <button class="btn-icon" onclick="editResearchCard('${research.id}')" title="Edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn-icon" onclick="deleteResearchCard('${research.id}')" title="Delete">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="app-card-content">
                        <div class="app-stats-minimal">
                            <div class="app-stat-minimal">
                                <i class="fas fa-search"></i>
                                <span>Market Research</span>
                            </div>
                        </div>
                    </div>
                    <div class="app-card-footer">
                        <small>Created: ${new Date(research.createdAt?.toDate?.() || research.createdAt).toLocaleDateString('en-US')}</small>
                    </div>
                </div>
            `).join('');
            
            // Update link button appearance after rendering market research
            setTimeout(updateLinkButtonAppearance, 50);
        }

        // Search functionality for apps - removed as requested

        // Search functionality for tabbed content
        // Search functionality for tabbed content - removed as requested

        // Sort functionality for apps - removed as requested

        // Sort functionality for tabbed content
        // Sort functionality for tabbed content - removed as requested

        function renderFilteredApps(apps) {
            const appsContainer = document.getElementById('apps-container');
            
            if (apps.length === 0) {
                appsContainer.innerHTML = '<div class="no-results">No apps found</div>';
                return;
            }
            
            appsContainer.innerHTML = apps.map(app => {
                const specsCount = app.linkedSpecs ? app.linkedSpecs.length : 0;
                const researchCount = app.linkedResearch ? app.linkedResearch.length : 0;
                
                return `
                    <div class="app-card" data-app-id="${app.id}">
                        <div class="app-card-header">
                            <h4 class="app-card-title">
                                <a href="app-dashboard.html?id=${app.id}" class="spec-link">${app.name}</a>
                            </h4>
                            <div class="app-card-actions">
                                <button class="btn-icon" onclick="editAppCard('${app.id}')" title="Edit">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn-icon" onclick="deleteAppCard('${app.id}')" title="Delete">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <div class="app-card-content">
                            
                            <!-- App Statistics - Simplified -->
                            <div class="app-stats-minimal">
                                <div class="app-stat-minimal">
                                    <i class="fas fa-file-alt"></i>
                                    <span>${specsCount} Specs</span>
                                </div>
                                <div class="app-stat-minimal">
                                    <i class="fas fa-search"></i>
                                    <span>${researchCount} Research</span>
                                </div>
                            </div>
                        </div>
                        <div class="app-card-footer">
                            <small>Created: ${new Date(app.createdAt?.toDate?.() || app.createdAt).toLocaleDateString('en-US')}</small>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderFilteredSpecs(specs) {
            const specsContainer = document.getElementById('specs-container');
            
            if (specs.length === 0) {
                specsContainer.innerHTML = '<div class="no-results">No specifications found</div>';
                return;
            }
            
            specsContainer.innerHTML = specs.map(spec => `
                <div class="spec-card" data-spec-id="${spec.id}">
                    <div class="spec-card-header">
                        <h4 class="spec-card-title">
                            <a href="spec.html?id=${spec.id}" class="spec-link">${spec.title}</a>
                        </h4>
                        <div class="spec-card-actions">
                            <button class="btn-icon link-spec-btn" data-spec-id="${spec.id}" title="Link to App">
                                <i class="fas fa-link"></i>
                            </button>
                            <button class="btn-icon" onclick="editSpecCard('${spec.id}')" title="Edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn-icon" onclick="deleteSpecCard('${spec.id}')" title="Delete">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="spec-card-content">
                        <!-- Mode badge removed as requested -->
                    </div>
                    <div class="spec-card-footer">
                        <small>Created: ${new Date(spec.createdAt?.toDate?.() || spec.createdAt).toLocaleDateString('en-US')}</small>
                    </div>
                </div>
            `).join('');
        }

        function renderFilteredResearch(research) {
            const researchContainer = document.getElementById('research-container');
            
            if (research.length === 0) {
                researchContainer.innerHTML = '<div class="no-results">No market research found</div>';
                return;
            }
            
            researchContainer.innerHTML = research.map(research => `
                <div class="spec-card" data-research-id="${research.id}">
                    <div class="spec-card-header">
                        <h4 class="spec-card-title">
                            <a href="research.html?id=${research.id}" class="spec-link">${research.title}</a>
                        </h4>
                        <div class="spec-card-actions">
                            <button class="btn-icon link-research-btn" data-research-id="${research.id}" title="Link to App">
                                <i class="fas fa-link"></i>
                            </button>
                            <button class="btn-icon" onclick="editResearchCard('${research.id}')" title="Edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn-icon" onclick="deleteResearchCard('${research.id}')" title="Delete">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="spec-card-content">
                        <!-- Research content preview -->
                    </div>
                    <div class="spec-card-footer">
                        <small>Created: ${new Date(research.createdAt?.toDate?.() || research.createdAt).toLocaleDateString('en-US')}</small>
                    </div>
                </div>
            `).join('');
        }

        function renderFilteredTools(tools) {
            const toolsContainer = document.getElementById('tools-container');
            
            if (tools.length === 0) {
                toolsContainer.innerHTML = '<div class="no-results">No tools found</div>';
                return;
            }

            toolsContainer.innerHTML = tools.map(tool => `
                <div class="app-card" data-tool-id="${tool.id}">
                    <div class="app-card-header">
                        <h4 class="app-card-title">
                            <span class="spec-link">${tool.name || 'Unknown Tool'}</span>
                        </h4>
                        <div class="app-card-actions">
                            <button class="btn-icon" onclick="removeSavedTool('${tool.id}')" title="Remove from saved tools">
                                <i class="fas fa-trash"></i>
                            </button>
                            ${tool.link && tool.link !== '#' ? `<button class="btn-icon" onclick="window.open('${tool.link}', '_blank')" title="Visit tool website"><i class="fas fa-external-link-alt"></i></button>` : ''}
                        </div>
                    </div>
                    <div class="app-card-content">
                        <div class="app-stats-minimal">
                            <div class="app-stat-minimal">
                                <i class="fas fa-wrench"></i>
                                <span>Tool</span>
                            </div>
                        </div>
                    </div>
                    <div class="app-card-footer">
                        <small>Saved: ${new Date(tool.addedAt).toLocaleDateString()}</small>
                    </div>
                </div>
            `).join('');
        }

        // Create app button (optional - already uses onclick in HTML)
        const createAppBtn = document.getElementById('create-app-btn');
        if (createAppBtn) {
            createAppBtn.addEventListener('click', () => {
                showCreateAppModal();
            });
        }

        // Global functions for app actions
        window.showCreateAppModal = function() {
            // Create modal HTML
            const modalHTML = `
                <div id="createAppModal" class="modal-overlay">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3>Create New App</h3>
                            <button class="modal-close" onclick="closeCreateAppModal()">&times;</button>
                        </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <label for="appNameInput">App Name *</label>
                                <input type="text" id="appNameInput" placeholder="Enter app name..." required>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-secondary" onclick="closeCreateAppModal()">Cancel</button>
                            <button class="btn btn-primary" onclick="submitCreateApp()">Create App</button>
                        </div>
                    </div>
                </div>
            `;
            
            // Add modal to body
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            
            // Focus on input
            setTimeout(() => {
                document.getElementById('appNameInput').focus();
            }, 100);
        };

        window.closeCreateAppModal = function() {
            const modal = document.getElementById('createAppModal');
            if (modal) {
                modal.remove();
            }
        };

        window.submitCreateApp = function() {
            const appNameInput = document.getElementById('appNameInput');
            const appName = appNameInput.value.trim();
            
            if (!appName) {
                appNameInput.style.borderColor = '#ff4444';
                appNameInput.focus();
                return;
            }
            
            // Close modal
            closeCreateAppModal();
            
            // Create app
            createNewApp(appName, '', 0);
        };

        window.editAppCard = async function(appId) {
            const app = userApps.find(a => a.id === appId);
            if (!app) return;
            
            const newName = prompt('Edit app name:', app.name);
            if (newName === null || newName.trim() === '') return;
            
            try {
                const { doc, setDoc } = await import("https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js");
                const appRef = doc(db, 'apps', appId);
                await setDoc(appRef, {
                    name: newName.trim(),
                    updatedAt: new Date().toISOString()
                }, { merge: true });
                
                // Update local data
                app.name = newName.trim();
                app.updatedAt = new Date().toISOString();
                
                // Refresh the display
                renderApps();
            } catch (error) {
                console.error("Error updating app:", error);
                alert("Failed to update app. Please try again.");
            }
        };

        window.deleteAppCard = async function(appId) {
            if (!confirm('Are you sure you want to delete this app? This action cannot be undone.')) {
                return;
            }
            
            try {
                const { doc, deleteDoc } = await import("https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js");
                const appRef = doc(db, 'apps', appId);
                await deleteDoc(appRef);
                
                // Remove from local data
                userApps = userApps.filter(app => app.id !== appId);
                
                // Refresh the display
                renderApps();
            } catch (error) {
                console.error("Error deleting app:", error);
                alert("Failed to delete app. Please try again.");
            }
        };

        window.openAppDashboard = function(appId) {
            window.location.href = `app-dashboard.html?id=${appId}`;
        };

        // Global functions for spec actions
        window.editSpecCard = async function(specId) {
            const spec = userSpecs.find(s => s.id === specId);
            if (!spec) {
                alert('Specification not found');
                return;
            }
            
            const newTitle = prompt('Edit title:', spec.title);
            if (newTitle === null || newTitle.trim() === '') return;
            
            try {
                // Update in Firestore
                const specRef = doc(db, 'specs', specId);
                await setDoc(specRef, {
                    title: newTitle.trim(),
                    updatedAt: new Date().toISOString()
                }, { merge: true });
                
                // Update local data
                const specIndex = userSpecs.findIndex(s => s.id === specId);
                if (specIndex !== -1) {
                    userSpecs[specIndex].title = newTitle.trim();
                }
                
                // Re-render specs
                renderSpecs();
                
                // Update link button appearance after re-render
                setTimeout(updateLinkButtonAppearance, 100);
                
                showSuccess('Specification title updated successfully!');
                
            } catch (error) {
                console.error('Error updating spec title:', error);
                showError('Failed to update specification title');
            }
        };

        window.deleteSpecCard = function(specId) {
            if (!confirm('Are you sure you want to delete this specification?')) {
                return;
            }
            
            try {
                // Remove from DOM - find and remove the spec card element
                const specCard = document.querySelector(`[data-spec-id="${specId}"]`);
                if (specCard) {
                    specCard.remove();
                }
                
                // Remove from local userSpecs array
                const specIndex = userSpecs.findIndex(spec => spec.id === specId);
                if (specIndex !== -1) {
                    userSpecs.splice(specIndex, 1);
                }
                
                // Show success message
                alert('Specification removed successfully from interface');
                
            } catch (error) {
                console.error('Error removing spec from UI:', error);
                alert('Error removing specification from interface');
            }
        };

        // Global functions for research actions
        window.editResearchCard = async function(researchId) {
            const research = userMarketResearch.find(r => r.id === researchId);
            if (!research) {
                alert('Market research not found');
                return;
            }
            
            const newTitle = prompt('Edit title:', research.title);
            if (newTitle === null || newTitle.trim() === '') return;
            
            try {
                // Update in Firestore
                const researchRef = doc(db, 'marketResearch', researchId);
                await setDoc(researchRef, {
                    title: newTitle.trim(),
                    updatedAt: new Date().toISOString()
                }, { merge: true });
                
                // Update local data
                const researchIndex = userMarketResearch.findIndex(r => r.id === researchId);
                if (researchIndex !== -1) {
                    userMarketResearch[researchIndex].title = newTitle.trim();
                }
                
                // Re-render market research
                renderMarketResearch();
                
                // Update link button appearance after re-render
                setTimeout(updateLinkButtonAppearance, 100);
                
                console.log('✅ Market research title updated successfully');
                showSuccess('Market research title updated successfully!');
                
            } catch (error) {
                console.error('Error updating market research title:', error);
                showError('Failed to update market research title');
            }
        };

        window.deleteResearchCard = function(researchId) {
            if (!confirm('Are you sure you want to delete this market research?')) {
                return;
            }
            
            // Here you would delete the research from Firestore
            alert('Delete functionality will be added soon');
        };

        // Create new app function
        async function createNewApp(name, description, budget) {
            if (!currentUser) return;
            
            try {
                const appData = {
                    name: name,
                    description: description,
                    status: 'Planning',
                    budget: budget,
                    spent: 0,
                    userId: currentUser.uid,
                    createdAt: serverTimestamp(),
                    linkedSpecs: [],
                    linkedResearch: [],
                    linkedTools: []
                };
                
                await addDoc(collection(db, 'apps'), appData);
                loadUserApps(); // Reload the apps list
                showSuccess('App created successfully!');
            } catch (error) {
                console.error('Error creating app:', error);
                showError('Failed to create app');
            }
        }

        // Global function for removing saved tool
        window.removeSavedTool = async function(toolId) {
            if (!confirm('Are you sure you want to remove this tool from your saved list?')) {
                return;
            }
            
            try {
                await deleteDoc(doc(db, 'userTools', currentUser.uid, 'savedTools', toolId));
                loadUserSavedTools(); // Reload the list
                showSuccess('Tool removed from saved list');
            } catch (error) {
                console.error('Error removing tool:', error);
                showError('Failed to remove tool from saved list');
            }
        };

        // Utility functions
        function showSuccess(message) {
            // Create a temporary success notification
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: #28a745;
                color: white;
                padding: 12px 20px;
                border-radius: 6px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                z-index: 10000;
                font-size: 14px;
                font-weight: 500;
                animation: slideUp 0.3s ease-out;
            `;
            notification.textContent = message;
            
            // Add animation styles
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideUp {
                    from { transform: translateX(-50%) translateY(100%); opacity: 0; }
                    to { transform: translateX(-50%) translateY(0); opacity: 1; }
                }
            `;
            document.head.appendChild(style);
            
            document.body.appendChild(notification);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.remove();
                style.remove();
            }, 3000);
        }

        function showError(message) {
            // Create a temporary error notification
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: #dc3545;
                color: white;
                padding: 12px 20px;
                border-radius: 6px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                z-index: 10000;
                font-size: 14px;
                font-weight: 500;
                animation: slideUp 0.3s ease-out;
            `;
            notification.textContent = message;
            
            // Add animation styles
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideUp {
                    from { transform: translateX(-50%) translateY(100%); opacity: 0; }
                    to { transform: translateX(-50%) translateY(0); opacity: 1; }
                }
            `;
            document.head.appendChild(style);
            
            document.body.appendChild(notification);
            
            // Remove after 5 seconds
            setTimeout(() => {
                notification.remove();
                style.remove();
            }, 5000);
        }

        // Auth UI functions
        function updateAuthUI(user) {
            const authButtons = document.getElementById('auth-buttons');
            if (!authButtons) return;
            
            if (user) {
                // User is logged in
                const displayName = user.displayName || user.email.split('@')[0];
                const firstLetter = displayName.charAt(0).toUpperCase();
                
                authButtons.innerHTML = `
                    <a href="/pages/profile.html" class="user-info" style="text-decoration: none;">
                        <div class="user-avatar">${firstLetter}</div>
                        <span>${displayName}</span>
                    </a>
                `;
                
                // Check if user is admin and show/hide admin dashboard button
                checkAdminAccess(user);
            } else {
                // User is not logged in
                authButtons.innerHTML = `
                    <button class="auth-btn" onclick="showLoginModal()">Login</button>
                `;
            }
            
            // Update mobile auth UI if function exists
            if (window.updateMobileAuthUI) {
                window.updateMobileAuthUI(user);
            }
        }
        
        // Check admin access based on email
        function checkAdminAccess(user) {
            // Define admin emails - add your specific admin email here
            const adminEmails = [
                'specifysai@gmail.com',
                'admin@specifys.ai',
                'shalom@specifys.ai'
                // Add more admin emails as needed
            ];
            
            const isAdmin = adminEmails.includes(user.email.toLowerCase());
            
            // Show/hide admin dashboard button in profile
            const adminDashboardBtn = document.getElementById('admin-dashboard-btn');
            if (adminDashboardBtn) {
                if (isAdmin) {
                    adminDashboardBtn.style.display = 'block';
                } else {
                    adminDashboardBtn.style.display = 'none';
                }
            }
            
            // Also check for admin-section if exists (for backward compatibility)
            const adminSection = document.querySelector('.admin-section');
            if (adminSection) {
                if (isAdmin) {
                    adminSection.style.display = 'block';
                } else {
                    adminSection.style.display = 'none';
                }
            }
        }

        // Global auth functions
        window.showLoginModal = function() {
            const email = prompt('Email:');
            if (!email) return;
            
            const password = prompt('Password:');
            if (!password) return;
            
            signInWithEmailAndPassword(auth, email, password)
                .then(async (userCredential) => {
                    await createUserDocumentInProfile(userCredential.user);
                    alert('Logged in successfully!');
                })
                .catch(error => {
                    alert('Login error: ' + error.message);
                });
        };

        window.showRegisterModal = function() {
            const email = prompt('Email:');
            if (!email) return;
            
            const password = prompt('Password (at least 6 characters):');
            if (!password) return;
            
            if (password.length < 6) {
                alert('Password must be at least 6 characters');
                return;
            }
            
            createUserWithEmailAndPassword(auth, email, password)
                .then(async (userCredential) => {
                    await createUserDocumentInProfile(userCredential.user);
                    alert('Registered successfully!');
                })
                .catch(error => {
                    alert('Registration error: ' + error.message);
                });
        };

        // Logout function
        window.logout = function() {
            signOut(auth)
                .then(() => {
                    console.log('Logged out successfully');
                    // Redirect to home page after successful logout
                    window.location.href = '../index.html';
                })
                .catch(error => {
                    console.error('Logout error:', error);
                    alert('Logout error: ' + error.message);
                });
        };


        // Global function for linking spec to app
        window.linkSpecToApp = function(specId) {
            console.log('🔗 Linking spec to app:', specId);
            console.log('📱 User apps available:', userApps?.length || 0);
            
            if (!userApps || userApps.length === 0) {
                alert('No apps available to link to. Please create an app first.');
                return;
            }
            
            showLinkModal('specs', specId, 'Specifications');
        };

        // Global function for linking research to app
        window.linkResearchToApp = function(researchId) {
            console.log('🔗 Linking research to app:', researchId);
            console.log('📱 User apps available:', userApps?.length || 0);
            
            if (!userApps || userApps.length === 0) {
                alert('No apps available to link to. Please create an app first.');
                return;
            }
            
            showLinkModal('marketResearch', researchId, 'Market Research');
        };

        // Show modal for linking items to apps
        async function showLinkModal(collection, itemId, itemType) {
            if (!userApps || userApps.length === 0) {
                alert('You need to create an app first before linking specifications or research.');
                return;
            }

            // Get current item data to show current title
            let currentItem = null;
            try {
                if (collection === 'specs') {
                    currentItem = userSpecs.find(spec => spec.id === itemId);
                } else if (collection === 'marketResearch') {
                    currentItem = userMarketResearch.find(research => research.id === itemId);
                }
            } catch (error) {
                console.error('Error finding current item:', error);
            }

            const currentTitle = currentItem ? currentItem.title : '';

            // Create modal HTML with title editing
            const modalHTML = `
                <div id="linkModal" class="modal-overlay">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3>Link ${itemType} to App</h3>
                            <button class="modal-close" onclick="closeLinkModal()">&times;</button>
                        </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <label>Select App:</label>
                                <select id="appSelect" class="form-control">
                                    ${userApps.map(app => `<option value="${app.id}">${app.name}</option>`).join('')}
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Edit Title (optional):</label>
                                <input type="text" id="itemTitle" class="form-control" value="${currentTitle}" placeholder="Enter new title or keep current">
                                <small class="form-text text-muted">This will update the title in both your profile and the app dashboard</small>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-secondary" onclick="closeLinkModal()">Cancel</button>
                            <button class="btn btn-primary" onclick="submitLink('${collection}', '${itemId}')">Link to App</button>
                        </div>
                    </div>
                </div>
            `;
            
            // Add modal to body
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }

        window.closeLinkModal = function() {
            const modal = document.getElementById('linkModal');
            if (modal) {
                modal.remove();
            }
        };

        window.submitLink = async function(collection, itemId) {
            const appSelect = document.getElementById('appSelect');
            const titleInput = document.getElementById('itemTitle');
            const appId = appSelect.value;
            const newTitle = titleInput.value.trim();
            
            if (!appId) {
                alert('Please select an app');
                return;
            }

            try {
                // Update title if changed
                if (newTitle && newTitle !== '') {
                    const itemRef = doc(db, collection, itemId);
                    await setDoc(itemRef, {
                        title: newTitle,
                        updatedAt: new Date().toISOString()
                    }, { merge: true });
                    
                    // Update local data
                    if (collection === 'specs') {
                        const specIndex = userSpecs.findIndex(spec => spec.id === itemId);
                        if (specIndex !== -1) {
                            userSpecs[specIndex].title = newTitle;
                        }
                    } else if (collection === 'marketResearch') {
                        const researchIndex = userMarketResearch.findIndex(research => research.id === itemId);
                        if (researchIndex !== -1) {
                            userMarketResearch[researchIndex].title = newTitle;
                        }
                    }
                }
                
                // Update the app document to include the linked item
                const appRef = doc(db, 'apps', appId);
                const appDoc = await getDoc(appRef);
                
                if (appDoc.exists()) {
                    const appData = appDoc.data();
                    const linkedField = collection === 'specs' ? 'linkedSpecs' : 'linkedResearch';
                    const linkedItems = appData[linkedField] || [];
                    
                    if (!linkedItems.includes(itemId)) {
                        linkedItems.push(itemId);
                        
                        await setDoc(appRef, {
                            ...appData,
                            [linkedField]: linkedItems
                        }, { merge: true });
                        
                        const itemType = collection === 'specs' ? 'Specification' : 'Market Research';
                        const titleMessage = newTitle ? ` with updated title "${newTitle}"` : '';
                        showSuccess(`${itemType}${titleMessage} linked to app successfully!`);
                        
                        // Refresh the UI
                        if (collection === 'specs') {
                            renderSpecs();
                        } else {
                            renderMarketResearch();
                        }
                        
                        // Update local userApps data and button appearance
                        if (userApps) {
                            const appIndex = userApps.findIndex(app => app.id === appId);
                            if (appIndex !== -1) {
                                const linkedField = collection === 'specs' ? 'linkedSpecs' : 'linkedResearch';
                                if (!userApps[appIndex][linkedField]) {
                                    userApps[appIndex][linkedField] = [];
                                }
                                if (!userApps[appIndex][linkedField].includes(itemId)) {
                                    userApps[appIndex][linkedField].push(itemId);
                                }
                            }
                        }
                        setTimeout(updateLinkButtonAppearance, 100);
                        
                        closeLinkModal();
                    } else {
                        alert('This item is already linked to the selected app');
                    }
                }
            } catch (error) {
                console.error('Error linking item to app:', error);
                showError('Failed to link item to app');
            }
        };

        // Profile Tab Management Function
        window.switchProfileTab = function(tabName) {
            console.log('Switching to tab:', tabName);
            
            // Update tab buttons
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

            // Update tab panes
            document.querySelectorAll('.tab-pane').forEach(pane => {
                pane.classList.remove('active');
            });
            document.getElementById(`${tabName}-tab`).classList.add('active');
            
            console.log('Tab switched to:', tabName);
        };

        // Event listeners for link buttons (using event delegation)
        // Wait for DOM to be ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', setupLinkEventListeners);
        } else {
            setupLinkEventListeners();
        }

        function setupLinkEventListeners() {
            if (eventListenersSetup) return;
            
            console.log('🎯 Setting up link event listeners');
            document.addEventListener('click', function(event) {
                // Handle spec link buttons
                const specButton = event.target.closest('.link-spec-btn');
                if (specButton) {
                    const specId = specButton.getAttribute('data-spec-id');
                    if (specId) {
                        console.log('🔗 Linking spec:', specId);
                        window.linkSpecToApp(specId);
                    }
                    return;
                }
                
                // Handle research link buttons
                const researchButton = event.target.closest('.link-research-btn');
                if (researchButton) {
                    const researchId = researchButton.getAttribute('data-research-id');
                    if (researchId) {
                        console.log('🔗 Linking research:', researchId);
                        window.linkResearchToApp(researchId);
                    }
                    return;
                }
            });
            
            eventListenersSetup = true;
        }

        // Function to check if item is linked to any app
        function isItemLinkedToApp(itemId, type) {
            if (!userApps || userApps.length === 0) {
                console.log(`🚫 No apps available for ${type} ${itemId}`);
                return false;
            }
            
            const isLinked = userApps.some(app => {
                const linkedItems = type === 'spec' ? app.linkedSpecs : app.linkedResearch;
                const hasItem = linkedItems && linkedItems.includes(itemId);
                console.log(`🔗 App "${app.name}" has ${type} ${itemId}:`, hasItem, 'linkedItems:', linkedItems);
                return hasItem;
            });
            
            console.log(`🎯 Final result for ${type} ${itemId}:`, isLinked);
            return isLinked;
        }

        // Debounced function to update link button appearance
        function updateLinkButtonAppearance() {
            clearTimeout(updateTimeout);
            updateTimeout = setTimeout(() => {
                console.log('🎨 Updating link button appearance...');
                console.log('📱 Available apps:', userApps?.length || 0);
                
                // Update spec link buttons
                const specButtons = document.querySelectorAll('.link-spec-btn');
                console.log('🔍 Found spec buttons:', specButtons.length);
                
                specButtons.forEach(button => {
                    const specId = button.getAttribute('data-spec-id');
                    const isLinked = isItemLinkedToApp(specId, 'spec');
                    console.log(`📝 Spec ${specId} linked: ${isLinked}`);
                    
                    if (isLinked) {
                        button.classList.add('linked');
                        button.title = 'Already linked to app';
                        console.log(`✅ Added 'linked' class to spec ${specId}`);
                    } else {
                        button.classList.remove('linked');
                        button.title = 'Link to App';
                        console.log(`❌ Removed 'linked' class from spec ${specId}`);
                    }
                });

                // Update research link buttons
                const researchButtons = document.querySelectorAll('.link-research-btn');
                console.log('🔍 Found research buttons:', researchButtons.length);
                
                researchButtons.forEach(button => {
                    const researchId = button.getAttribute('data-research-id');
                    const isLinked = isItemLinkedToApp(researchId, 'research');
                    console.log(`📝 Research ${researchId} linked: ${isLinked}`);
                    
                    if (isLinked) {
                        button.classList.add('linked');
                        button.title = 'Already linked to app';
                        console.log(`✅ Added 'linked' class to research ${researchId}`);
                    } else {
                        button.classList.remove('linked');
                        button.title = 'Link to App';
                        console.log(`❌ Removed 'linked' class from research ${researchId}`);
                    }
                });
            }, 100);
        }
    </script>

    </main>
    
    <!-- Footer -->
    <!-- Footer -->
<footer>
  <div class="footer-content">
    <div class="footer-links">
      <a href="/pages/how.html" aria-label="Learn how specifys.ai works">How It Works</a>
      <a href="/pages/about.html" aria-label="Learn more about specifys.ai">About Us</a>
      <a href="/blog/" aria-label="Visit our blog">Blog</a>
      <a href="/tools/map/vibe-coding-tools-map.html" aria-label="Explore Vibe Coding Tools Map">Vibe Coding Tools Map</a>
      <a href="/pages/ToolPicker.html" aria-label="Use our Tool Finder">Tool Finder</a>
    </div>
    <span class="footer-divider">|</span>
    <div class="footer-social">
      <a href="https://www.linkedin.com/company/specifys-ai/" target="_blank" aria-label="Follow us on LinkedIn"><i class="fab fa-linkedin-in"></i></a>
      <a href="https://www.facebook.com/profile.php?id=61576402600129&locale=he_IL" target="_blank" aria-label="Follow us on Facebook"><i class="fab fa-facebook-f"></i></a>
      <a href="mailto:specifysai@gmail.com" aria-label="Send us an email"><i class="fas fa-envelope"></i></a>
      <a href="https://www.producthunt.com/products/specifys-ai" target="_blank" aria-label="Check us out on Product Hunt"><i class="fab fa-product-hunt"></i></a>
    </div>
  </div>
  <div class="footer-copyright">
    © 2025 specifys.ai. All rights reserved. <span class="footer-version">v1.2.0</span>
  </div>
</footer>

    
    <!-- Scroll to top button -->
    <!-- Scroll to top button -->
<button class="icon-btn scroll-to-top" id="scrollToTop" aria-label="Scroll">
  <i class="fas fa-arrow-up"></i>
</button>

<script>
  // Scroll button functionality
  document.addEventListener('DOMContentLoaded', function() {
    const scrollBtn = document.getElementById('scrollToTop');
    
    if (scrollBtn) {
      // Handle click - scroll to top or bottom based on current state
      scrollBtn.addEventListener("click", () => {
        if (window.scrollY > 300) {
          // If scrolled down, go to top
          window.scrollTo({ top: 0, behavior: "smooth" });
        } else {
          // If at top, scroll to bottom
          window.scrollTo({ top: document.body.scrollHeight, behavior: "smooth" });
        }
      });
      
      // Rotate button based on scroll position
      window.addEventListener("scroll", () => {
        if (window.scrollY > 300) {
          scrollBtn.classList.add("scrolled-down");
          scrollBtn.setAttribute("aria-label", "Scroll to top");
        } else {
          scrollBtn.classList.remove("scrolled-down");
          scrollBtn.setAttribute("aria-label", "Scroll to bottom");
        }
      });
    }
  });
</script>


    
    <!-- Firebase SDK & Auth -->
    
    
    <!-- Extra JavaScript -->
    
    
</body>
</html>
