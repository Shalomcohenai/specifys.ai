<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <meta name="theme-color" content="#000000">
    <title>Legacy Specification Viewer - Specifys.ai</title>
    <meta name="description" content="View legacy specifications">
    <meta name="keywords" content="AI development tools, app specification generator, legacy spec viewer">
    <meta name="author" content="Specifys.ai">
    <meta name="robots" content="noindex, nofollow">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://specifys-ai.com/pages/legacy-viewer.html">
    
    <!-- Open Graph -->
    <meta property="og:site_name" content="Specifys.ai">
    <meta property="og:title" content="Legacy Specification Viewer">
    <meta property="og:description" content="View legacy specifications">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://specifys-ai.com/pages/legacy-viewer.html">
    <meta property="og:image" content="https://specifys-ai.com/assets/images/og-image.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:locale" content="en_US">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@specifysai">
    <meta name="twitter:creator" content="@specifysai">
    <meta name="twitter:title" content="Legacy Specification Viewer">
    <meta name="twitter:description" content="View legacy specifications">
    <meta name="twitter:image" content="https://specifys-ai.com/assets/images/og-image.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">
    
    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/pages/demo.css">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- CSS Monitoring Script -->
    <script src="/assets/js/css-monitor.js"></script>
    
    <!-- Fonts - Optimized: Only Montserrat and Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Library Loader - for conditional loading of external libraries -->
    <script src="/assets/js/lib-loader.js"></script>
    
    <!-- Load required libraries: mermaid and marked -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        window.LibraryLoader.loadLibraries(['mermaid', 'marked']).then(function() {
          console.log('Libraries loaded for legacy viewer');
          // Wait for libraries before initializing
          if (typeof loadDemoContent === 'function') {
            loadDemoContent();
          }
        }).catch(function(error) {
          console.error('Failed to load libraries:', error);
        });
      });
    </script>
    
    <style>
        .legacy-banner {
            background: linear-gradient(135deg, #ff9800, #f57c00);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .legacy-banner h2 {
            margin: 0 0 10px 0;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.3rem;
        }
        .legacy-banner p {
            margin: 0;
            font-size: 0.95rem;
            opacity: 0.95;
        }
        .comparison-section {
            display: none;
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header class="thematic-header" role="banner">
        <div class="header-center">
            <div class="logo">
                <a href="/" aria-label="Specifys.ai homepage">
                    <span class="logo-text">Specifys<span class="logo-dot">.</span>AI</span>
                </a>
            </div>
        </div>
        <div class="header-right">
            <div class="auth-buttons" id="auth-buttons"></div>
        </div>
    </header>

    <!-- Main Content -->
    <main id="main-content" class="main-content">
        <div class="demo-container">
            <div class="demo-header">
                <div class="legacy-banner">
                    <h2>
                        <i class="fas fa-exclamation-triangle"></i>
                        Legacy Specification Format
                    </h2>
                    <p>
                        This is an old specification format. For the full interactive experience with approval workflow and all features, please use the new specification system.
                    </p>
                </div>
                <h1>Legacy Specification</h1>
                <p style="display: none;">Loading legacy specification...</p>
            </div>
            
            <!-- Mode Selector - Hidden -->
            <div class="mode-selector" style="display: none;"></div>
            
            <div class="demo-modes">
                <!-- Specification Mode -->
                <div class="mode-section spec active" id="specificationSection">
                    <div class="mode-header">
                        <div class="mode-icon spec">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                        <div>
                            <h2 class="mode-title">Specification</h2>
                            <p class="mode-description">Legacy specification document</p>
                        </div>
                    </div>
                    <div class="mode-content" id="specificationContent">
                        <div class="loading-content">
                            <i class="fas fa-spinner fa-spin loading-spinner"></i>
                            Loading specification...
                        </div>
                    </div>
                </div>
                
                <!-- Market Research Mode - Hidden -->
                <div class="mode-section research" id="researchSection" style="display: none;">
                    <div class="mode-header">
                        <div class="mode-icon research">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div>
                            <h2 class="mode-title">Market Research</h2>
                            <p class="mode-description">Legacy market research document</p>
                        </div>
                    </div>
                    <div class="mode-content" id="researchContent">
                        <div class="loading-content">
                            <i class="fas fa-spinner fa-spin loading-spinner"></i>
                            Loading market research...
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Comparison Section - Hidden -->
            <div class="comparison-section" style="display: none;"></div>
        </div>
    </main>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyB9hr0IWM4EREzkKDxBxYoYinV6LJXWXV4",
            authDomain: "specify-ai.firebaseapp.com",
            projectId: "specify-ai",
            storageBucket: "specify-ai.firebasestorage.app",
            messagingSenderId: "734278787482",
            appId: "1:734278787482:web:0e312fb6f197e849695a23"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        
        let mermaidInitialized = false;
        
        function waitForLibraries() {
            return new Promise((resolve) => {
                const checkLibraries = () => {
                    if (typeof mermaid !== 'undefined' && typeof marked !== 'undefined') {
                        if (!mermaidInitialized) {
                            mermaid.initialize({ 
                                startOnLoad: false,
                                theme: 'default'
                            });
                            mermaidInitialized = true;
                        }
                        resolve();
                    } else {
                        setTimeout(checkLibraries, 100);
                    }
                };
                checkLibraries();
            });
        }
        
        async function loadDemoContent() {
            try {
                await waitForLibraries();
                
                const urlParams = new URLSearchParams(window.location.search);
                const specId = urlParams.get('id');
                
                if (!specId) {
                    showError('specificationContent', 'No specification ID provided');
                    return;
                }
                
                const user = firebase.auth().currentUser;
                if (!user) {
                    showError('specificationContent', 'Authentication required to view specifications');
                    return;
                }
                
                const doc = await firebase.firestore().collection('specs').doc(specId).get();
                
                if (!doc.exists) {
                    showError('specificationContent', 'Specification not found');
                    return;
                }
                
                const specData = doc.data();
                
                if (specData.userId !== user.uid) {
                    showError('specificationContent', 'You do not have permission to view this specification');
                    return;
                }
                
                let content = '';
                
                if (specData.content) {
                    content = specData.content;
                } else if (specData.overview) {
                    content = JSON.stringify(specData.overview, null, 2);
                } else {
                    content = JSON.stringify(specData, null, 2);
                }
                
                displayContent('specificationContent', content);
                document.title = `${specData.title || 'Legacy Specification'} - Specifys.ai`;
                
            } catch (error) {

                showError('specificationContent', 'Failed to load specification: ' + error.message);
            }
        }
        
        function displayContent(containerId, content) {
            const container = document.getElementById(containerId);
            
            if (!content) {
                showError(containerId, 'No content available');
                return;
            }
            
            const htmlContent = marked.parse(content);
            const contentDiv = document.createElement('div');
            contentDiv.className = 'demo-content';
            contentDiv.innerHTML = htmlContent;
            
            container.innerHTML = '';
            container.appendChild(contentDiv);
            
            const mermaidElements = contentDiv.querySelectorAll('.mermaid, pre code');
            mermaidElements.forEach((element) => {
                const text = element.textContent.trim();
                if (text.startsWith('flowchart') || text.startsWith('graph') || text.startsWith('sequenceDiagram') || 
                    text.startsWith('classDiagram') || text.startsWith('stateDiagram') || text.startsWith('erDiagram') ||
                    text.startsWith('journey') || text.startsWith('gantt') || text.startsWith('pie') || text.startsWith('gitgraph')) {
                    
                    const mermaidDiv = document.createElement('div');
                    mermaidDiv.className = 'mermaid';
                    mermaidDiv.textContent = text;
                    
                    if (element.tagName === 'CODE' && element.parentNode.tagName === 'PRE') {
                        element.parentNode.replaceWith(mermaidDiv);
                    } else {
                        element.replaceWith(mermaidDiv);
                    }
                }
            });
            
            if (typeof mermaid !== 'undefined' && mermaidInitialized) {
                mermaid.init(undefined, contentDiv.querySelectorAll('.mermaid'));
            }
        }
        
        function showError(containerId, message) {
            const container = document.getElementById(containerId);
            container.innerHTML = `
                <div class="loading-content">
                    <i class="fas fa-exclamation-triangle"></i>
                    ${message}
                </div>
            `;
        }
        
        function updateAuthUI(user) {
            const authButtons = document.getElementById('auth-buttons');
            if (!authButtons) return;
            
            if (user) {
                const displayName = user.displayName || user.email.split('@')[0];
                const firstLetter = displayName.charAt(0).toUpperCase();
                
                authButtons.innerHTML = `
                    <a href="/pages/profile.html" class="user-info" style="text-decoration: none;">
                        <div class="user-avatar">${firstLetter}</div>
                        <span>${displayName}</span>
                    </a>
                `;
            } else {
                authButtons.innerHTML = `
                    <button class="auth-btn" onclick="window.location.href='/pages/auth.html'">Log in/Sign up</button>
                `;
            }
        }
        
        auth.onAuthStateChanged((user) => {
            updateAuthUI(user);
            if (user) {
                loadDemoContent();
            }
        });
    </script>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-links">
                <a href="/pages/how.html">How It Works</a>
                <a href="/pages/about.html">About Us</a>
                <a href="/blog/">Blog</a>
                <a href="/tools/map/vibe-coding-tools-map.html">Vibe Coding Tools Map</a>
                <a href="/pages/ToolPicker.html">Tool Finder</a>
            </div>
            <span class="footer-divider">|</span>
            <div class="footer-social">
                <a href="https://www.linkedin.com/company/specifys-ai/" target="_blank" aria-label="Follow us on LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                <a href="https://www.facebook.com/profile.php?id=61576402600129&locale=he_IL" target="_blank" aria-label="Follow us on Facebook"><i class="fab fa-facebook-f"></i></a>
                <a href="mailto:specifysai@gmail.com" aria-label="Send us an email"><i class="fas fa-envelope"></i></a>
                <a href="https://www.producthunt.com/products/specifys-ai" target="_blank" aria-label="Check us out on Product Hunt"><i class="fab fa-product-hunt"></i></a>
            </div>
        </div>
        <div class="footer-copyright">
            Â© 2025 specifys.ai. All rights reserved.
        </div>
    </footer>

    <button class="icon-btn scroll-to-top" id="scrollToTop" aria-label="Scroll">
        <i class="fas fa-arrow-up"></i>
    </button>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const scrollBtn = document.getElementById('scrollToTop');
            if (scrollBtn) {
                scrollBtn.addEventListener("click", () => {
                    if (window.scrollY > 300) {
                        window.scrollTo({ top: 0, behavior: "smooth" });
                    } else {
                        window.scrollTo({ top: document.body.scrollHeight, behavior: "smooth" });
                    }
                });
                
                window.addEventListener("scroll", () => {
                    if (window.scrollY > 300) {
                        scrollBtn.classList.add("scrolled-down");
                        scrollBtn.setAttribute("aria-label", "Scroll to top");
                    } else {
                        scrollBtn.classList.remove("scrolled-down");
                        scrollBtn.setAttribute("aria-label", "Scroll to bottom");
                    }
                });
            }
        });
    </script>
</body>
</html>
