<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <meta name="theme-color" content="#000000">
    <title>Pricing - Specifys.ai</title>
    <meta name="description" content="Build Smart with Specifys.ai - Free tier available, Pro plans with unlimited specifications and advanced features.">
    <meta name="keywords" content="AI development tools, app specification generator, no-code platform, AI-powered planning, vibe coding, AI app builder, specification generator, market research tool, app planning tool, development tools, AI tools">
    <meta name="author" content="Specifys.ai">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://specifys-ai.com/pages/pricing.html">
    
    <!-- Open Graph -->
    <meta property="og:site_name" content="Specifys.ai">
    <meta property="og:title" content="Pricing - Specifys.ai">
    <meta property="og:description" content="Build Smart with Specifys.ai - Free tier available, Pro plans with unlimited specifications and advanced features.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://specifys-ai.com/pages/pricing.html">
    <meta property="og:image" content="https://specifys-ai.com/assets/images/og-image.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:locale" content="en_US">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@specifysai">
    <meta name="twitter:creator" content="@specifysai">
    <meta name="twitter:title" content="Pricing - Specifys.ai">
    <meta name="twitter:description" content="Build Smart with Specifys.ai - Free tier available, Pro plans with unlimited specifications and advanced features.">
    <meta name="twitter:image" content="https://specifys-ai.com/assets/images/og-image.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/main.css">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- CSS Monitoring Script -->
    <script src="/assets/js/css-monitor.js"></script>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Montserrat:wght@300;400;500;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet"></noscript>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RWBT69JCM7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-RWBT69JCM7');
    </script>
    
    <!-- API Configuration - MUST load before other scripts -->
    <script src="/assets/js/config.js"></script>
    
    <!-- Structured Data (JSON-LD) for SEO -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "Organization",
          "name": "Specifys.ai",
          "url": "https://specifys-ai.com",
          "logo": "https://specifys-ai.com/favicon.ico",
          "description": "AI-powered app planning and specification generation platform",
          "sameAs": [
            "https://www.linkedin.com/company/specifys-ai/"
          ],
          "contactPoint": {
            "@type": "ContactPoint",
            "email": "specifysai@gmail.com",
            "contactType": "Customer Service"
          }
        },
        {
          "@type": "WebSite",
          "name": "Specifys.ai",
          "url": "https://specifys-ai.com",
          "description": "Plan your app smarter with AI-driven insights and tools",
          "potentialAction": {
            "@type": "SearchAction",
            "target": "https://specifys-ai.com/pages/ToolPicker.html?q={search_term_string}",
            "query-input": "required name=search_term_string"
          }
        },
        {
          "@type": "SoftwareApplication",
          "name": "Specifys.ai",
          "applicationCategory": "DevelopmentApplication",
          "operatingSystem": "Web",
          "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
          },
          "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.8",
            "ratingCount": "250"
          },
          "description": "AI-powered app planning platform with specification generator, market research tools, and vibe coding tools map"
        }
      ]
    }
    </script>
</head>
<body>
<!-- Header -->
<header class="thematic-header" role="banner">
    <div class="header-center">
        <div class="logo">
            <a href="/" aria-label="Specifys.ai homepage">
                <span class="logo-text">Specifys<span class="logo-dot">.</span>AI</span>
            </a>
        </div>
    </div>
    <div class="header-right">
        <div class="credits-display" id="credits-display" style="display: none;">
            <div class="credits-container">
                <span id="credits-text">0</span>
            </div>
        </div>
        <div class="auth-buttons" id="auth-buttons">
            <!-- Will be populated by auth system -->
        </div>
    </div>
</header>

<!-- Main Content -->
<main id="main-content" class="main-content">

<div class="pricing-page">
    <!-- Hero Section -->
    <div class="pricing-hero">
        <div class="container">
            <h1>Build Smart with Specifys.ai</h1>
            <p>Choose the perfect plan for your app development needs</p>
            <p class="hero-subtitle">Single specs, packs, or unlimited Pro subscriptions - choose what works for you</p>
        </div>
    </div>

    <!-- Pricing Cards -->
    <div class="pricing-container">
        <div class="container">
            <div class="pricing-grid">
                
                <!-- Single Spec -->
                <div class="pricing-card single">
                    <div class="plan-header">
                        <h3>Single Spec</h3>
                        <p class="plan-description">One additional specification</p>
                    </div>
                    <div class="plan-features">
                        <ul>
                            <li><i class="fas fa-check-circle"></i> <span>1 Specification</span></li>
                            <li><i class="fas fa-check-circle"></i> <span>Full Spec Details</span></li>
                            <li><i class="fas fa-check-circle"></i> <span>Tools Map Access</span></li>
                            <li><i class="fas fa-times-circle" style="color: #dee2e6;"></i> <span style="opacity: 0.6;">Edit Specifications</span></li>
                        </ul>
                    </div>
                    <div class="plan-cta">
                        <div class="price">
                            <span class="currency">$</span>
                            <span class="amount">4.90</span>
                            <span class="period">one-time</span>
                        </div>
                        <button class="btn btn-primary" data-product-key="single_spec" onclick="purchaseSpec(event, 'single_spec')">
                            Buy Now
                        </button>
                    </div>
                </div>

                <!-- 3-Pack -->
                <div class="pricing-card pack">
                    <div class="plan-badge">Best Value</div>
                    <div class="plan-header">
                        <h3>3-Pack</h3>
                        <p class="plan-description">Three specifications at a discount</p>
                    </div>
                    <div class="plan-features">
                        <ul>
                            <li><i class="fas fa-check-circle"></i> <span>3 Specifications</span></li>
                            <li><i class="fas fa-check-circle"></i> <span>Full Spec Details</span></li>
                            <li><i class="fas fa-check-circle"></i> <span>Tools Map Access</span></li>
                            <li><i class="fas fa-times-circle" style="color: #dee2e6;"></i> <span style="opacity: 0.6;">Edit Specifications</span></li>
                        </ul>
                    </div>
                    <div class="plan-cta">
                        <div class="price">
                            <span class="currency">$</span>
                            <span class="amount">9.90</span>
                            <span class="period">one-time</span>
                        </div>
                        <button class="btn btn-primary highlight" data-product-key="three_pack" onclick="purchaseSpec(event, 'three_pack')">
                            Buy Now
                        </button>
                    </div>
                </div>

                <!-- Pro Subscription -->
                <div class="pricing-card pro">
                    <div class="plan-badge">Pro</div>
                    <div class="plan-header">
                        <h3>Pro</h3>
                        <p class="plan-description">Unlimited specifications with editing</p>
                    </div>
                    
                    <!-- Billing Toggle -->
                    <div class="billing-toggle">
                        <button class="toggle-btn monthly active" onclick="switchBilling('monthly')">Monthly</button>
                        <button class="toggle-btn yearly" onclick="switchBilling('yearly')">Yearly</button>
                    </div>
                    
                    <!-- Monthly Plan -->
                    <div id="pro-monthly" class="plan-details active">
                        <div class="plan-features">
                            <ul>
                                <li><i class="fas fa-check-circle"></i> <span>Unlimited Specifications</span></li>
                                <li><i class="fas fa-check-circle"></i> <span>Edit & Customize Specs</span></li>
                                <li><i class="fas fa-check-circle"></i> <span>All Tools & Features</span></li>
                                <li><i class="fas fa-check-circle"></i> <span>Priority Support</span></li>
                            </ul>
                        </div>
                        <div class="plan-cta">
                            <div class="price">
                                <span class="currency">$</span>
                                <span class="amount">29.90</span>
                                <span class="period">per month</span>
                            </div>
                            <button class="btn btn-primary" data-product-key="pro_monthly" onclick="purchaseSpec(event, 'pro_monthly')">
                                Subscribe Now
                            </button>
                        </div>
                    </div>
                    
                    <!-- Yearly Plan -->
                    <div id="pro-yearly" class="plan-details">
                        <div class="plan-features">
                            <ul>
                                <li><i class="fas fa-check-circle"></i> <span>Unlimited Specifications</span></li>
                                <li><i class="fas fa-check-circle"></i> <span>Edit & Customize Specs</span></li>
                                <li><i class="fas fa-check-circle"></i> <span>All Tools & Features</span></li>
                                <li><i class="fas fa-check-circle"></i> <span>Priority Support</span></li>
                                <li><i class="fas fa-check-circle"></i> <span>17% Savings</span></li>
                            </ul>
                        </div>
                        <div class="plan-cta">
                            <div class="price">
                                <span class="currency">$</span>
                                <span class="amount">299.90</span>
                                <span class="period">per year</span>
                            </div>
                            <div class="savings-badge">Save $58.30/year</div>
                            <button class="btn btn-primary" data-product-key="pro_yearly" onclick="purchaseSpec(event, 'pro_yearly')">
                                Subscribe Now
                            </button>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- FAQ Section -->
    <div class="pricing-faq">
        <div class="container">
            <h2>Frequently Asked Questions</h2>
            <div class="faq-grid">
                <div class="faq-item">
                    <h4>What's included in the free plan?</h4>
                    <p>You get 1 free specification to try our AI-powered app planning. You also have access to our Tools Map and Tool Finder.</p>
                </div>
                <div class="faq-item">
                    <h4>Can I edit my specifications?</h4>
                    <p>Only Pro subscribers can edit specifications. Free users and credit purchasers can view and save their specifications.</p>
                </div>
                <div class="faq-item">
                    <h4>How does the Pro subscription work?</h4>
                    <p>Pro subscriptions give you unlimited specifications and the ability to edit them. You can choose between monthly or yearly billing.</p>
                </div>
                <div class="faq-item">
                    <h4>Can I cancel my Pro subscription?</h4>
                    <p>Yes, you can cancel anytime. You'll keep Pro features until the end of your billing period.</p>
                </div>
                <div class="faq-item">
                    <h4>What payment methods do you accept?</h4>
                    <p>We accept all major credit cards, PayPal, and other payment methods through Lemon Squeezy.</p>
                </div>
                <div class="faq-item">
                    <h4>Is there a money-back guarantee?</h4>
                    <p>Yes, we offer a 30-day money-back guarantee for all Pro subscriptions.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- CTA Section -->
    <div class="pricing-cta">
        <div class="container">
            <h2>Ready to Build Your App?</h2>
            <p>Start with our free plan or jump straight to Pro for unlimited specifications</p>
            <div class="cta-buttons">
                <a href="/" class="btn btn-primary">Try Free</a>
                <a href="#pricing" class="btn btn-outline">View Plans</a>
            </div>
        </div>
    </div>
</div>

<style>
/* Pricing Page Styles - Specifys.ai Design System */
.pricing-page {
    min-height: 100vh;
    background: #ffffff;
}

.pricing-hero {
    background: #ffffff;
    padding: 100px 0 40px;
    text-align: center;
    border-bottom: 1px solid #e9ecef;
    margin-top: 60px;
}

.pricing-hero .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
}

.pricing-hero h1 {
    font-size: 2.5rem;
    margin-bottom: 16px;
    font-weight: 700;
    color: #333;
}

.pricing-hero p {
    font-size: 1.1rem;
    color: #666;
    max-width: 600px;
    margin: 0 auto;
}

.pricing-hero p.hero-subtitle {
    margin-top: 12px;
    font-size: 0.95rem;
    color: #999;
    font-weight: 400;
}

.pricing-container {
    padding: 60px 0;
    background: #ffffff;
}

.pricing-alert {
    display: none;
    max-width: 600px;
    margin: 20px auto 0;
    padding: 12px 16px;
    border-radius: 8px;
    font-weight: 500;
    text-align: center;
}

.pricing-alert[data-type="success"] {
    background: #d1fae5;
    color: #065f46;
}

.pricing-alert[data-type="error"] {
    background: #fee2e2;
    color: #b91c1c;
}

.pricing-alert[data-type="info"] {
    background: #e0f2fe;
    color: #0369a1;
}

.pricing-container .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
}

.pricing-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 32px;
    max-width: 1200px;
    margin: 0 auto;
}

.pricing-card {
    background: white;
    border: 2px solid #FFE8DC;
    border-radius: 16px;
    padding: 40px;
    transition: all 0.3s ease;
    position: relative;
    display: flex;
    flex-direction: column;
    box-shadow: 0 2px 12px rgba(255, 107, 53, 0.05);
}

.pricing-card:hover {
    transform: translateY(-6px);
    box-shadow: 0 12px 32px rgba(255, 107, 53, 0.15);
    border-color: #FF6B35;
}

.pricing-card.pack,
.pricing-card.pro {
    border-color: #FF6B35;
    box-shadow: 0 4px 16px rgba(255, 107, 53, 0.2);
}

.pricing-card.pro:hover {
    transform: translateY(-6px);
    box-shadow: 0 8px 24px rgba(255, 107, 53, 0.25);
    border-color: #FF6B35;
}

.plan-badge {
    position: absolute;
    top: 16px;
    right: 16px;
    background: #FF6B35;
    color: white;
    padding: 4px 12px;
    border-radius: 4px;
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
}

.plan-badge.best-value {
    background: #FF6B35;
}

/* Billing Toggle */
.billing-toggle {
    display: flex;
    gap: 8px;
    margin-bottom: 24px;
    background: #f5f5f5;
    padding: 4px;
    border-radius: 8px;
}

.toggle-btn {
    flex: 1;
    padding: 8px 16px;
    border: none;
    background: transparent;
    color: #666;
    font-size: 0.85rem;
    font-weight: 600;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.toggle-btn.active {
    background: #FF6B35;
    color: white;
}

.toggle-btn:hover {
    color: #FF6B35;
}

.toggle-btn.active:hover {
    color: white;
    background: #FF8551;
}

/* Plan Details - Show/Hide */
.plan-details {
    display: none;
}

.plan-details.active {
    display: block;
}

.plan-header {
    margin-bottom: 24px;
}

.plan-features {
    margin-bottom: 32px;
    flex-grow: 1;
}

.plan-header h3 {
    font-size: 1.75rem;
    margin-bottom: 8px;
    color: #FF6B35;
    font-weight: 700;
}

.plan-description {
    font-size: 0.95rem;
    color: #666;
    margin-bottom: 24px;
}

.price {
    display: flex;
    align-items: baseline;
    margin-bottom: 16px;
}

.currency {
    font-size: 1rem;
    color: #666;
}

.amount {
    font-size: 3rem;
    font-weight: 700;
    color: #FF6B35;
    margin: 0 4px;
}

.period {
    font-size: 0.9rem;
    color: #666;
}

.savings-badge {
    background: #FF6B35;
    color: white;
    padding: 4px 10px;
    border-radius: 4px;
    font-size: 11px;
    font-weight: 600;
    display: inline-block;
    margin: 8px 0;
    text-align: center;
    width: 100%;
}


.plan-features {
    margin-bottom: 32px;
    flex-grow: 1;
}

.features-label {
    font-size: 0.75rem;
    font-weight: 600;
    color: #666;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 16px;
    display: none; /* Hide the label for cleaner look */
}

.plan-features ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.plan-features li {
    display: flex;
    align-items: center;
    padding: 10px 0;
    font-size: 0.95rem;
    color: #333;
}

.plan-features li i {
    font-size: 18px;
    margin-right: 12px;
    width: 24px;
}

.plan-features li i.fa-check-circle {
    color: #FF6B35;
}

.plan-features li i.fa-times-circle,
.plan-features li i.fas.fa-times-circle {
    color: #dee2e6;
}

.plan-cta {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin-top: auto;
}

.plan-cta .price {
    margin-bottom: 8px;
}

.btn {
    display: inline-block;
    padding: 12px 24px;
    border-radius: 6px;
    text-decoration: none;
    font-weight: 600;
    font-size: 0.9rem;
    transition: all 0.2s ease;
    border: 1px solid;
    cursor: pointer;
    text-align: center;
}

.btn-primary {
    background: #FF6B35;
    color: white;
    border-color: #FF6B35;
}

.btn-primary:hover {
    background: #FF8551;
    border-color: #FF8551;
}

.btn-primary.highlight {
    background: #FF6B35;
    border-color: #FF6B35;
    color: white;
}

.btn-primary.highlight:hover {
    background: #FF8551;
    border-color: #FF8551;
    color: white;
}

.pricing-card.pack .btn-primary.highlight {
    background: linear-gradient(135deg, #FF6B35 0%, #FF8551 100%);
    border-color: transparent;
    color: white;
}

.pricing-card.pack .btn-primary.highlight:hover {
    background: linear-gradient(135deg, #FF8551 0%, #FF6B35 100%);
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(255, 107, 53, 0.3);
}

.btn-secondary {
    background: transparent;
    color: #333;
    border-color: #e9ecef;
}

.btn-secondary:hover {
    background: #f5f5f5;
}

.pricing-faq {
    background: #f5f5f5;
    padding: 60px 0;
}

.pricing-faq .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
}

.pricing-faq h2 {
    text-align: center;
    font-size: 2rem;
    margin-bottom: 40px;
    color: #333;
    font-weight: 700;
}

.faq-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 24px;
    max-width: 1000px;
    margin: 0 auto;
}

.faq-item {
    background: white;
    padding: 24px;
    border-radius: 8px;
    border: 1px solid #e9ecef;
}

.faq-item h4 {
    font-size: 1rem;
    margin-bottom: 12px;
    color: #333;
    font-weight: 600;
}

.faq-item p {
    color: #666;
    line-height: 1.6;
    font-size: 0.9rem;
}

.pricing-cta {
    background: #333;
    color: white;
    padding: 60px 0;
    text-align: center;
}

.pricing-cta .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
}

.pricing-cta h2 {
    font-size: 2rem;
    margin-bottom: 16px;
    color: white;
    font-weight: 700;
}

.pricing-cta p {
    font-size: 1.1rem;
    color: rgba(255, 255, 255, 0.8);
    margin-bottom: 32px;
}

.cta-buttons {
    display: flex;
    gap: 16px;
    justify-content: center;
    flex-wrap: wrap;
}

.cta-buttons .btn {
    padding: 12px 32px;
    font-size: 1rem;
}

.cta-buttons .btn-primary {
    background: #FF6B35;
    border-color: #FF6B35;
}

.cta-buttons .btn-primary:hover {
    background: #FF8551;
}

.cta-buttons .btn-outline {
    background: transparent;
    color: white;
    border-color: white;
}

.cta-buttons .btn-outline:hover {
    background: rgba(255, 255, 255, 0.1);
}

/* Responsive - 2 columns on medium screens */
@media (max-width: 1200px) and (min-width: 769px) {
    .pricing-grid {
        grid-template-columns: repeat(2, 1fr);
        max-width: 800px;
    }
}

/* Mobile Responsive */
@media (max-width: 768px) {
    .pricing-grid {
        grid-template-columns: 1fr;
        gap: 24px;
        max-width: 100%;
    }
    
    .pricing-card {
        padding: 32px 24px;
    }
}

@media (max-width: 768px) {
    .pricing-hero h1 {
        font-size: 2rem;
    }
    
    .pricing-hero p {
        font-size: 1rem;
    }
    
    .pricing-card {
        padding: 28px 20px;
    }
    
    .amount {
        font-size: 2.5rem;
    }
    
    .plan-header h3 {
        font-size: 1.5rem;
    }
    
    .faq-grid {
        grid-template-columns: 1fr;
        gap: 16px;
    }
    
    .cta-buttons {
        flex-direction: column;
        align-items: center;
    }
    
    .cta-buttons .btn {
        width: 100%;
        max-width: 300px;
    }
}

@media (max-width: 480px) {
    .pricing-hero {
        padding: 40px 0 30px;
    }
    
    .pricing-hero h1 {
        font-size: 1.75rem;
    }
    
    .pricing-container {
        padding: 40px 0;
    }
    
    .pricing-card {
        padding: 20px;
    }
    
    .amount {
        font-size: 1.75rem;
    }
}
</style>

<script>
const API_BASE_URL = window.location.hostname === 'localhost'
  ? 'https://specifys-ai-store.onrender.com/api'
  : 'https://specifys-ai-store.onrender.com/api';

let lemonConfigPromise = null;
let lemonSdkPromise = null;
const productButtons = Array.from(document.querySelectorAll('button[data-product-key]'));

productButtons.forEach((btn) => {
    if (!btn.dataset.originalLabel) {
        btn.dataset.originalLabel = btn.textContent.trim();
    }
});

function setProductButtonsDisabled(disabled) {
    productButtons.forEach((btn) => {
        btn.disabled = disabled;
        if (disabled) {
            btn.style.opacity = '0.5';
            btn.style.cursor = 'not-allowed';
        } else {
            btn.style.opacity = '';
            btn.style.cursor = '';
        }
    });
}

function updateProductButtonsForUser(user) {
    const shouldDisable = !user;
    setProductButtonsDisabled(shouldDisable);
}

function getPricingAlertContainer() {
    let container = document.getElementById('pricing-alert');
    if (container) {
        return container;
    }
    container = document.createElement('div');
    container.id = 'pricing-alert';
    container.className = 'pricing-alert';
    const hero = document.querySelector('.pricing-hero .container');
    if (hero && hero.parentNode) {
        hero.parentNode.insertBefore(container, hero.nextSibling);
    } else {
        document.body.prepend(container);
    }
    return container;
}

function showPricingAlert(message, type = 'success') {
    const container = getPricingAlertContainer();
    container.textContent = message;
    container.setAttribute('data-type', type);
    container.style.display = 'block';
}

function hidePricingAlert() {
    const container = document.getElementById('pricing-alert');
    if (container) {
        container.style.display = 'none';
        container.textContent = '';
    }
}

function handleCheckoutRedirect() {
    const params = new URLSearchParams(window.location.search);
    const checkoutStatus = params.get('checkout');
    const productKey = params.get('product');

    if (checkoutStatus === 'success') {
        const productLabel = productKey ? productKey.replace(/_/g, ' ') : 'purchase';
        showPricingAlert(`Purchase successful! Your ${productLabel} will be available shortly.`, 'success');
    } else if (checkoutStatus === 'cancel') {
        showPricingAlert('Checkout was cancelled. You can try again whenever you are ready.', 'info');
    }

    if (checkoutStatus) {
        params.delete('checkout');
        params.delete('product');
        const newUrl = `${window.location.pathname}${params.toString() ? `?${params.toString()}` : ''}`;
        window.history.replaceState({}, document.title, newUrl);
    }
}

function getLemonProductsConfig() {
    if (!lemonConfigPromise) {
        lemonConfigPromise = fetch('/assets/data/lemon-products.json')
            .then((response) => {
                if (!response.ok) {
                    throw new Error('Failed to load product configuration');
                }
                return response.json();
            })
            .catch((error) => {
                console.error('Error loading lemon products config:', error);
                throw error;
            });
    }
    return lemonConfigPromise;
}

function loadLemonSqueezySDK() {
    if (lemonSdkPromise) {
        return lemonSdkPromise;
    }

    if (window.LemonSqueezy && (typeof window.createLemonSqueezyCheckout === 'function' || window.LemonSqueezy.Setup)) {
        lemonSdkPromise = Promise.resolve();
        return lemonSdkPromise;
    }

    lemonSdkPromise = new Promise((resolve, reject) => {
        const existingScript = document.querySelector('script[src="https://assets.lemonsqueezy.com/lemon.js"]');
        if (existingScript) {
            existingScript.addEventListener('load', resolve);
            existingScript.addEventListener('error', () => reject(new Error('Failed to load Lemon Squeezy SDK')));
            return;
        }

        const script = document.createElement('script');
        script.src = 'https://assets.lemonsqueezy.com/lemon.js';
        script.async = true;
        script.onload = resolve;
        script.onerror = () => reject(new Error('Failed to load Lemon Squeezy SDK'));
        document.head.appendChild(script);
    }).then(() => {
        return new Promise((resolve, reject) => {
            let attempts = 0;
            const maxAttempts = 50;
            const interval = setInterval(() => {
                attempts += 1;

                if (typeof window.createLemonSqueezy === 'function' && !window.LemonSqueezy) {
                    try {
                        window.LemonSqueezy = window.createLemonSqueezy();
                    } catch (error) {
                        console.warn('Failed to initialize LemonSqueezy object:', error);
                    }
                }

                if (typeof window.createLemonSqueezyCheckout === 'function' || (window.LemonSqueezy && typeof window.LemonSqueezy.Setup === 'function')) {
                    clearInterval(interval);
                    resolve();
                } else if (attempts >= maxAttempts) {
                    clearInterval(interval);
                    if (typeof window.createLemonSqueezyCheckout === 'function' || window.LemonSqueezy) {
                        resolve();
                    } else {
                        reject(new Error('Lemon Squeezy SDK loaded but methods unavailable'));
                    }
                }
            }, 100);
        });
    });

    return lemonSdkPromise;
}

async function openCheckoutOverlay(checkoutUrl, handlers = {}) {
    await loadLemonSqueezySDK().catch((error) => {
        console.error('Error loading Lemon Squeezy SDK:', error);
    });

    const { onSuccess } = handlers;
    let opened = false;

    if (typeof window.createLemonSqueezyCheckout === 'function') {
        try {
            const checkout = window.createLemonSqueezyCheckout({
                url: checkoutUrl,
                onCheckoutSuccess: () => {
                    if (typeof onSuccess === 'function') {
                        onSuccess();
                    }
                }
            });
            if (checkout && typeof checkout.open === 'function') {
                checkout.open();
                opened = true;
            }
        } catch (error) {
            console.error('createLemonSqueezyCheckout error:', error);
        }
    }

    if (!opened && window.LemonSqueezy && typeof window.LemonSqueezy.Setup === 'function') {
        try {
            window.LemonSqueezy.Setup({
                eventHandler: (eventName) => {
                    if (eventName === 'Checkout.Success' && typeof onSuccess === 'function') {
                        onSuccess();
                    }
                }
            });
            if (window.LemonSqueezy.Url && typeof window.LemonSqueezy.Url.Open === 'function') {
                window.LemonSqueezy.Url.Open(checkoutUrl);
                opened = true;
            }
        } catch (error) {
            console.error('LemonSqueezy.Setup error:', error);
        }
    }

    if (!opened) {
        const popup = window.open(
            checkoutUrl,
            'lemon-checkout',
            'width=600,height=700,scrollbars=yes,resizable=yes,centerscreen=yes'
        );

        if (popup) {
            opened = true;
            const interval = setInterval(() => {
                if (popup.closed) {
                    clearInterval(interval);
                    if (typeof onSuccess === 'function') {
                        onSuccess();
                    }
                }
            }, 1000);
            setTimeout(() => clearInterval(interval), 5 * 60 * 1000);
        } else {
            window.open(checkoutUrl, '_blank');
            opened = true;
        }
    }

    return opened;
}

async function purchaseSpec(evt, productKey) {
    const triggerButton = evt?.currentTarget || document.querySelector(`button[data-product-key="${productKey}"]`);

    if (triggerButton && triggerButton.disabled) {
        return;
    }

    try {
        hidePricingAlert();

        const user = firebase.auth().currentUser;
        if (!user) {
            showPricingAlert('Please log in to purchase.', 'info');
            window.location.href = '/pages/auth.html';
            return;
        }

        trackCTA(`Purchase ${productKey}`, 'pricing_page');

        const productsConfig = await getLemonProductsConfig();
        const product = productsConfig?.products?.[productKey];

        if (!product) {
            showPricingAlert('Selected product is not available. Please try again later.', 'error');
            return;
        }

        const token = await user.getIdToken();

        if (triggerButton) {
            triggerButton.disabled = true;
            triggerButton.classList.add('loading');
        }

        const response = await fetch(`${API_BASE_URL}/lemon/checkout`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${token}`
            },
            body: JSON.stringify({
                productKey,
                successPath: '/pages/pricing.html',
                successQuery: { product: productKey }
            })
        });

        if (!response.ok) {
            const errorPayload = await response.json().catch(() => ({}));
            throw new Error(errorPayload.error || 'Failed to start checkout');
        }

        const data = await response.json();
        if (!data.checkoutUrl) {
            throw new Error('Checkout URL missing from server response');
        }

        await openCheckoutOverlay(data.checkoutUrl, {
            onSuccess: () => {
                showPricingAlert('Purchase successful! You will be redirected shortly.', 'success');
            }
        });
    } catch (error) {
        console.error('Checkout error:', error);
        showPricingAlert(error.message || 'Error initiating purchase. Please try again.', 'error');
    } finally {
        if (triggerButton) {
            triggerButton.classList.remove('loading');
        }
        const currentUser = (typeof firebase !== 'undefined' && typeof firebase.auth === 'function')
            ? firebase.auth().currentUser
            : null;
        updateProductButtonsForUser(currentUser);
    }
}

// Track CTA function (if not already defined)
function trackCTA(ctaName, location) {
    if (typeof gtag !== 'undefined') {
        gtag('event', 'cta_click', {
            event_category: 'CTA',
            event_label: ctaName,
            cta_location: location
        });
    }
}

// Switch billing period for Pro plan
function switchBilling(period) {
    const monthlyBtn = document.querySelector('.toggle-btn.monthly');
    const yearlyBtn = document.querySelector('.toggle-btn.yearly');
    const monthlyPlan = document.getElementById('pro-monthly');
    const yearlyPlan = document.getElementById('pro-yearly');
    
    if (period === 'monthly') {
        monthlyBtn.classList.add('active');
        yearlyBtn.classList.remove('active');
        monthlyPlan.classList.add('active');
        yearlyPlan.classList.remove('active');
    } else {
        yearlyBtn.classList.add('active');
        monthlyBtn.classList.remove('active');
        yearlyPlan.classList.add('active');
        monthlyPlan.classList.remove('active');
    }
}

document.addEventListener('DOMContentLoaded', () => {
    handleCheckoutRedirect();
    setProductButtonsDisabled(true);

    if (typeof firebase !== 'undefined') {
        firebase.auth().onAuthStateChanged((user) => {
            updateProductButtonsForUser(user);
        });
    }
});
</script>

</main>

<!-- Footer -->
<footer>
    <div class="footer-content">
        <div class="footer-links">
            <a href="/pages/how.html" aria-label="Learn how specifys.ai works">How It Works</a>
            <a href="/pages/about.html" aria-label="Learn more about specifys.ai">About Us</a>
            <a href="/blog/" aria-label="Visit our blog">Blog</a>
            <a href="/tools/map/vibe-coding-tools-map.html" aria-label="Explore Vibe Coding Tools Map">Tools Map</a>
            <a href="/pages/ToolPicker.html" aria-label="Use our Tool Finder">Tool Finder</a>
        </div>
        <span class="footer-divider">|</span>
        <div class="footer-social">
            <a href="https://www.linkedin.com/company/specifys-ai/" target="_blank" aria-label="Follow us on LinkedIn"><i class="fab fa-linkedin-in"></i></a>
            <a href="https://www.facebook.com/profile.php?id=61576402600129&locale=he_IL" target="_blank" aria-label="Follow us on Facebook"><i class="fab fa-facebook-f"></i></a>
            <a href="mailto:specifysai@gmail.com" aria-label="Send us an email"><i class="fas fa-envelope"></i></a>
            <a href="https://www.producthunt.com/products/specifys-ai" target="_blank" aria-label="Check us out on Product Hunt"><i class="fab fa-product-hunt"></i></a>
        </div>
    </div>
    <div class="footer-copyright">
        Â© 2025 specifys.ai. All rights reserved. <span class="footer-version">v1.2.4</span>
    </div>
</footer>

<!-- Scroll to top button -->
<button class="icon-btn scroll-to-top" id="scrollToTop" aria-label="Scroll">
    <i class="fas fa-arrow-up"></i>
</button>

<script>
    // Scroll button functionality
    document.addEventListener('DOMContentLoaded', function() {
        const scrollBtn = document.getElementById('scrollToTop');
        
        if (scrollBtn) {
            // Handle click - scroll to top or bottom based on current state
            scrollBtn.addEventListener("click", () => {
                if (window.scrollY > 300) {
                    // If scrolled down, go to top
                    window.scrollTo({ top: 0, behavior: "smooth" });
                } else {
                    // If at top, scroll to bottom
                    window.scrollTo({ top: document.body.scrollHeight, behavior: "smooth" });
                }
            });
            
            // Rotate button based on scroll position
            window.addEventListener("scroll", () => {
                if (window.scrollY > 300) {
                    scrollBtn.classList.add("scrolled-down");
                    scrollBtn.setAttribute("aria-label", "Scroll to top");
                } else {
                    scrollBtn.classList.remove("scrolled-down");
                    scrollBtn.setAttribute("aria-label", "Scroll to bottom");
                }
            });
        }
    });
</script>

<!-- Firebase SDK & Auth -->
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

<script>
    // Firebase Configuration
    const firebaseConfig = {
        apiKey: "AIzaSyB9hr0IWM4EREzkKDxBxYoYinV6LJXWXV4",
        authDomain: "specify-ai.firebaseapp.com",
        projectId: "specify-ai",
        storageBucket: "specify-ai.firebasestorage.app",
        messagingSenderId: "734278787482",
        appId: "1:734278787482:web:0e312fb6f197e849695a23",
        measurementId: "G-4YR9LK63MR"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // Auth UI functions
    function updateAuthUI(user) {
        const authButtons = document.getElementById('auth-buttons');
        if (!authButtons) return;
        
        if (user) {
            // User is logged in
            const displayName = user.displayName || user.email.split('@')[0];
            const firstLetter = displayName.charAt(0).toUpperCase();
            
            authButtons.innerHTML = `
                <a href="/pages/profile.html" class="user-info" style="text-decoration: none;">
                    <div class="user-avatar">${firstLetter}</div>
                    <span>${displayName}</span>
                </a>
            `;
        } else {
            // User is not logged in
            authButtons.innerHTML = `
                <button class="auth-btn" onclick="window.location.href='/pages/auth.html'">Login</button>
            `;
        }
    }

    // Listen to auth state changes
    auth.onAuthStateChanged((user) => {
        updateAuthUI(user);
        updateProductButtonsForUser(user);
    });

    // Ensure buttons reflect current auth state once Firebase is ready
    updateProductButtonsForUser(auth.currentUser);

    // Initialize auth buttons with default state
    document.addEventListener('DOMContentLoaded', function() {
        const authButtons = document.getElementById('auth-buttons');
        if (authButtons && !authButtons.innerHTML.trim()) {
            authButtons.innerHTML = `
                <button class="auth-btn login-btn">Login</button>
            `;
            
            const loginBtn = authButtons.querySelector('.login-btn');
            if (loginBtn) {
                loginBtn.addEventListener('click', function(event) {
                    event.stopPropagation();
                    window.location.href = '/pages/auth.html';
                });
            }
        }
    });
</script>

<!-- Credits Display Script -->
<script src="/assets/js/credits-display.js"></script>

</body>
</html>
