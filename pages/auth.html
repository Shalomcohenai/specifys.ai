<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <meta name="theme-color" content="#000000">
    <title>Sign In / Register - Specifys.ai</title>
    <meta name="description" content="Create account">
    <meta name="keywords" content="AI development tools, app specification generator, no-code platform, AI-powered planning, vibe coding, AI app builder, specification generator, market research tool, app planning tool, development tools, AI tools">
    <meta name="author" content="Specifys.ai">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    
    <!-- Content Security Policy - Removed to fix Google Analytics/Ads issues -->
    
    <!-- Canonical URL -->
    
    <link rel="canonical" href="https://specifys-ai.com/pages/auth.html">
    
    
    <!-- Open Graph -->
    <meta property="og:site_name" content="Specifys.ai">
    <meta property="og:title" content="Sign In / Register">
    <meta property="og:description" content="Create account">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://specifys-ai.com/pages/auth.html">
    <meta property="og:image" content="https://specifys-ai.com/assets/images/og-image.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:locale" content="en_US">
    
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@specifysai">
    <meta name="twitter:creator" content="@specifysai">
    <meta name="twitter:title" content="Sign In / Register">
    <meta name="twitter:description" content="Create account">
    <meta name="twitter:image" content="https://specifys-ai.com/assets/images/og-image.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="manifest" href="/site.webmanifest">
    
    <!-- CSS - Loaded in parallel instead of @import for better performance -->
    <!-- Core styles (must be in order) -->
    <link rel="stylesheet" href="/assets/css/core/variables.css">
    <link rel="stylesheet" href="/assets/css/core/fonts.css">
    <link rel="stylesheet" href="/assets/css/core/reset.css">
    <link rel="stylesheet" href="/assets/css/core/typography.css">
    <link rel="stylesheet" href="/assets/css/core/base.css">
    
    <!-- Components -->
    <link rel="stylesheet" href="/assets/css/components/buttons.css">
    <link rel="stylesheet" href="/assets/css/components/header.css">
    <link rel="stylesheet" href="/assets/css/components/footer.css">
    <link rel="stylesheet" href="/assets/css/components/icons.css">
    <link rel="stylesheet" href="/assets/css/components/mermaid.css">
    <link rel="stylesheet" href="/assets/css/components/tables.css">
    
    <!-- Main CSS (contains additional styles and utilities) -->
    <link rel="stylesheet" href="/assets/css/main.css">
    
    <!-- Page-specific CSS -->
    <link rel="stylesheet" href="/assets/css/pages/auth.css">
      
    
    
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- CSS Monitoring Script -->
    <script src="/assets/js/css-monitor.js"></script>
    
    <!-- Credits Configuration - Must load before auth scripts -->
    <script src="/assets/js/credits-config.js"></script>
    
    <!-- Fonts - Optimized: Only Montserrat and Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Removed heavy libraries: Mermaid, Marked, Highlight.js, jsPDF (not needed on auth page) -->
    
    <!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RWBT69JCM7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-RWBT69JCM7');
</script>
    <!-- Analytics Events functions are available via includes/analytics-events.html -->
<!-- Structured Data (JSON-LD) for SEO -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "Organization",
      "name": "Specifys.ai",
      "url": "https://specifys-ai.com",
      "logo": "https://specifys-ai.com/favicon.ico",
      "description": "AI-powered app planning and specification generation platform",
      "sameAs": [
        "https://www.linkedin.com/company/specifys-ai/"
      ],
      "contactPoint": {
        "@type": "ContactPoint",
        "email": "specifysai@gmail.com",
        "contactType": "Customer Service"
      }
    },
    {
      "@type": "WebSite",
      "name": "Specifys.ai",
      "url": "https://specifys-ai.com",
      "description": "Plan your app smarter with AI-driven insights and tools",
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://specifys-ai.com/pages/ToolPicker.html?q={search_term_string}",
        "query-input": "required name=search_term_string"
      }
    },
    {
      "@type": "SoftwareApplication",
      "name": "Specifys.ai",
      "applicationCategory": "DevelopmentApplication",
      "operatingSystem": "Web",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.8",
        "ratingCount": "250"
      },
      "description": "AI-powered app planning platform with specification generator, market research tools, and vibe coding tools map"
    }
  ]
}
</script>


</head>


<body class="page-default">
        <main class="auth-page-layout">
        <!-- Logo -->
        <div class="auth-logo">
            <a href="../index.html">Specifys.ai</a>
        </div>
        
        <!-- Left Panel - Steps Animation -->
        <div class="auth-left-panel">
            <div class="steps-container">
                <h2 id="dynamic-title">App Specification</h2>
                <p id="dynamic-description">Define your app requirements, features, and functionality with our intelligent specification tool. Create detailed technical specifications and user stories.</p>
                <div class="steps-indicators">
                    <span class="step-dot active"></span>
                    <span class="step-dot"></span>
                    <span class="step-dot"></span>
                </div>
            </div>
        </div>

        <!-- Right Panel - Compact Login -->
        <div class="auth-right-panel">
            <div class="compact-login-container">
                <div class="compact-login-header">
                    <h1>Welcome Back</h1>
                    <p>Sign in to continue your app development journey</p>
                </div>

                <div class="auth-tabs">
                    <button class="auth-tab active" onclick="switchTab('login')">Login</button>
                    <button class="auth-tab" onclick="switchTab('register')">Register</button>
                </div>

                <div id="error-message" class="error-message" style="display: none;"></div>
                <div id="success-message" class="success-message" style="display: none;"></div>

                <!-- Login Form -->
                <form id="login-form" class="auth-form active">
                    <div class="compact-form-group">
                        <label for="login-email">Email</label>
                        <input type="email" id="login-email" required>
                    </div>
                    <div class="compact-form-group">
                        <label for="login-password">Password</label>
                        <input type="password" id="login-password" required>
                    </div>
                    <button type="submit" class="compact-btn compact-btn-primary" id="login-btn">
                        <span id="login-btn-text">Sign In</span>
                    </button>
                </form>

                <!-- Register Form -->
                <form id="register-form" class="auth-form">
                    <div class="compact-form-group">
                        <label for="register-email">Email</label>
                        <input type="email" id="register-email" required>
                    </div>
                    <div class="compact-form-group">
                        <label for="register-password">Password</label>
                        <input type="password" id="register-password" required minlength="6">
                    </div>
                    <div class="compact-form-group">
                        <label for="register-confirm">Confirm Password</label>
                        <input type="password" id="register-confirm" required minlength="6">
                    </div>
                    
                    <!-- Newsletter Subscription Checkbox -->
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="newsletter-subscription" checked>
                            <span class="checkmark"></span>
                            Send me updates about new AI tools
                        </label>
                    </div>
                    
                    <!-- Privacy Policy Checkbox -->
                    <div class="checkbox-group" id="privacy-policy-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="privacy-policy-agreement" required>
                            <span class="checkmark"></span>
                            I have read and agree to the <a href="#" class="privacy-link" onclick="openPrivacyModal(); return false;"> privacy policy</a>
                        </label>
                    </div>
                    <div id="privacy-policy-error" class="checkbox-error" role="alert" aria-live="assertive"></div>
                    
                    <button type="submit" class="compact-btn compact-btn-primary" id="register-btn">
                        <span id="register-btn-text">Sign Up</span>
                    </button>
                </form>

                <div class="compact-divider">
                    <span>or</span>
                </div>

                <button class="compact-btn compact-btn-google" onclick="loginWithGoogle()">
                    <span>G</span> Continue with Google
                </button>

            </div>
        </div>
    </main>

    <!-- Privacy Policy Modal -->
    <div id="privacyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Privacy Policy</h2>
                <span class="close" onclick="closePrivacyModal()">&times;</span>
            </div>
            <div class="modal-body">
                <p><strong>Last updated:</strong> January 2025</p>
                
                <h3>Information Collection and Use</h3>
                <p>We collect information you provide directly to us, such as when you create an account, use our services, or contact us for support. This may include your name, email address, and any other information you choose to provide.</p>
                
                <h3>Data Storage and Security</h3>
                <p>Your personal information is stored securely on our servers and is protected by industry-standard security measures. We implement appropriate technical and organizational measures to protect your data against unauthorized access, alteration, disclosure, or destruction.</p>
                
                <h3>Use of Information</h3>
                <p>We use the information we collect to:</p>
                <ul>
                    <li>Provide, maintain, and improve our services</li>
                    <li>Process transactions and send related information</li>
                    <li>Send technical notices, updates, and support messages</li>
                    <li>Respond to your comments and questions</li>
                    <li>Monitor and analyze trends and usage</li>
                </ul>
                
                <h3>Newsletter and Communications</h3>
                <p>If you opt-in to receive our newsletter, we will send you updates about new AI tools and features. You can unsubscribe at any time by clicking the unsubscribe link in our emails or by contacting us directly.</p>
                
                <h3>Data Sharing</h3>
                <p>We do not sell, trade, or otherwise transfer your personal information to third parties without your explicit consent, except as described in this policy or as required by law.</p>
                
                <h3>Cookies and Tracking</h3>
                <p>We use cookies and similar tracking technologies to enhance your experience on our website and to analyze how our services are used.</p>
                
                <h3>Your Rights</h3>
                <p>You have the right to:</p>
                <ul>
                    <li>Access your personal information</li>
                    <li>Correct inaccurate data</li>
                    <li>Request deletion of your data</li>
                    <li>Opt-out of communications</li>
                    <li>Withdraw consent at any time</li>
                </ul>
                
                <h3>Data Retention</h3>
                <p>We retain your personal information for as long as necessary to provide our services and as required by applicable laws.</p>
                
                <h3>Changes to This Policy</h3>
                <p>We may update this privacy policy from time to time. We will notify you of any changes by posting the new policy on this page.</p>
                
                <h3>Contact Us</h3>
                <p>If you have any questions about this privacy policy, please contact us at privacy@specifys.ai.</p>
            </div>
        </div>
    </div>

    <script src="../assets/js/script.js"></script>
    <script src="../assets/js/mobile-optimizations.js"></script>

    <!-- Firebase SDK -->
    <script type="module">
        // Import Firebase SDK
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { 
            createUserWithEmailAndPassword, 
            signInWithEmailAndPassword, 
            signOut, 
            onAuthStateChanged,
            GoogleAuthProvider,
            signInWithPopup,
            getAuth
        } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
        import { getFirestore, doc, setDoc, serverTimestamp, getDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyB9hr0IWM4EREzkKDxBxYoYinV6LJXWXV4",
    authDomain: "specify-ai.firebaseapp.com",
    projectId: "specify-ai",
    storageBucket: "specify-ai.firebasestorage.app",
            messagingSenderId: "734278787482",
            appId: "1:734278787482:web:0e312fb6f197e849695a23",
            measurementId: "G-4YR9LK63MR"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const googleProvider = new GoogleAuthProvider();
        const privacyPolicyCheckbox = document.getElementById('privacy-policy-agreement');
        const privacyPolicyGroup = document.getElementById('privacy-policy-group');
        const privacyPolicyError = document.getElementById('privacy-policy-error');
        
        // Track if we're processing a redirect
        let isProcessingRedirect = false;
        
        // Listen for auth state changes (this catches redirect results)
        onAuthStateChanged(auth, async (user) => {
            if (user && !isProcessingRedirect) {
                // User is signed in - check if this is from a redirect
                const urlParams = new URLSearchParams(window.location.search);
                const fromAuth = sessionStorage.getItem('attemptingGoogleSignIn');
                
                // If we were attempting sign in, process it
                if (fromAuth === 'true') {
                    isProcessingRedirect = true;
                    sessionStorage.removeItem('attemptingGoogleSignIn');
                    

                    
                    try {
                        await createUserDocument(user);

                        
                        showSuccess('Login successful! Redirecting to homepage...');
                        setTimeout(() => {
                            window.location.href = '../index.html';
                        }, 1500);
                    } catch (error) {

                        showError('Error completing sign-in: ' + error.message);
                    }
                }
            }
        });
        
        // Handle redirect result when user comes back from Google Sign-In
        (async function checkRedirectResult() {



            
            try {
                const { getRedirectResult } = await import("https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js");


                
                // Show loading state while checking
                const authContainer = document.querySelector('.auth-container');
                if (authContainer) {
                    const loadingDiv = document.createElement('div');
                    loadingDiv.id = 'redirect-loading';
                    loadingDiv.style.cssText = 'position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); z-index: 10000; text-align: center;';
                    loadingDiv.innerHTML = '<div style="font-size: 16px; color: #333;">Completing sign in...</div>';
                    document.body.appendChild(loadingDiv);
                    

                    const result = await getRedirectResult(auth);
                    
                    // Remove loading
                    loadingDiv.remove();
                    
                    if (result && result.user) {
                        await createUserDocument(result.user);

                        
                        showSuccess('Login successful! Redirecting to homepage...');
                        setTimeout(() => {
                            window.location.href = '../index.html';
                        }, 1500);
                    } else {

                    }
                } else {
                    const result = await getRedirectResult(auth);
                    
                    if (result && result.user) {
                        await createUserDocument(result.user);
                        showSuccess('Login successful! Redirecting to homepage...');
                        setTimeout(() => {
                            window.location.href = '../index.html';
                        }, 1500);
                    } else {

                    }
                }
            } catch (error) {
                showError('Authentication error: ' + error.message);
            }
            

        })();

        // Create user document in Firestore
        async function createUserDocument(user) {
            try {

                const userRef = doc(db, 'users', user.uid);
                const existingUserSnapshot = await getDoc(userRef);

                const userData = {
                    email: user.email || null,
                    displayName: user.displayName || (user.email ? user.email.split('@')[0] : `User ${user.uid.substring(0, 8)}`),
                    emailVerified: user.emailVerified || false,
                    createdAt: serverTimestamp(),
                    lastActive: serverTimestamp(),
                    newsletterSubscription: false,
                    plan: 'free'
                };

                if (!existingUserSnapshot.exists()) {
                    userData.free_specs_remaining = 1;
                } else {
                    const currentFreeSpecs = existingUserSnapshot.data()?.free_specs_remaining;
                    if (typeof currentFreeSpecs !== 'number') {
                        userData.free_specs_remaining = 1;
                    }
                }

                await setDoc(userRef, userData, { merge: true });
                
                // Also create entitlements document if doesn't exist
                const entitlementsRef = doc(db, 'entitlements', user.uid);
                const existingEntitlementsSnapshot = await getDoc(entitlementsRef);
                
                // Give new users 1 free credit
                const isNewUser = !existingUserSnapshot.exists();
                const entitlementsData = {
                    userId: user.uid,
                    unlimited: false,
                    can_edit: false,
                    updated_at: serverTimestamp()
                };
                
                // Only set spec_credits if entitlements don't exist
                // New users get 1 credit, existing users without entitlements get 0 
                // (they may have free_specs_remaining or should get credits through other means)
                if (!existingEntitlementsSnapshot.exists()) {
                    entitlementsData.spec_credits = isNewUser ? 1 : 0;
                }
                // If entitlements exist, merge will preserve existing spec_credits
                
                await setDoc(entitlementsRef, entitlementsData, { merge: true });

            } catch (error) {
                console.error('Error creating user document:', error);
                throw error; // Re-throw to be caught by calling function
            }
        }

        // Tab switching
        function switchTab(tab) {
            // Update tab buttons
            document.querySelectorAll('.auth-tab').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[onclick="switchTab('${tab}')"]`).classList.add('active');
            
            // Update forms
            document.querySelectorAll('.auth-form').forEach(form => form.classList.remove('active'));
            document.getElementById(`${tab}-form`).classList.add('active');
            
            // Clear messages
            hideMessages();
        }

        // Show/hide messages
        function showError(message) {
            // Create a temporary error notification
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: #dc3545;
                color: white;
                padding: 12px 20px;
                border-radius: 6px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                z-index: 10000;
                font-size: 14px;
                font-weight: 500;
                animation: slideUp 0.3s ease-out;
            `;
            notification.textContent = message;
            
            // Add animation styles
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideUp {
                    from { transform: translateX(-50%) translateY(100%); opacity: 0; }
                    to { transform: translateX(-50%) translateY(0); opacity: 1; }
                }
            `;
            document.head.appendChild(style);
            
            document.body.appendChild(notification);
            
            // Remove after 5 seconds
            setTimeout(() => {
                notification.remove();
                style.remove();
            }, 5000);
        }

        function showSuccess(message) {
            // Create a temporary success notification
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: #28a745;
                color: white;
                padding: 12px 20px;
                border-radius: 6px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                z-index: 10000;
                font-size: 14px;
                font-weight: 500;
                animation: slideUp 0.3s ease-out;
            `;
            notification.textContent = message;
            
            // Add animation styles
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideUp {
                    from { transform: translateX(-50%) translateY(100%); opacity: 0; }
                    to { transform: translateX(-50%) translateY(0); opacity: 1; }
                }
            `;
            document.head.appendChild(style);
            
            document.body.appendChild(notification);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.remove();
                style.remove();
            }, 3000);
        }

        function hideMessages() {
            const errorMsg = document.getElementById('error-message');
            const successMsg = document.getElementById('success-message');
            if (errorMsg) errorMsg.style.display = 'none';
            if (successMsg) successMsg.style.display = 'none';
        }

        function showPrivacyPolicyError() {
            if (!privacyPolicyGroup || !privacyPolicyError) return;

            // Force reflow to restart animation
            privacyPolicyGroup.classList.remove('has-error');
            void privacyPolicyGroup.offsetWidth; // Force reflow
            
            // Add error class to trigger animation
            privacyPolicyGroup.classList.add('has-error');

            // Show error message
            privacyPolicyError.textContent = 'Please agree to the privacy policy before continuing.';
            privacyPolicyError.classList.add('visible');
            
            // Scroll to checkbox if needed (for better UX)
            privacyPolicyGroup.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function hidePrivacyPolicyError() {
            if (!privacyPolicyGroup || !privacyPolicyError) return;
            privacyPolicyGroup.classList.remove('has-error');
            privacyPolicyError.textContent = '';
            privacyPolicyError.classList.remove('visible');
        }

        // Auth functions
        async function registerWithEmail(email, password) {
            try {
                const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                await createUserDocument(userCredential.user);
                return userCredential.user;
            } catch (error) {
                throw new Error(getAuthErrorMessage(error.code));
            }
        }

        async function loginWithEmail(email, password) {
            try {
                const userCredential = await signInWithEmailAndPassword(auth, email, password);
                await createUserDocument(userCredential.user);
                return userCredential.user;
            } catch (error) {
                throw new Error(getAuthErrorMessage(error.code));
            }
        }

        async function loginWithGoogle(useRedirect = false) {

            try {
                if (useRedirect) {

                    const { signInWithRedirect } = await import("https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js");
                    await signInWithRedirect(auth, googleProvider);
                    // This will redirect away, so no code after this will run
                    return;
                }
                
                
                // Add a small delay to ensure popup is not blocked
                await new Promise(resolve => setTimeout(resolve, 100));
                

                
                // Monitor the popup
                const popupPromise = signInWithPopup(auth, googleProvider);
                
                // Check if popup opened

                
                const result = await popupPromise;
                
                await createUserDocument(result.user);

                
                return result.user;
            } catch (error) {
                // If popup was closed, suggest redirect method
                if (error.code === 'auth/popup-closed-by-user' || error.code === 'auth/popup-blocked') {

                }
                
                throw new Error(getAuthErrorMessage(error.code));
            }
        }

        // Error messages
        function getAuthErrorMessage(errorCode) {
            const errorMessages = {
                        'auth/user-not-found': 'User not found',
        'auth/wrong-password': 'Wrong password',
        'auth/email-already-in-use': 'Email already in use',
        'auth/weak-password': 'Password too weak',
        'auth/invalid-email': 'Invalid email',
                'auth/user-disabled': 'Account disabled',
                'auth/too-many-requests': 'Too many attempts, try again later',
                'auth/operation-not-allowed': 'Operation not allowed',
                'auth/requires-recent-login': 'Requires recent login',
                'auth/popup-closed-by-user': 'Login window closed',
                'auth/cancelled-popup-request': 'Request cancelled',
                'auth/popup-blocked': 'Login window blocked',
                'auth/account-exists-with-different-credential': 'Account exists with different credential',
                'auth/credential-already-in-use': 'Credential already in use',
                'auth/invalid-credential': 'Invalid credential',
                'auth/timeout': 'Timeout, try again',
                'auth/network-request-failed': 'Network error, check internet connection'
            };
            
            return errorMessages[errorCode] || 'Unknown error';
        }

        // Form handlers
        document.getElementById('login-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            const btn = document.getElementById('login-btn');
            const btnText = document.getElementById('login-btn-text');
            
            btn.disabled = true;
            btnText.textContent = 'Logging in...';
            
            try {
                await loginWithEmail(email, password);
                showSuccess('Login successful! Redirecting to homepage...');
                setTimeout(() => {
                    window.location.href = '../index.html';
                }, 1500);
            } catch (error) {
                showError(error.message);
            } finally {
                btn.disabled = false;
                btnText.textContent = 'Sign In';
            }
        });

        document.getElementById('register-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            const confirmPassword = document.getElementById('register-confirm').value;
            const newsletterSubscription = document.getElementById('newsletter-subscription').checked;
            const privacyPolicyAgreed = privacyPolicyCheckbox ? privacyPolicyCheckbox.checked : false;
            
            if (password !== confirmPassword) {
                showError('Passwords do not match');
                return;
            }
            
            if (!privacyPolicyAgreed) {
                showPrivacyPolicyError();
                showError('You must agree to the privacy policy to register');
                return;
            }

            hidePrivacyPolicyError();
            
            const btn = document.getElementById('register-btn');
            const btnText = document.getElementById('register-btn-text');
            
            btn.disabled = true;
            btnText.textContent = 'Registering...';
            
            try {
                const user = await registerWithEmail(email, password);
                
                showSuccess('Registration successful! Redirecting to homepage...');
                setTimeout(() => {
                    window.location.href = '../index.html';
                }, 1500);
            } catch (error) {
                showError(error.message);
            } finally {
                btn.disabled = false;
                btnText.textContent = 'Sign Up';
            }
        });

        if (privacyPolicyCheckbox) {
            privacyPolicyCheckbox.addEventListener('change', (event) => {
                if (event.target.checked) {
                    hidePrivacyPolicyError();
                } else {
                    showPrivacyPolicyError();
                }
            });
        }

        // Check browser compatibility
        function checkBrowserCompatibility() {



            // Removed popup test - was opening extra window
        }
        
        // Google login - SYNCHRONOUS to avoid popup blocker
        window.loginWithGoogle = function() {

            
            // Check compatibility first
            checkBrowserCompatibility();
            
            // Call signInWithPopup IMMEDIATELY (synchronously) from user click
            // This prevents popup blockers



            

            const popupPromise = signInWithPopup(auth, googleProvider);

            
            popupPromise
                .then(async (result) => {
                    await createUserDocument(result.user);

                    
                    showSuccess('Login successful! Redirecting to homepage...');
                    setTimeout(() => {
                        window.location.href = '../index.html';
                    }, 1500);
                })
                .catch((error) => {
                    if (error.code === 'auth/popup-blocked') {
                        showError('Popup was blocked. Please allow popups for this site and try again.');
                    } else if (error.code === 'auth/popup-closed-by-user') {
                        showError('Sign-in cancelled.');
                    } else {
                        showError(getAuthErrorMessage(error.code) || 'Authentication failed. Please try again.');
                    }
                });
        };

        // Privacy Modal Functions
        function openPrivacyModal() {
            document.getElementById('privacyModal').style.display = 'block';
        }

        function closePrivacyModal() {
            document.getElementById('privacyModal').style.display = 'none';
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('privacyModal');
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        }

        // Global functions
        window.switchTab = switchTab;
        window.openPrivacyModal = openPrivacyModal;
        window.closePrivacyModal = closePrivacyModal;

        // Auth UI functions
        function updateAuthUI(user) {
            const authButtons = document.getElementById('auth-buttons');
            if (!authButtons) return;
            
            if (user) {
                // User is logged in
                const displayName = user.displayName || user.email.split('@')[0];
                const firstLetter = displayName.charAt(0).toUpperCase();
                
                authButtons.innerHTML = `
                    <a href="profile.html" class="user-info" style="text-decoration: none;">
                        <div class="user-avatar">${firstLetter}</div>
                        <span>${displayName}</span>
                    </a>
                `;
            } else {
                // User is not logged in
                authButtons.innerHTML = `
                    <button class="auth-btn" onclick="showLoginModal()">Log in/Sign up</button>
                    <button class="auth-btn primary" onclick="showRegisterModal()">Register</button>
                `;
            }
            
            // Update mobile auth UI if function exists
            if (window.updateMobileAuthUI) {
                window.updateMobileAuthUI(user);
            }
        }

        window.showLoginModal = function() {
            window.location.href = 'auth.html';
        };

        window.showRegisterModal = function() {
            window.location.href = 'auth.html';
        };

        window.logout = function() {
            signOut(auth)
                .then(() => {
                    window.location.href = '../index.html';
                })
                .catch(error => {

                    alert('Logout error: ' + error.message);
                });
        };

        // Redirect if already logged in
        onAuthStateChanged(auth, (user) => {
            if (user) {
                window.location.href = '../index.html';
            }
        });

        // Animated headers for left panel
        const stepsData = [
            {
                title: "App Specification",
                description: "Define your app requirements, features, and functionality with our intelligent specification tool. Create detailed technical specifications and user stories."
            },
            {
                title: "Development Management",
                description: "Manage your app development process efficiently with our project management tools. Track progress, coordinate teams, and ensure timely delivery."
            },
            {
                title: "AI-Powered Planning",
                description: "Leverage artificial intelligence to create comprehensive app specifications. Get detailed project plans, technical requirements, and market analysis."
            }
        ];

        let currentStep = 0;
        let titleElement, descriptionElement, stepDots;

        function updateStep() {
            if (!titleElement || !descriptionElement) return;
            
            // Fade out
            titleElement.style.opacity = '0';
            descriptionElement.style.opacity = '0';
            
            setTimeout(() => {
                // Update content
                titleElement.textContent = stepsData[currentStep].title;
                descriptionElement.textContent = stepsData[currentStep].description;
                
                // Update step indicators
                if (stepDots) {
                    stepDots.forEach((dot, index) => {
                        dot.classList.toggle('active', index === currentStep);
                    });
                }
                
                // Fade in
                titleElement.style.opacity = '1';
                descriptionElement.style.opacity = '1';
                
                // Move to next step
                currentStep = (currentStep + 1) % stepsData.length;
            }, 300);
        }

        // Initialize animation
        function initAnimation() {
            // Get elements after DOM is loaded
            titleElement = document.getElementById('dynamic-title');
            descriptionElement = document.getElementById('dynamic-description');
            stepDots = document.querySelectorAll('.step-dot');
            
            // Check if elements exist
            if (!titleElement || !descriptionElement) {
                // Elements not found - silently skip animation
                return;
            }
            
            titleElement.style.transition = 'opacity 0.3s ease';
            descriptionElement.style.transition = 'opacity 0.3s ease';
            
            // Start the animation
            setInterval(updateStep, 2000); // Change every 2 seconds
        }

        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initAnimation);
        } else {
            // DOM already loaded
            initAnimation();
        }
    </script>


    <script>
        // Basic header functionality
        document.addEventListener('DOMContentLoaded', function() {
            
            
        });

        // Initialize auth buttons with default state
        document.addEventListener('DOMContentLoaded', function() {
            const authButtons = document.getElementById('auth-buttons');
            if (authButtons && !authButtons.innerHTML.trim()) {
                authButtons.innerHTML = `
                    <button class="auth-btn login-btn">Log in/Sign up</button>
                `;
                
                const loginBtn = authButtons.querySelector('.login-btn');
                if (loginBtn) {
                    loginBtn.addEventListener('click', function(event) {
                        event.stopPropagation();
                        window.location.href = 'auth.html';
                    });
                }
            }
        });

        // Auth functions will be handled by the modern Firebase v9+ script above
    </script>

    
    <!-- Auth page uses its own Firebase module scripts -->
</body>
</html>

