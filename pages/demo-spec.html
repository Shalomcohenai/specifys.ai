<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <meta name="theme-color" content="#000000">
    <title>Live Demo - Specifys.ai</title>
    <meta name="description" content="See a complete app specification generated by Specifys.ai">
    <meta name="keywords" content="AI development tools, app specification generator, no-code platform, AI-powered planning, vibe coding, AI app builder, specification generator, market research tool, app planning tool, development tools, AI tools">
    <meta name="author" content="Specifys.ai">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    
    <link rel="canonical" href="https://specifys-ai.com/pages/demo-spec.html">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/pages/demo.css">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Montserrat:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Mermaid for diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.9.1/dist/mermaid.min.js"></script>
    
    <!-- Chart.js for interactive charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    
    <!-- Marked for markdown parsing -->
    <script src="https://cdn.jsdelivr.net/npm/marked@4.3.0/marked.min.js"></script>
    
    <!-- Highlight.js for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- API Configuration -->
    <script src="/assets/js/config.js"></script>
    
    <!-- Entitlements Cache -->
    <script src="/assets/js/entitlements-cache.js"></script>
    
    <!-- Spec Formatter -->
    <script src="/assets/js/spec-formatter.js"></script>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RWBT69JCM7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-RWBT69JCM7');
    </script>

    <style>
        /* Spec Display Styles */
        .spec-tabs {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            border-bottom: 2px solid #e0e0e0;
            flex-wrap: wrap;
        }
        
        .spec-tab {
            padding: 12px 24px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            font-family: var(--body-font);
        }
        
        .spec-tab:hover {
            color: #FF6B35;
        }
        
        .spec-tab.active {
            color: #FF6B35;
            border-bottom-color: #FF6B35;
        }
        
        .spec-content {
            display: none;
        }
        
        .spec-content.active {
            display: block;
        }
        
        .loading-content {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }
        
        .loading-spinner {
            font-size: 48px;
            color: #FF6B35;
            margin-bottom: 20px;
            display: block;
        }
        
        /* Chat Styles */
        .chat-container {
            display: flex;
            flex-direction: column;
            height: 600px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: #f9f9f9;
        }
        
        .chat-message {
            margin-bottom: 16px;
            display: flex;
            flex-direction: column;
        }
        
        .chat-message.user {
            align-items: flex-end;
        }
        
        .chat-message.assistant {
            align-items: flex-start;
        }
        
        .chat-message-bubble {
            max-width: 70%;
            padding: 12px 16px;
            border-radius: 8px;
            word-wrap: break-word;
        }
        
        .chat-message.user .chat-message-bubble {
            background: white;
            color: #333;
            border: 1px solid #ff6b35;
        }
        
        .chat-message.assistant .chat-message-bubble {
            background: white;
            color: #333;
            border: 1px solid #ddd;
        }
        
        .chat-input-container {
            display: flex;
            padding: 15px;
            background: white;
            border-top: 1px solid #e0e0e0;
            gap: 10px;
        }
        
        .chat-input {
            flex: 1;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .chat-send-btn {
            padding: 12px 24px;
            background: #FF6B35;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .chat-send-btn:hover {
            background: #FF8551;
        }
        
        .chat-welcome {
            text-align: center;
            padding: 40px 20px;
            color: #666;
        }
        
        .chat-welcome i {
            font-size: 48px;
            color: #FF6B35;
            margin-bottom: 15px;
            display: block;
        }
        
        .demo-notice {
            background: #FFF9E6;
            border: 1px solid #FFD700;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            color: #856404;
        }
        
        .demo-notice i {
            color: #FFD700;
            margin-right: 8px;
        }
        
        /* Content Section Styles - Reset and enhanced */
        .spec-content {
            font-size: 16px;
            line-height: 1.8;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .content-section {
            background: white;
            padding: 30px;
            margin-bottom: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .content-section:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
        }
        
        .content-section h3 {
            font-size: 24px;
            margin-bottom: 20px;
            color: #333;
            font-weight: 700;
            padding-bottom: 10px;
            border-bottom: 3px solid #6366F1;
        }
        
        .content-section h3 i {
            color: #6366F1;
            margin-right: 12px;
            font-size: 28px;
        }
        
        .content-section h4 {
            font-size: 18px;
            margin-top: 25px;
            margin-bottom: 15px;
            color: #444;
            font-weight: 600;
        }
        
        .content-section p {
            font-size: 16px;
            line-height: 1.8;
            margin-bottom: 15px;
            color: #555;
        }
        
        .content-section ul, .content-section ol {
            margin-left: 30px;
            margin-bottom: 20px;
            font-size: 16px;
        }
        
        .content-section li {
            margin-bottom: 12px;
            line-height: 1.8;
            color: #555;
        }
        
        .content-section pre {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            border: 1px solid #e0e0e0;
            font-size: 14px;
            line-height: 1.6;
        }
        
        .content-section code {
            background: #f5f5f5;
            padding: 3px 8px;
            border-radius: 4px;
            font-family: 'Monaco', 'Courier New', monospace;
        }
        
        .content-section table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 16px;
        }
        
        .content-section table th {
            background: #f5f5f5;
            padding: 15px;
            border: 1px solid #ddd;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
        }
        
        .content-section table td {
            padding: 15px;
            border: 1px solid #ddd;
        }
        
        /* Chart container */
        .chart-container {
            position: relative;
            height: 400px;
            margin: 30px 0;
            padding: 20px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }
        
        /* Diagram item */
        .diagram-item {
            margin-bottom: 50px;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .diagram-item h3 {
            font-size: 22px;
            margin-bottom: 15px;
            color: #333;
        }
        
        /* Stat cards */
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 20px;
        }
        
        .stat-card h4 {
            margin: 0 0 10px 0;
            font-size: 18px;
        }
        
        .stat-card .stat-value {
            font-size: 36px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        /* Feature grid */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .feature-card {
            background: #f9f9f9;
            padding: 25px;
            border-radius: 10px;
            border-left: 4px solid #6366F1;
            transition: all 0.3s ease;
        }
        
        .feature-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(99, 102, 241, 0.15);
            background: white;
        }
        
        .feature-card h4 {
            color: #333;
            margin-bottom: 10px;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .content-section {
            animation: fadeInUp 0.5s ease-out;
        }
        
        /* Compare table */
        .comparison-table {
            overflow-x: auto;
        }
    </style>
</head>

<body>
    <!-- Skip to main content link -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Header -->
    <header class="thematic-header" role="banner">
        <div class="header-center">
            <div class="logo">
                <a href="/" aria-label="Specifys.ai homepage">
                    <span class="logo-text">Specifys<span class="logo-dot">.</span>AI</span>
                </a>
            </div>
        </div>
        <div class="header-right">
            <div class="credits-display" id="credits-display" style="display: none;">
                <div class="credits-container">
                    <i class="fas fa-dollar-sign"></i>
                    <span id="credits-text">0</span>
                </div>
            </div>
            <div class="auth-buttons" id="auth-buttons">
                <!-- Will be populated by auth system -->
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main id="main-content" class="main-content">
        <div class="demo-container">
            <div class="demo-header">
                <h1>Live Demo - Complete App Specification</h1>
                <p>Explore a real specification generated by Specifys.ai. Click any tab to view different sections, or chat with the AI assistant.</p>
            </div>
            
            <div class="demo-notice">
                <i class="fas fa-info-circle"></i>
                <strong>Demo Mode:</strong> This is a frozen specification displayed for demonstration. Chat with AI to learn more about any section.
            </div>
            
            <div class="spec-tabs" id="specTabs">
                <button class="spec-tab active" data-tab="overview">Overview</button>
                <button class="spec-tab" data-tab="technical">Technical</button>
                <button class="spec-tab" data-tab="market">Market Research</button>
                <button class="spec-tab" data-tab="design">Design</button>
                <button class="spec-tab" data-tab="diagrams">Diagrams</button>
                <button class="spec-tab" data-tab="chat">Chat with AI</button>
            </div>
            
            <div id="overview" class="spec-content active"></div>
            <div id="technical" class="spec-content"></div>
            <div id="market" class="spec-content"></div>
            <div id="design" class="spec-content"></div>
            <div id="diagrams" class="spec-content"></div>
            <div id="chat" class="spec-content"></div>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-links">
                <a href="/pages/how.html" aria-label="Learn how specifys.ai works">How It Works</a>
                <a href="/pages/about.html" aria-label="Learn more about specifys.ai">About Us</a>
                <a href="/blog/" aria-label="Visit our blog">Blog</a>
                <a href="/tools/map/vibe-coding-tools-map.html" aria-label="Explore Vibe Coding Tools Map">Vibe Coding Tools Map</a>
                <a href="/pages/ToolPicker.html" aria-label="Use our Tool Finder">Tool Finder</a>
            </div>
            <span class="footer-divider">|</span>
            <div class="footer-social">
                <a href="https://www.linkedin.com/company/specifys-ai/" target="_blank" aria-label="Follow us on LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                <a href="https://www.facebook.com/profile.php?id=61576402600129&locale=he_IL" target="_blank" aria-label="Follow us on Facebook"><i class="fab fa-facebook-f"></i></a>
                <a href="mailto:specifysai@gmail.com" aria-label="Send us an email"><i class="fas fa-envelope"></i></a>
                <a href="https://www.producthunt.com/products/specifys-ai" target="_blank" aria-label="Check us out on Product Hunt"><i class="fab fa-product-hunt"></i></a>
            </div>
        </div>
        <div class="footer-copyright">
            © 2025 specifys.ai. All rights reserved. <span class="footer-version">v1.2.4</span>
        </div>
    </footer>

    <!-- Scroll to top button -->
    <button class="icon-btn scroll-to-top" id="scrollToTop" aria-label="Scroll">
        <i class="fas fa-arrow-up"></i>
    </button>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const scrollBtn = document.getElementById('scrollToTop');
            
            if (scrollBtn) {
                scrollBtn.addEventListener("click", () => {
                    if (window.scrollY > 300) {
                        window.scrollTo({ top: 0, behavior: "smooth" });
                    } else {
                        window.scrollTo({ top: document.body.scrollHeight, behavior: "smooth" });
                    }
                });
                
                window.addEventListener("scroll", () => {
                    if (window.scrollY > 300) {
                        scrollBtn.classList.add("scrolled-down");
                        scrollBtn.setAttribute("aria-label", "Scroll to top");
                    } else {
                        scrollBtn.classList.remove("scrolled-down");
                        scrollBtn.setAttribute("aria-label", "Scroll to bottom");
                    }
                });
            }
        });
    </script>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

    <script>
        // Initialize Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyB9hr0IWM4EREzkKDxBxYoYinV6LJXWXV4",
            authDomain: "specify-ai.firebaseapp.com",
            projectId: "specify-ai",
            storageBucket: "specify-ai.firebasestorage.app",
            messagingSenderId: "734278787482",
            appId: "1:734278787482:web:0e312fb6f197e849695a23",
            measurementId: "G-4YR9LK63MR"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // Initialize Mermaid
        mermaid.initialize({ 
            startOnLoad: false,
            theme: 'default'
        });

        // Demo specification data - comprehensive hardcoded spec (3x detailed)
        const demoSpecData = {
            title: "Taskify Pro - Smart Task Management Platform",
            overview: {
                applicationSummary: {
                    paragraphs: [
                        "Taskify Pro is an intelligent, AI-powered task management platform that revolutionizes productivity for modern professionals and teams. Unlike traditional to-do applications that simply list tasks, Taskify Pro serves as a comprehensive productivity intelligence system that learns, adapts, and optimizes workflows in real-time. The platform represents the culmination of over 10,000 hours of user research, design thinking, and technological innovation, addressing the fundamental challenges that professionals face in today's fast-paced, multi-project work environment.",
                        "The platform specifically targets busy professionals, team managers, entrepreneurs, executives, and creative individuals who regularly juggle 10-50 concurrent tasks across multiple projects. These users experience common pain points: constant context switching that reduces cognitive efficiency, unclear priority management leading to missed critical deadlines, lack of visibility into actual time expenditure, coordination challenges when managing distributed teams, and the overwhelming sense of always playing catch-up despite working long hours.",
                        "Built with enterprise-grade technology and security standards, Taskify Pro delivers enterprise-level capabilities in an accessible, consumer-friendly package. The platform offers seamless cross-platform synchronization across Web, iOS, Android, Windows, macOS, and Linux environments with offline-first architecture ensuring uninterrupted access. Real-time collaboration features include live cursors, activity streams, instant notifications, conflict resolution algorithms, and intelligent permission systems that scale from individual users to enterprises with thousands of team members.",
                        "What truly distinguishes Taskify Pro is its proprietary AI-powered decision engine that transcends simple task tracking. The system understands not just what you're doing, but why it matters, when it's optimal to execute, and how it fits into your broader productivity patterns. The AI analyzes historical work patterns, energy levels throughout the day, meeting schedules, project dependencies, and even factors like commute times and work-life balance preferences to suggest the most impactful work at the optimal times.",
                        "The platform integrates deeply with over 50+ productivity tools and services including Slack, GitHub, Google Calendar, Microsoft Teams, Zoom, Notion, Jira, Trello, Asana, Gmail, Outlook, Salesforce, and many others. These aren't superficial integrations - they provide bi-directional sync, context-aware task creation from emails and messages, automatic calendar conflict resolution, and intelligent data aggregation that creates a unified productivity ecosystem without forcing users to abandon their existing workflows.",
                        "Taskify Pro goes beyond task management to provide comprehensive productivity analytics and coaching. The platform tracks time expenditure patterns, identifies bottlenecks in workflows, measures productivity metrics, provides weekly insights reports, suggests workflow optimizations, and even warns users about signs of burnout or inefficient task distribution. This data-driven approach helps users understand their work habits deeply and continuously improve their productivity systems.",
                        "Security and privacy are foundational to the platform. Taskify Pro implements end-to-end encryption for all task data, offers on-premise deployment options for enterprises with strict compliance requirements, provides granular permission systems, audit logs for all actions, data residency controls, and exceeds SOC 2, GDPR, and HIPAA compliance standards. Individual users can trust that their personal productivity data remains private, while enterprises can confidently deploy the platform across their entire organization."
                    ]
                },
                coreFeatures: [
                    "AI-powered task prioritization that analyzes deadlines, importance scores, dependencies, and your personal productivity patterns to suggest the optimal order of tasks",
                    "Smart calendar integration with automatic deadline reminders that learn your meeting cadence and suggest blocks of focused work time",
                    "Collaborative boards for team projects with real-time updates, live cursors, activity streams, and smart conflict resolution for multi-user editing",
                    "Intelligent task suggestions based on past work patterns, time of day energy levels, and predictive analytics that understand when you do your best work",
                    "Customizable workflows and automation rules that eliminate repetitive task management with triggers, conditions, and multi-step actions",
                    "Advanced time tracking with automatic categorization and productivity analytics that show you where your time actually goes",
                    "Cross-platform synchronization (Web, iOS, Android, Desktop) with offline-first architecture ensuring you're never without access to your tasks",
                    "Natural language processing for task creation - just type 'call John about the project tomorrow at 3pm' and it creates the task with all metadata",
                    "Smart template library with hundreds of project templates for common workflows like software development, marketing campaigns, event planning, and more",
                    "Integration with 50+ productivity tools including Slack, GitHub, Google Calendar, Microsoft Teams, Zoom, Notion, Jira, Trello, Asana, and more with bi-directional sync",
                    "AI-powered email integration that automatically creates tasks from emails based on content analysis and sender importance",
                    "Personal productivity coach that provides weekly insights, identifies time drains, and suggests improvements to your workflow",
                    "Energy-based scheduling that matches high-energy tasks to your peak performance hours based on historical data",
                    "Context-aware task grouping that automatically organizes related tasks and suggests batch processing opportunities",
                    "Advanced reporting and analytics dashboard showing completion rates, time estimates vs actual, team velocity, and productivity trends over time"
                ],
                uniqueValueProposition: "Taskify Pro is the only task management platform that uses advanced AI to genuinely understand your work style, energy patterns, and cognitive load. It doesn't just organize your tasks - it acts as a productivity partner that proactively suggests the most impactful work at optimal times, helps you avoid burnout through intelligent task distribution, and learns from your successes to continuously improve your workflow. While competitors focus on features, Taskify Pro focuses on outcomes: helping you accomplish more meaningful work in less time while maintaining mental clarity and work-life balance.",
                targetAudience: {
                    primary: "Busy professionals (age 28-50), team managers, executives, and high-achieving individuals in tech, consulting, finance, creative agencies, and service industries who regularly manage 10+ concurrent projects and need to stay organized without adding management overhead",
                    characteristics: "Tech-savvy early adopters who value efficiency and automation, overwhelmed by task overload and context switching, strategic thinkers who appreciate data-driven insights, professionals who seek work-life balance",
                    painPoints: [
                        "Task overload leading to constant stress and missed deadlines",
                        "Inability to determine what actually matters vs. what feels urgent",
                        "Team coordination challenges causing communication gaps and duplicate work",
                        "Context switching between multiple projects leading to reduced productivity",
                        "No visibility into where time is actually spent",
                        "Difficulty maintaining work-life balance with boundaries"
                    ]
                },
                problemStatement: "Modern professionals and teams are drowning in tasks. Traditional to-do lists fail to help users identify what truly matters, leading to missed deadlines, constant stress, and decreased productivity. There's no intelligent system that adapts to individual work patterns.",
                businessModel: "Taskify Pro operates on a freemium SaaS (Software-as-a-Service) model with three primary revenue streams: subscription plans for individuals and teams, enterprise licenses with custom deployment options, and strategic partnerships with productivity tool ecosystems. The free tier provides basic task management for individual users while paid tiers unlock advanced AI features, unlimited projects, team collaboration, and enterprise-grade security. Enterprise customers receive white-label options, SSO integration, dedicated support, SLA guarantees, and on-premise deployment for organizations with strict compliance requirements.",
                competitiveAdvantage: "Taskify Pro's competitive advantage lies in its proprietary AI decision engine that learns and adapts to individual work patterns. Unlike competitors who provide static task lists or simple rule-based automation, Taskify Pro uses advanced machine learning to understand context, predict bottlenecks, optimize task distribution, and continuously improve user productivity. The platform's energy-based scheduling, predictive analytics, and comprehensive integration ecosystem create a moat that cannot be easily replicated by feature-focused competitors.",
                successMetrics: {
                    userEngagement: "Daily active users spend average of 35 minutes in platform, complete 85% of high-priority tasks on time, reduce task overload by 40% within first month",
                    productivityImprovement: "Users report 28% increase in meaningful work accomplished, 35% reduction in context switching, and 50% decrease in missed deadlines",
                    businessMetrics: "Target 50,000 paying users in Year 1, $5M ARR by Year 2, 90% net revenue retention rate, enterprise segment representing 60% of revenue by Year 3"
                }
            },
            technical: {
                techStack: {
                    frontend: {
                        framework: "React 18 (Latest stable) - Component-based UI library with hooks, context API, and concurrent rendering features",
                        language: "TypeScript 5.5 - Strict type checking for compile-time error detection and better IDE support",
                        ssr: "Next.js 14 - Server-side rendering, static site generation, API routes, and image optimization",
                        styling: "Tailwind CSS 3.4 - Utility-first CSS framework with custom design tokens and dark mode support",
                        stateManagement: "React Query 5 - Server state management with caching, synchronization, and background updates",
                        animations: "Framer Motion 11 - Declarative animations with gesture support and layout animations",
                        charts: "Recharts 2.10 - Composable charting library built on D3 for analytics dashboards",
                        forms: "React Hook Form 7.55 - Performant form library with validation schema support (Zod integration)",
                        routing: "Next.js App Router 14 - File-based routing with layouts, loading states, and error boundaries"
                    },
                    backend: {
                        runtime: "Node.js 20 LTS - Latest Long Term Support version with improved performance and security",
                        framework: "Express.js 4.21 - Minimal web framework with middleware ecosystem",
                        language: "TypeScript 5.5 - Backend type safety matching frontend for consistency",
                        caching: "Redis 7.3 - In-memory data store for session management, rate limiting, and distributed locks",
                        queues: "Bull 5.0 - Redis-based job queue system for async processing and task scheduling",
                        logging: "Winston 3.11 - Structured logging with multiple transports (console, file, remote services)",
                        validation: "Joi 17.13 - Schema-based validation library for request/response validation",
                        orm: "Prisma 5.11 - Type-safe database ORM with migrations and query builder",
                        apidoc: "Swagger/OpenAPI 3.1 - API documentation with interactive testing interface"
                    },
                    database: {
                        primary: "PostgreSQL 15 - Advanced open-source relational database with JSONB support, full-text search, and ACID compliance",
                        documents: "MongoDB Atlas 7.1 - Managed NoSQL database for flexible schema requirements and horizontal scaling",
                        search: "Elasticsearch 8.15 - Distributed search and analytics engine for full-text search across all content",
                        timeseries: "TimescaleDB 2.14 - PostgreSQL extension for time-series data storage and analytics",
                        connection: "Connection pooling via PgBouncer and Redis for optimal resource utilization"
                    },
                    aiService: {
                        provider: "OpenAI GPT-4 Turbo API - Latest multimodal AI model with 128k context window",
                        fineTuning: "Custom fine-tuned models for task prioritization using LORA adapters and reinforcement learning",
                        nlp: "Natural language processing for task creation, intent recognition, and sentiment analysis",
                        fallback: "Ollama local LLM for offline capabilities and reduced API costs",
                        embedding: "OpenAI text-embedding-3 for semantic search and similarity matching"
                    },
                    authentication: {
                        framework: "NextAuth.js v5 - Authentication library with session management",
                        providers: "OAuth 2.0 with Google, Microsoft, GitHub, Apple for social login",
                        tokens: "JWT tokens with refresh mechanism and secure cookie storage",
                        security: "2FA via TOTP (Time-based One-Time Password) using RFC 6238 standard",
                        passwordless: "Magic link authentication with time-limited tokens and email verification",
                        sessions: "Database-backed sessions with automatic cleanup and security best practices"
                    },
                    realtime: {
                        protocol: "WebSocket with Socket.io v4 for bidirectional real-time communication",
                        scaling: "Redis Adapter for horizontal scaling across multiple server instances",
                        features: "Presence tracking, live cursors, activity streams, and typing indicators",
                        conflicts: "Operational Transformation (OT) for real-time collaborative editing without conflicts",
                        fallback: "Automatic reconnection with exponential backoff and message queue for offline support"
                    },
                    storage: {
                        object: "AWS S3 - Scalable object storage with versioning and lifecycle policies",
                        cdn: "CloudFront CDN for global content delivery with automatic compression and caching",
                        images: "Image optimization service using Sharp for resizing, format conversion (WebP, AVIF)",
                        backups: "Automated backups to AWS Glacier for compliance and disaster recovery",
                        caching: "Multi-layer caching strategy (CDN → Edge → Application → Database)"
                    },
                    infrastructure: {
                        containers: "Docker 24 for application containerization and consistent deployments",
                        orchestration: "Kubernetes on AWS EKS for container management, auto-scaling, and service discovery",
                        cicd: "GitHub Actions for automated testing, building, and deployment pipelines",
                        iac: "Terraform for infrastructure as code with version control and environment management",
                        monitoring: "Datadog for APM, infrastructure monitoring, and log aggregation",
                        errors: "Sentry for error tracking, performance monitoring, and release management",
                        logging: "Structured logging with centralized log management and alerting"
                    }
                },
                architectureOverview: "Enterprise-grade microservices architecture with API Gateway pattern ensuring scalability and maintainability. Backend services communicate via REST APIs with OpenAPI documentation and use RabbitMQ message queues for async processing. Real-time updates are handled through WebSocket connections with automatic reconnection and offline queue. AI service runs as separate containerized microservice with dedicated GPU resources, request queuing, and rate limiting. Database connections are pooled with read replicas for performance. Each service is independently deployable with its own CI/CD pipeline, auto-scaling policies, and health checks.",
                databaseSchema: {
                    description: "Hybrid multi-database architecture using PostgreSQL for transactional relational data with strict schema enforcement, MongoDB for flexible document storage of user preferences and metadata, Elasticsearch for blazing-fast full-text search across all task content, and TimescaleDB for storing time-series analytics data like productivity metrics and completion rates over time",
                    tables: [
                        {
                            name: "users",
                            columns: ["id (UUID, PK), email (VARCHAR unique), name (VARCHAR), avatar_url (VARCHAR), timezone (VARCHAR), preferences (JSONB), subscription_tier (ENUM), created_at (TIMESTAMP), updated_at (TIMESTAMP), last_active (TIMESTAMP)"]
                        },
                        {
                            name: "tasks",
                            columns: ["id (UUID, PK), user_id (UUID FK), project_id (UUID FK nullable), title (VARCHAR), description (TEXT), status (ENUM: pending,in_progress,completed,archived), priority (INT 1-10), energy_required (INT 1-5), due_date (TIMESTAMP), completed_at (TIMESTAMP), estimated_time (INT minutes), actual_time (INT minutes), tags (TEXT[]), created_at (TIMESTAMP), updated_at (TIMESTAMP)"]
                        },
                        {
                            name: "projects",
                            columns: ["id (UUID, PK), name (VARCHAR), description (TEXT), owner_id (UUID FK), visibility (ENUM: private,team,public), color (VARCHAR), icon (VARCHAR), team_id (UUID FK nullable), archived (BOOLEAN), created_at (TIMESTAMP), updated_at (TIMESTAMP)"]
                        },
                        {
                            name: "teams",
                            columns: ["id (UUID, PK), name (VARCHAR), description (TEXT), owner_id (UUID FK), settings (JSONB), created_at (TIMESTAMP), updated_at (TIMESTAMP)"]
                        },
                        {
                            name: "team_members",
                            columns: ["id (UUID, PK), team_id (UUID FK), user_id (UUID FK), role (ENUM: owner,admin,member,viewer), permissions (JSONB), joined_at (TIMESTAMP)"]
                        },
                        {
                            name: "integrations",
                            columns: ["id (UUID, PK), user_id (UUID FK), service (VARCHAR), credentials (JSONB encrypted), enabled (BOOLEAN), last_sync (TIMESTAMP), created_at (TIMESTAMP)"]
                        }
                    ]
                },
                apiEndpoints: [
                    { method: "POST", path: "/api/v1/tasks", description: "Create a new task with optional AI-suggested priority and due date" },
                    { method: "GET", path: "/api/v1/tasks", description: "Get all tasks with advanced filtering, pagination, and sorting options" },
                    { method: "GET", path: "/api/v1/tasks/:id", description: "Get detailed information about a specific task including analytics" },
                    { method: "PUT", path: "/api/v1/tasks/:id", description: "Update a task with optimistic locking to prevent conflicts" },
                    { method: "DELETE", path: "/api/v1/tasks/:id", description: "Soft delete a task with archive option" },
                    { method: "GET", path: "/api/v1/ai/suggestions", description: "Get AI task prioritization suggestions based on current workload and historical patterns" },
                    { method: "POST", path: "/api/v1/ai/analyze-workload", description: "Analyze user workload and suggest time distribution optimizations" },
                    { method: "GET", path: "/api/v1/projects", description: "Get all projects with nested task counts and progress metrics" },
                    { method: "GET", path: "/api/v1/analytics/productivity", description: "Get productivity analytics and trends over time" },
                    { method: "POST", path: "/api/v1/integrations/:service/sync", description: "Trigger manual sync with external service integration" }
                ]
            },
            market: {
                charts: {
                    marketGrowth: {
                        title: "Task Management Software Market Growth (2024-2030)",
                        data: [6.76, 7.85, 9.12, 10.64, 12.41, 13.45, 14.6]
                    },
                    competitorComparison: {
                        title: "Market Share Comparison",
                        data: { "Asana": 20, "Monday.com": 15, "Notion": 12, "Other": 53 }
                    },
                    userSegmentation: {
                        title: "Target User Segments",
                        data: { "Individual Professionals": 45, "Small Teams": 30, "Mid-market": 20, "Enterprise": 5 }
                    },
                    searchTrends: {
                        title: "Google Trends - Task Management Keywords (Last 6 Months)",
                        data: {
                            labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun"],
                            datasets: [
                                {
                                    label: "Task Management",
                                    data: [85, 92, 88, 95, 100, 98],
                                    borderColor: '#6366F1',
                                    backgroundColor: 'rgba(99, 102, 241, 0.1)'
                                },
                                {
                                    label: "Productivity Tools",
                                    data: [72, 78, 82, 88, 92, 95],
                                    borderColor: '#10B981',
                                    backgroundColor: 'rgba(16, 185, 129, 0.1)'
                                },
                                {
                                    label: "To-Do List Apps",
                                    data: [95, 88, 90, 85, 92, 96],
                                    borderColor: '#8B5CF6',
                                    backgroundColor: 'rgba(139, 92, 246, 0.1)'
                                },
                                {
                                    label: "Project Management",
                                    data: [78, 85, 91, 88, 95, 100],
                                    borderColor: '#F59E0B',
                                    backgroundColor: 'rgba(245, 158, 11, 0.1)'
                                }
                            ]
                        }
                    },
                    keywordDemand: {
                        title: "Search Volume Trends - Productivity Keywords",
                        keywords: [
                            { term: "task management software", searches: 135000 },
                            { term: "productivity apps", searches: 246000 },
                            { term: "ai task assistant", searches: 189000 },
                            { term: "smart to-do app", searches: 167000 },
                            { term: "team task tracking", searches: 112000 }
                        ]
                    }
                },
                marketSize: "The global task management software market is valued at $6.76 billion in 2024 and is projected to reach $14.6 billion by 2030, growing at a CAGR of 14.2%. This explosive growth is driven by increasing remote work adoption, digital transformation initiatives, and the critical need for productivity tools that can handle distributed teams and complex workflows. The market is experiencing a shift from basic task tracking to intelligent, AI-powered solutions that provide actionable insights and automation.",
                targetCustomers: "Our addressable market consists of approximately 500 million knowledge workers globally, with 150 million located in our primary target markets (United States, Canada, United Kingdom, European Union, Australia). These professionals are increasingly seeking AI-powered solutions that can adapt to their work style rather than forcing them into rigid workflows. Market research shows that 67% of knowledge workers use 3 or more productivity apps daily, creating demand for unified platforms.",
                marketTrends: [
                    "Remote and hybrid work models driving 40% year-over-year growth in task management tool adoption",
                    "AI integration becoming table stakes - 85% of buyers expect AI features in productivity tools by 2025",
                    "Individual contributors now making purchase decisions for team tools, shifting from top-down procurement",
                    "Demand for privacy-first solutions with on-premise deployment options growing 60% annually",
                    "Mobile-first usage patterns - 70% of task management happens on mobile devices during commutes and breaks"
                ],
                competitiveLandscape: [
                    {
                        competitor: "Asana",
                        advantages: "Large feature set, strong brand recognition, established market presence",
                        disadvantages: "Steep learning curve, expensive for small teams, cluttered interface",
                        marketPosition: "Market leader, 20% market share, focused on enterprise customers"
                    },
                    {
                        competitor: "Monday.com",
                        advantages: "Highly customizable, great for teams, excellent visual project management",
                        disadvantages: "Complex setup, high pricing, overwhelming for individual users",
                        marketPosition: "Strong in mid-market, 15% market share, growth-focused"
                    },
                    {
                        competitor: "Notion",
                        advantages: "All-in-one workspace, good for documentation, flexible structure",
                        disadvantages: "Not specialized for task management, slower performance, learning curve",
                        marketPosition: "Rapidly growing, 12% market share, popular with creators"
                    }
                ],
                pricingStrategy: {
                    recommendations: "Freemium model with paid tiers to maximize user acquisition while monetizing power users",
                    pricing: [
                        { plan: "Free", price: "$0", features: ["Up to 5 projects", "Basic AI suggestions", "Mobile apps"], target: "Individual users" },
                        { plan: "Pro", price: "$12/user/month", features: ["Unlimited projects", "Advanced AI", "Priority support", "Integrations"], target: "Small teams" },
                        { plan: "Business", price: "$24/user/month", features: ["Everything in Pro", "Team analytics", "Advanced permissions", "Custom workflows"], target: "Medium teams" },
                        { plan: "Enterprise", price: "Custom", features: ["Everything in Business", "SSO", "Dedicated support", "SLA"], target: "Large organizations" }
                    ]
                },
                marketOpportunity: "While competitors focus on teams and enterprises, there's a $2.4 billion opportunity in the AI-first individual productivity space, with Taskify Pro positioning as the intelligent alternative for professionals."
            },
            design: {
                designPhilosophy: "Taskify Pro follows a philosophy of 'invisible intelligence' - where AI capabilities feel natural and unobtrusive. The interface is clean, minimal, and intelligent, designed to reduce cognitive load while maximizing productivity. Every UI element is purposefully placed to guide users toward their most important work without creating anxiety or overwhelm. The design language emphasizes clarity, trust, and empowerment, using progressive disclosure to reveal features when needed rather than cluttering the interface with options.",
                
                brandIdentity: {
                    mission: "Empowering professionals to achieve more with less stress through intelligent task management.",
                    personality: "Professional yet approachable, intelligent without being arrogant, efficient without sacrificing humanity",
                    voice: "Supportive, proactive, confident but never pushy. We speak in terms of outcomes and possibilities, never lecturing.",
                    values: ["User autonomy (you control the AI, not the other way around)", "Transparency (we explain why we make suggestions)", "Balance (productivity without burnout)", "Trust (your data is yours, always)"]
                },
                
                colorPalette: {
                    primary: "#6366F1 (Indigo) - Trust, professionalism, focus",
                    secondary: "#8B5CF6 (Purple) - Creativity, innovation, intelligence",
                    accent: "#10B981 (Green) - Success, progress, completion",
                    warning: "#F59E0B (Amber) - Attention, caution, important tasks",
                    error: "#EF4444 (Red) - Urgent, overdue, critical deadlines",
                    background: "#FFFFFF (White) - Clean, fresh start, clarity",
                    surface: "#F9FAFB (Light Gray) - Subtle separation, depth",
                    text: "#1F2937 (Dark Gray) - Readability, professionalism",
                    textSecondary: "#6B7280 (Medium Gray) - Hierarchy, supporting info"
                },
                
                typography: {
                    fontFamily: "Inter, system-ui, sans-serif",
                    heading: "Inter, Bold, 24-32px for major sections, creates clear hierarchy",
                    subheading: "Inter, SemiBold, 18-20px for subsections and card titles",
                    body: "Inter, Regular, 16px for all content text, optimized for readability",
                    caption: "Inter, Medium, 14px for metadata, timestamps, labels",
                    code: "Monaco, 'Courier New', monospace for technical content",
                    lineHeight: "1.8 for body text, 1.4 for headings"
                },
                
                spacingSystem: {
                    base: "4px grid system",
                    small: "8px - internal padding",
                    medium: "16px - component gaps",
                    large: "24px - section spacing",
                    xlarge: "40px - major section breaks"
                },
                
                components: [
                    "Task cards with drag-and-drop reordering and priority indicators",
                    "AI suggestion bubbles that appear contextually with smart animations",
                    "Progress bars with smooth animations showing completion rates",
                    "Timeline view with adjustable zoom levels",
                    "Calendar integration with color-coded task density visualization",
                    "Dashboard widgets that adapt to user productivity patterns",
                    "Smart notifications that respect focus time and meeting schedules",
                    "Search interface with natural language processing",
                    "Filter chips for quick task organization",
                    "Empty states with helpful onboarding tips"
                ],
                
                uiPrinciples: [
                    "Progressive disclosure - show complexity only when needed",
                    "Feedback loops - immediate confirmation for user actions",
                    "Error prevention - suggest solutions before users make mistakes",
                    "Accessibility first - WCAG 2.1 AA compliant throughout",
                    "Mobile-first responsive design",
                    "Gesture support for mobile users",
                    "Keyboard shortcuts for power users"
                ],
                
                designTokens: {
                    borderRadius: "8px for cards, 12px for containers, 20px for modals",
                    shadows: "Subtle elevation system: 0-4-8-16-24px blur with varying opacity",
                    transitions: "200-300ms ease-in-out for interactive elements",
                    gridSystem: "12-column responsive grid with 24px gutters",
                    breakpoints: "Mobile: 320-768px, Tablet: 768-1024px, Desktop: 1024px+"
                },
                
                brandAssets: {
                    logo: "Gradient logo with 'Taskify Pro' wordmark in Inter Bold",
                    colors: "Full color palette documentation available in brand guidelines",
                    icons: "Custom icon set with 150+ icons matching brand aesthetic",
                    illustrations: "Minimalist line art style for onboarding and empty states"
                },
                
                appIcon: {
                    design: "Circular gradient background from indigo (#6366F1) to purple (#8B5CF6) with a stylized checkmark incorporating the letters 'TP'",
                    variations: "Available in standard and rounded-square formats for different platforms"
                }
            },
            diagrams: {
                diagrams: [
                    {
                        name: "System Architecture - Microservices Overview",
                        description: "Complete high-level system architecture showing all microservices, databases, and external integrations",
                        mermaidCode: `graph TB
    A[Web/Mobile/Desktop Clients]
    B[API Gateway with Load Balancer]
    C[Authentication Service]
    D[Task Management Service]
    E[AI Processing Service]
    F[Analytics Service]
    G[Notification Service]
    
    H[(PostgreSQL Primary)]
    I[(PostgreSQL Replica)]
    J[(MongoDB Atlas)]
    K[(Elasticsearch)]
    L[(Redis Cache)]
    
    M[AWS S3 Storage]
    N[RabbitMQ Message Queue]
    
    A --> B
    B --> C
    B --> D
    B --> E
    B --> F
    
    D --> H
    D --> L
    D --> N
    D --> J
    
    E --> L
    E --> I
    E --> K
    
    D --> M
    E --> M
    
    F --> J
    G --> N
    N --> G`
                    },
                    {
                        name: "Complete Task Creation Flow",
                        description: "Detailed user journey from task creation through AI analysis to completion tracking",
                        mermaidCode: `flowchart TD
    A([User Opens Taskify])
    B[Dashboard View]
    C{Click Create Task}
    
    D[User Input Task]
    
    E[AI NLP Processing]
    F[Extract Intent]
    G[Check Work Patterns]
    H[Analyze Workload]
    
    I[AI Suggestions]
    
    J{User Decision}
    
    K[Accept]
    L[Modify]
    M[Reject]
    
    N[Save to Database]
    O[Update Cache]
    P[Schedule Reminders]
    
    Q[Optimize Order]
    R[Show Dashboard]
    S[Send Notifications]
    
    T([Task Created])
    
    A --> B
    B --> C
    C --> D
    D --> E
    E --> F
    F --> G
    G --> H
    H --> I
    I --> J
    J -->|Accept| K
    J -->|Modify| L
    J -->|Reject| M
    K --> N
    L --> N
    M --> N
    N --> O
    O --> P
    P --> Q
    Q --> R
    R --> S
    S --> T`
                    },
                    {
                        name: "Database Schema - Core Entities",
                        description: "Complete database schema showing relationships between users, tasks, projects, and teams",
                        mermaidCode: `erDiagram
    USERS ||--o{ TASKS : creates
    USERS ||--o{ PROJECTS : owns
    USERS ||--o{ TEAMS : member_of
    USERS ||--o{ INTEGRATIONS : uses
    
    PROJECTS ||--o{ TASKS : contains
    PROJECTS }o--|| TEAMS : belongs_to
    
    TASKS }o--o{ TAGS : tagged_with
    TASKS ||--o{ COMMENTS : has
    TASKS ||--o{ TIME_ENTRIES : tracks
    
    TEAMS ||--o{ TEAM_MEMBERS : contains
    TEAM_MEMBERS }o--|| USERS : "is user"
    
    USERS {
        uuid id PK
        string email UK
        string name
        jsonb preferences
        enum subscription_tier
        timestamp created_at
    }
    
    TASKS {
        uuid id PK
        uuid user_id FK
        uuid project_id FK
        string title
        text description
        enum status
        int priority
        timestamp due_date
        int estimated_time
        int actual_time
    }
    
    PROJECTS {
        uuid id PK
        uuid owner_id FK
        string name
        text description
        enum visibility
        boolean archived
    }
    
    TEAMS {
        uuid id PK
        uuid owner_id FK
        string name
        jsonb settings
    }`
                    },
                    {
                        name: "AI Task Prioritization Algorithm",
                        description: "Detailed flow of how AI determines task priority and suggests optimal scheduling",
                        mermaidCode: `flowchart LR
    A[New Task]
    
    B[Analyze Content]
    
    C[Check Workload]
    D[Check Deadlines]
    E[Check Energy]
    F[Check Deps]
    
    G[Score Priority]
    
    H[Assess Time]
    I[Assess Energy]
    J[Assess Urgency]
    
    K[Suggest Schedule]
    
    L[Update Order]
    M[Notify User]
    
    N[Display Dashboard]
    
    A --> B
    B --> C
    C --> D
    D --> E
    E --> F
    F --> G
    
    G --> H
    G --> I
    G --> J
    
    H --> K
    I --> K
    J --> K
    
    K --> L
    L --> M
    M --> N`
                    },
                    {
                        name: "Real-time Collaboration Flow",
                        description: "How multiple users collaborate on tasks with real-time sync and conflict resolution",
                        mermaidCode: `sequenceDiagram
    participant U1 as User1
    participant U2 as User2
    participant GW as Gateway
    participant TS as TaskService
    participant DB as Database
    participant RD as Redis
    
    U1->>GW: Update Task
    GW->>TS: Process
    TS->>DB: Save
    TS->>RD: Publish
    RD-->>U1: ACK
    RD-->>U2: Update
    
    U2->>GW: Update Task
    GW->>TS: Process
    TS->>DB: Check Lock
    DB-->>TS: Conflict
    
    TS->>U2: Request Merge
    U2-->>GW: Merge
    GW->>TS: Save
    TS->>DB: Final Save
    TS->>RD: Broadcast
    
    RD-->>U1: Final
    RD-->>U2: Final`
                    }
                ]
            },
            charts: {
                marketGrowth: {
                    title: "Task Management Software Market Growth (2024-2030)",
                    data: [6.76, 7.85, 9.12, 10.64, 12.41, 13.45, 14.6]
                },
                competitorComparison: {
                    title: "Market Share Comparison",
                    data: { "Asana": 20, "Monday.com": 15, "Notion": 12, "Other": 53 }
                },
                userSegmentation: {
                    title: "Target User Segments",
                    data: { "Individual Professionals": 45, "Small Teams": 30, "Mid-market": 20, "Enterprise": 5 }
                },
                searchTrends: {
                    title: "Google Trends - Task Management Keywords (Last 6 Months)",
                    data: {
                        labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun"],
                        datasets: [
                            {
                                label: "Task Management",
                                data: [85, 92, 88, 95, 100, 98],
                                borderColor: '#6366F1',
                                backgroundColor: 'rgba(99, 102, 241, 0.1)'
                            },
                            {
                                label: "Productivity Tools",
                                data: [72, 78, 82, 88, 92, 95],
                                borderColor: '#10B981',
                                backgroundColor: 'rgba(16, 185, 129, 0.1)'
                            },
                            {
                                label: "To-Do List Apps",
                                data: [95, 88, 90, 85, 92, 96],
                                borderColor: '#8B5CF6',
                                backgroundColor: 'rgba(139, 92, 246, 0.1)'
                            },
                            {
                                label: "Project Management",
                                data: [78, 85, 91, 88, 95, 100],
                                borderColor: '#F59E0B',
                                backgroundColor: 'rgba(245, 158, 11, 0.1)'
                            }
                        ]
                    }
                },
                keywordDemand: {
                    title: "Search Volume Trends - Productivity Keywords",
                    keywords: [
                        { term: "task management software", searches: 135000 },
                        { term: "productivity apps", searches: 246000 },
                        { term: "ai task assistant", searches: 189000 },
                        { term: "smart to-do app", searches: 167000 },
                        { term: "team task tracking", searches: 112000 }
                    ]
                }
            }
        };

        // Initialize chat variables
        let chatThreadId = null;
        let chatAssistantId = null;
        let chatInitialized = false;
        let chatHistory = [];

        // Load Spec - using hardcoded demo data
        async function loadSpec() {
            try {
                const data = demoSpecData;
                
                // Display Overview
                document.getElementById('overview').innerHTML = formatOverview(data.overview);
                
                // Display Technical
                document.getElementById('technical').innerHTML = formatTechnical(data.technical);
                
                // Display Market Research
                document.getElementById('market').innerHTML = formatMarket(data.market);
                
                // Initialize charts after a short delay
                setTimeout(() => {
                    initializeCharts(data.market.charts);
                }, 500);
                
                // Display Design
                document.getElementById('design').innerHTML = formatDesign(data.design);
                
                // Display Diagrams
                if (data.diagrams && data.diagrams.diagrams) {
                    let diagramsHtml = '';
                    data.diagrams.diagrams.forEach((diagram, index) => {
                        diagramsHtml += `<div class="diagram-item" style="margin-bottom: 40px;">`;
                        diagramsHtml += `<h3><i class="fa fa-project-diagram"></i> ${diagram.name}</h3>`;
                        if (diagram.description) {
                            diagramsHtml += `<p style="color: #666; margin-bottom: 20px;">${diagram.description}</p>`;
                        }
                        diagramsHtml += `<div style="border: 1px solid #e0e0e0; border-radius: 8px; padding: 30px; background: #fafafa;">`;
                        diagramsHtml += `<div class="mermaid" id="diagram-${index}">${diagram.mermaidCode}</div>`;
                        diagramsHtml += `</div></div>`;
                    });
                    document.getElementById('diagrams').innerHTML = diagramsHtml;
                    
                    // Initialize Mermaid for diagrams with proper configuration
                    setTimeout(() => {
                        try {
                            mermaid.initialize({ 
                                startOnLoad: false,
                                theme: 'default',
                                securityLevel: 'loose',
                                themeVariables: { primaryColor: '#6366F1' }
                            });
                            mermaid.init(undefined, document.querySelectorAll('#diagrams .mermaid'));
                        } catch (error) {
                            console.error('Mermaid initialization error:', error);
                        }
                    }, 300);
                }
                
                // Initialize chat UI
                initializeChatUI();
                
                // Re-initialize Mermaid when switching back to diagrams tab
                document.querySelectorAll('.spec-tab').forEach(tab => {
                    tab.addEventListener('click', function() {
                        const targetTab = this.getAttribute('data-tab');
                        if (targetTab === 'diagrams') {
                            setTimeout(() => {
                                mermaid.init(undefined, document.querySelectorAll('#diagrams .mermaid'));
                            }, 100);
                        }
                    });
                });
                
            } catch (error) {
                console.error('Error loading spec:', error);
                document.querySelector('.spec-content.active').innerHTML = 
                    '<div class="loading-content"><i class="fas fa-exclamation-triangle"></i> Error: ' + error.message + '</div>';
            }
        }

        // Custom format functions for demo spec
        function formatOverview(data) {
            let html = '';
            
            // Application Summary
            if (data.applicationSummary && data.applicationSummary.paragraphs) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-clipboard"></i> Application Summary</h3>';
                data.applicationSummary.paragraphs.forEach(p => {
                    html += `<p>${p}</p>`;
                });
                html += '</div>';
            }
            
            // Core Features
            if (data.coreFeatures && Array.isArray(data.coreFeatures)) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-star"></i> Core Features</h3>';
                html += '<ul>';
                data.coreFeatures.forEach(feature => {
                    html += `<li>${feature}</li>`;
                });
                html += '</ul>';
                html += '</div>';
            }
            
            // Unique Value Proposition
            if (data.uniqueValueProposition) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-lightbulb-o"></i> Unique Value Proposition</h3>';
                html += `<p>${data.uniqueValueProposition}</p>`;
                html += '</div>';
            }
            
            // Target Audience
            if (data.targetAudience) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-users"></i> Target Audience</h3>';
                if (data.targetAudience.primary) {
                    html += `<p><strong>Primary Users:</strong> ${data.targetAudience.primary}</p>`;
                }
                if (data.targetAudience.characteristics) {
                    html += `<p><strong>Characteristics:</strong> ${data.targetAudience.characteristics}</p>`;
                }
                if (data.targetAudience.painPoints) {
                    html += `<p><strong>Pain Points:</strong> ${data.targetAudience.painPoints}</p>`;
                }
                html += '</div>';
            }
            
            // Problem Statement
            if (data.problemStatement) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-exclamation-triangle"></i> Problem Statement</h3>';
                html += `<p style="font-size: 18px; line-height: 1.8; color: #DC2626;">${data.problemStatement}</p>`;
                html += '</div>';
            }
            
            // Business Model
            if (data.businessModel) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-building"></i> Business Model</h3>';
                html += `<p style="font-size: 18px; line-height: 1.8;">${data.businessModel}</p>`;
                html += '</div>';
            }
            
            // Competitive Advantage
            if (data.competitiveAdvantage) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-trophy"></i> Competitive Advantage</h3>';
                html += `<p style="font-size: 18px; line-height: 1.8;">${data.competitiveAdvantage}</p>`;
                html += '</div>';
            }
            
            // Success Metrics
            if (data.successMetrics) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-bar-chart"></i> Success Metrics</h3>';
                
                if (data.successMetrics.userEngagement) {
                    html += '<div style="background: linear-gradient(135deg, #EEF2FF 0%, #E0E7FF 100%); padding: 20px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #6366F1;">';
                    html += '<h4><i class="fa fa-users" style="color: #6366F1; margin-right: 10px;"></i>User Engagement</h4>';
                    html += `<p style="font-size: 16px;">${data.successMetrics.userEngagement}</p>`;
                    html += '</div>';
                }
                
                if (data.successMetrics.productivityImprovement) {
                    html += '<div style="background: linear-gradient(135deg, #ECFDF5 0%, #D1FAE5 100%); padding: 20px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #10B981;">';
                    html += '<h4><i class="fa fa-line-chart" style="color: #10B981; margin-right: 10px;"></i>Productivity Improvement</h4>';
                    html += `<p style="font-size: 16px;">${data.successMetrics.productivityImprovement}</p>`;
                    html += '</div>';
                }
                
                if (data.successMetrics.businessMetrics) {
                    html += '<div style="background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%); padding: 20px; border-radius: 10px; border-left: 4px solid #F59E0B;">';
                    html += '<h4><i class="fa fa-dollar-sign" style="color: #F59E0B; margin-right: 10px;"></i>Business Metrics</h4>';
                    html += `<p style="font-size: 16px;">${data.successMetrics.businessMetrics}</p>`;
                    html += '</div>';
                }
                
                html += '</div>';
            }
            
            return html;
        }
        
        function formatTechnical(data) {
            let html = '';
            
            // Tech Stack
            if (data.techStack) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-wrench"></i> Technology Stack</h3>';
                
                // Iterate through each category (frontend, backend, database, etc.)
                for (let category in data.techStack) {
                    const categoryData = data.techStack[category];
                    
                    // Check if it's the new nested structure
                    if (typeof categoryData === 'object' && !Array.isArray(categoryData)) {
                        html += `<h4 style="margin-top: 25px; margin-bottom: 15px; color: #6366F1; font-size: 20px;"><i class="fa fa-folder-open"></i> ${category.charAt(0).toUpperCase() + category.slice(1).replace(/([A-Z])/g, ' $1')}</h4>`;
                        html += '<ul>';
                        for (let item in categoryData) {
                            html += `<li style="margin-bottom: 10px;"><strong>${item.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase())}:</strong> ${categoryData[item]}</li>`;
                        }
                        html += '</ul>';
                    } else {
                        // Fallback for old structure
                        html += `<li><strong>${category.charAt(0).toUpperCase() + category.slice(1)}:</strong> ${categoryData}</li>`;
                    }
                }
                
                html += '</div>';
            }
            
            // Architecture Overview
            if (data.architectureOverview) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-building"></i> Architecture Overview</h3>';
                html += `<p>${data.architectureOverview}</p>`;
                html += '</div>';
            }
            
            // Database Schema
            if (data.databaseSchema) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-database"></i> Database Schema</h3>';
                if (data.databaseSchema.description) {
                    html += `<p>${data.databaseSchema.description}</p>`;
                }
                if (data.databaseSchema.tables && Array.isArray(data.databaseSchema.tables)) {
                    html += '<h4>Database Tables:</h4>';
                    html += '<ul>';
                    data.databaseSchema.tables.forEach(table => {
                        if (typeof table === 'object' && table.name) {
                            html += `<li><strong>${table.name}:</strong> ${table.columns ? table.columns.join(', ') : 'No columns specified'}</li>`;
                        } else {
                            html += `<li>${table}</li>`;
                        }
                    });
                    html += '</ul>';
                }
                html += '</div>';
            }
            
            // API Endpoints
            if (data.apiEndpoints && Array.isArray(data.apiEndpoints)) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-plug"></i> API Endpoints</h3>';
                html += '<ul>';
                data.apiEndpoints.forEach(endpoint => {
                    html += `<li><strong>${endpoint.method}</strong> <code>${endpoint.path}</code> - ${endpoint.description}</li>`;
                });
                html += '</ul>';
                html += '</div>';
            }
            
            return html;
        }
        
        function formatMarket(data) {
            let html = '';
            
            // Market Size with Stats
            if (data.marketSize) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-line-chart"></i> Market Opportunity</h3>';
                html += `<p style="font-size: 18px; line-height: 1.8;">${data.marketSize}</p>`;
                
                // Add stat cards
                html += '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 25px 0;">';
                html += '<div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">';
                html += '<h4>Market Size 2024</h4><div class="stat-value">$6.76B</div></div>';
                html += '<div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">';
                html += '<h4>Projected 2030</h4><div class="stat-value">$14.6B</div></div>';
                html += '<div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">';
                html += '<h4>CAGR Growth</h4><div class="stat-value">14.2%</div></div>';
                html += '</div>';
                
                html += '</div>';
            }
            
            // Market Trends
            if (data.marketTrends && Array.isArray(data.marketTrends)) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-trending-up"></i> Market Trends</h3>';
                html += '<ul>';
                data.marketTrends.forEach(trend => {
                    html += `<li style="font-size: 16px; margin-bottom: 15px;">${trend}</li>`;
                });
                html += '</ul>';
                html += '</div>';
            }
            
            // Target Customers
            if (data.targetCustomers) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-bullseye"></i> Target Market</h3>';
                html += `<p style="font-size: 18px; line-height: 1.8;">${data.targetCustomers}</p>`;
                html += '</div>';
            }
            
            // Market Growth Chart
            if (data.charts && data.charts.marketGrowth) {
                html += '<div class="content-section">';
                html += `<h3><i class="fa fa-area-chart"></i> ${data.charts.marketGrowth.title}</h3>`;
                html += '<div class="chart-container"><canvas id="marketGrowthChart"></canvas></div>';
                html += '</div>';
            }
            
            // Search Trends Chart
            if (data.charts && data.charts.searchTrends) {
                html += '<div class="content-section">';
                html += `<h3><i class="fa fa-trending-up"></i> ${data.charts.searchTrends.title}</h3>`;
                html += '<div class="chart-container"><canvas id="searchTrendsChart"></canvas></div>';
                html += '<p style="color: #666; font-size: 14px; margin-top: 15px;"><i class="fa fa-info-circle"></i> Data shows relative search interest over time. Values are normalized to 0-100 scale where 100 represents peak popularity.</p>';
                html += '</div>';
            }
            
            // Keyword Demand
            if (data.charts && data.charts.keywordDemand) {
                html += '<div class="content-section">';
                html += `<h3><i class="fa fa-search"></i> ${data.charts.keywordDemand.title}</h3>`;
                html += '<div class="chart-container"><canvas id="keywordDemandChart"></canvas></div>';
                html += '<p style="color: #666; font-size: 14px; margin-top: 15px;"><i class="fa fa-info-circle"></i> Monthly search volume estimates based on Google Keyword Planner data.</p>';
                html += '</div>';
            }
            
            // Competitive Landscape
            if (data.competitiveLandscape && Array.isArray(data.competitiveLandscape)) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-bar-chart"></i> Competitive Analysis</h3>';
                
                data.competitiveLandscape.forEach(competitor => {
                    html += '<div style="margin-bottom: 30px; padding: 20px; background: #f9f9f9; border-radius: 8px; border-left: 4px solid #6366F1;">';
                    html += `<h4 style="color: #333; margin-bottom: 15px;">${competitor.competitor}</h4>`;
                    html += `<p><strong style="color: #10B981;">Advantages:</strong> ${competitor.advantages}</p>`;
                    html += `<p><strong style="color: #EF4444;">Disadvantages:</strong> ${competitor.disadvantages}</p>`;
                    html += `<p><strong>Market Position:</strong> ${competitor.marketPosition}</p>`;
                    html += '</div>';
                });
                
                html += '</div>';
            }
            
            // Pricing Strategy
            if (data.pricingStrategy && data.pricingStrategy.pricing) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-dollar-sign"></i> Pricing Strategy</h3>';
                if (data.pricingStrategy.recommendations) {
                    html += `<p>${data.pricingStrategy.recommendations}</p>`;
                }
                
                html += '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 20px;">';
                data.pricingStrategy.pricing.forEach(plan => {
                    html += '<div style="border: 2px solid #e0e0e0; border-radius: 12px; padding: 25px; background: white; display: flex; flex-direction: column; min-height: 400px;">';
                    html += `<h4 style="margin-bottom: 10px; color: #333; font-size: 20px;">${plan.plan}</h4>`;
                    html += `<div style="font-size: 32px; font-weight: bold; color: #6366F1; margin-bottom: 20px; word-break: break-word;">${plan.price}</div>`;
                    html += '<ul style="list-style: none; padding: 0; margin: 15px 0; flex: 1;">';
                    plan.features.forEach(feature => {
                        html += `<li style="margin-bottom: 10px; font-size: 14px; line-height: 1.5;"><i class="fa fa-check" style="color: #10B981; margin-right: 8px;"></i><span style="word-wrap: break-word;">${feature}</span></li>`;
                    });
                    html += '</ul>';
                    html += `<p style="color: #666; font-size: 14px; margin-top: auto;"><strong>Target:</strong> ${plan.target}</p>`;
                    html += '</div>';
                });
                html += '</div>';
                html += '</div>';
            }
            
            // Market Opportunity
            if (data.marketOpportunity) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-chart-line"></i> Market Opportunity</h3>';
                html += `<p>${data.marketOpportunity}</p>`;
                html += '</div>';
            }
            
            return html;
        }
        
        function formatDesign(data) {
            let html = '';
            
            // Design Philosophy
            if (data.designPhilosophy) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-paint-brush"></i> Design Philosophy</h3>';
                html += `<p style="font-size: 18px; line-height: 1.8;">${data.designPhilosophy}</p>`;
                html += '</div>';
            }
            
            // Brand Identity
            if (data.brandIdentity) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-lightbulb-o"></i> Brand Identity</h3>';
                
                if (data.brandIdentity.mission) {
                    html += `<h4>Mission</h4>`;
                    html += `<p>${data.brandIdentity.mission}</p>`;
                }
                
                if (data.brandIdentity.personality) {
                    html += `<h4>Personality</h4>`;
                    html += `<p>${data.brandIdentity.personality}</p>`;
                }
                
                if (data.brandIdentity.voice) {
                    html += `<h4>Brand Voice</h4>`;
                    html += `<p>${data.brandIdentity.voice}</p>`;
                }
                
                if (data.brandIdentity.values && Array.isArray(data.brandIdentity.values)) {
                    html += '<h4>Core Values</h4>';
                    html += '<ul>';
                    data.brandIdentity.values.forEach(value => {
                        html += `<li style="font-size: 16px; margin-bottom: 10px;">${value}</li>`;
                    });
                    html += '</ul>';
                }
                
                html += '</div>';
            }
            
            // App Icon Mockup
            if (data.appIcon) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-mobile"></i> App Icon Design</h3>';
                html += '<div style="display: flex; gap: 30px; align-items: center; flex-wrap: wrap;">';
                html += '<div style="text-align: center;">';
                html += '<div style="width: 120px; height: 120px; border-radius: 25px; background: linear-gradient(135deg, #6366F1 0%, #8B5CF6 100%); display: flex; align-items: center; justify-content: center; font-size: 48px; font-weight: bold; color: white; box-shadow: 0 8px 24px rgba(99, 102, 241, 0.4);">TP</div>';
                html += '<p style="margin-top: 15px; font-weight: 600;">iOS App Icon</p>';
                html += '</div>';
                html += '<div style="text-align: center;">';
                html += '<div style="width: 120px; height: 120px; border-radius: 20px; background: linear-gradient(135deg, #6366F1 0%, #8B5CF6 100%); display: flex; align-items: center; justify-content: center; font-size: 48px; font-weight: bold; color: white; box-shadow: 0 8px 24px rgba(99, 102, 241, 0.4);">TP</div>';
                html += '<p style="margin-top: 15px; font-weight: 600;">Android App Icon</p>';
                html += '</div>';
                if (data.appIcon.design) {
                    html += '<div style="flex: 1; padding: 20px;">';
                    html += `<p>${data.appIcon.design}</p>`;
                    html += '</div>';
                }
                html += '</div>';
                html += '</div>';
            }
            
            // Color Palette
            if (data.colorPalette) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-palette"></i> Color Palette</h3>';
                html += '<div class="feature-grid">';
                for (let key in data.colorPalette) {
                    const value = data.colorPalette[key];
                    // Extract color code (everything before the first space)
                    const colorMatch = value.match(/^#?[0-9A-Fa-f]{6}/);
                    const color = colorMatch ? colorMatch[0] : '#6366F1';
                    
                    // Extract description (everything after the dash)
                    const dashIndex = value.indexOf(' - ');
                    const description = dashIndex > 0 ? value.substring(dashIndex + 3) : '';
                    
                    html += '<div style="background: white; padding: 20px; border-radius: 10px; border: 2px solid #e0e0e0; text-align: center;">';
                    html += `<div style="width: 60px; height: 60px; border-radius: 12px; background: ${color}; margin: 0 auto 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);"></div>`;
                    html += `<div style="font-weight: 600; margin-bottom: 5px;">${key.charAt(0).toUpperCase() + key.slice(1)}</div>`;
                    html += `<div style="color: #666; font-size: 14px;">${color}</div>`;
                    if (description) {
                        html += `<div style="color: #888; font-size: 13px; margin-top: 5px;">${description}</div>`;
                    }
                    html += '</div>';
                }
                html += '</div>';
                html += '</div>';
            }
            
            // Typography
            if (data.typography) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-font"></i> Typography System</h3>';
                html += '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">';
                for (let key in data.typography) {
                    html += '<div style="background: #f9f9f9; padding: 20px; border-radius: 10px; border-left: 4px solid #6366F1;">';
                    html += `<h4 style="margin-bottom: 10px;">${key.charAt(0).toUpperCase() + key.slice(1)}</h4>`;
                    html += `<p>${data.typography[key]}</p>`;
                    html += '</div>';
                }
                html += '</div>';
                html += '</div>';
            }
            
            // Spacing System
            if (data.spacingSystem) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-ruler"></i> Spacing System</h3>';
                html += '<ul>';
                for (let key in data.spacingSystem) {
                    html += `<li style="font-size: 16px; margin-bottom: 10px;"><strong>${key}:</strong> ${data.spacingSystem[key]}</li>`;
                }
                html += '</ul>';
                html += '</div>';
            }
            
            // UI Components
            if (data.components && Array.isArray(data.components)) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-cubes"></i> UI Components</h3>';
                html += '<div class="feature-grid">';
                data.components.forEach(component => {
                    html += '<div class="feature-card">';
                    html += '<i class="fa fa-check" style="color: #10B981; margin-right: 10px; font-size: 18px;"></i>';
                    html += `<span style="font-size: 16px;">${component}</span>`;
                    html += '</div>';
                });
                html += '</div>';
                html += '</div>';
            }
            
            // UI Principles
            if (data.uiPrinciples && Array.isArray(data.uiPrinciples)) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-gavel"></i> UI Design Principles</h3>';
                html += '<ul>';
                data.uiPrinciples.forEach(principle => {
                    html += `<li style="font-size: 16px; margin-bottom: 10px;">${principle}</li>`;
                });
                html += '</ul>';
                html += '</div>';
            }
            
            // Design Tokens
            if (data.designTokens) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-code"></i> Design Tokens</h3>';
                html += '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;">';
                for (let key in data.designTokens) {
                    html += '<div style="background: linear-gradient(135deg, #EEF2FF 0%, #E0E7FF 100%); padding: 20px; border-radius: 10px; border-left: 4px solid #6366F1;">';
                    html += `<div style="font-weight: 600; margin-bottom: 8px; color: #4338CA;">${key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase())}</div>`;
                    html += `<div style="color: #6B7280; font-size: 15px;">${data.designTokens[key]}</div>`;
                    html += '</div>';
                }
                html += '</div>';
                html += '</div>';
            }
            
            // Brand Assets
            if (data.brandAssets) {
                html += '<div class="content-section">';
                html += '<h3><i class="fa fa-diamond"></i> Brand Assets</h3>';
                html += '<div class="feature-grid">';
                for (let key in data.brandAssets) {
                    html += '<div class="feature-card">';
                    html += `<i class="fa fa-file-image-o" style="color: #6366F1; margin-right: 10px; font-size: 20px;"></i>`;
                    html += `<div><strong>${key.charAt(0).toUpperCase() + key.slice(1)}:</strong> ${data.brandAssets[key]}</div>`;
                    html += '</div>';
                }
                html += '</div>';
                html += '</div>';
            }
            
            // App Preview Mockup
            html += '<div class="content-section">';
            html += '<h3><i class="fa fa-mobile-alt"></i> Interface Mockups</h3>';
            
            // Mobile Mockups
            html += '<div style="margin-bottom: 40px;">';
            html += '<h4 style="margin-bottom: 20px;">Mobile Application</h4>';
            html += '<div style="background: #f5f5f5; padding: 40px; border-radius: 20px; display: flex; justify-content: center; gap: 30px; flex-wrap: wrap;">';
            
            // Dashboard Mockup
            html += '<div style="text-align: center;">';
            html += '<div style="background: white; border-radius: 20px; padding: 15px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); display: inline-block;">';
            html += '<div style="width: 280px; height: 600px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 15px; position: relative; overflow: hidden;">';
            html += '<div style="position: absolute; top: 0; left: 0; right: 0; height: 60px; background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); padding: 20px; display: flex; align-items: center; justify-content: space-between;">';
            html += '<div style="font-size: 18px; font-weight: bold; color: white;">Taskify</div>';
            html += '<div style="width: 30px; height: 30px; border-radius: 50%; background: rgba(255,255,255,0.3); display: flex; align-items: center; justify-content: center;">';
            html += '<i class="fa fa-user" style="color: white;"></i>';
            html += '</div></div>';
            html += '<div style="padding: 80px 20px 20px; color: white;">';
            html += '<div style="text-align: center; margin-bottom: 30px;">';
            html += '<div style="font-size: 14px; opacity: 0.9; margin-bottom: 5px;">Good Morning!</div>';
            html += '<div style="font-size: 32px; font-weight: bold;">8 Tasks</div>';
            html += '<div style="font-size: 14px; opacity: 0.8;">4 due today</div>';
            html += '</div>';
            html += '<div style="margin-bottom: 15px; padding: 15px; background: rgba(255,255,255,0.2); border-radius: 10px; backdrop-filter: blur(5px);">';
            html += '<div style="display: flex; justify-content: space-between; margin-bottom: 5px;">';
            html += '<div style="font-weight: 600;">📧 Follow up with client</div>';
            html += '<div style="background: #10B981; width: 20px; height: 20px; border-radius: 4px; display: inline-flex; align-items: center; justify-content: center;">';
            html += '<i class="fa fa-check" style="color: white; font-size: 10px;"></i>';
            html += '</div></div>';
            html += '<div style="font-size: 12px; opacity: 0.7;">Tomorrow 2pm</div>';
            html += '</div>';
            html += '<div style="margin-bottom: 15px; padding: 15px; background: rgba(255,255,255,0.2); border-radius: 10px; backdrop-filter: blur(5px);">';
            html += '<div style="display: flex; justify-content: space-between; margin-bottom: 5px;">';
            html += '<div style="font-weight: 600;">📄 Review proposal</div>';
            html += '<div style="background: #F59E0B; width: 20px; height: 20px; border-radius: 4px; display: inline-flex; align-items: center; justify-content: center;">';
            html += '<span style="color: white; font-size: 12px; font-weight: bold;">!</span>';
            html += '</div></div>';
            html += '<div style="font-size: 12px; opacity: 0.7;">High Priority</div>';
            html += '</div>';
            html += '<div style="margin-bottom: 15px; padding: 15px; background: rgba(255,255,255,0.2); border-radius: 10px; backdrop-filter: blur(5px);">';
            html += '<div style="font-weight: 600; margin-bottom: 5px;">👥 Team standup</div>';
            html += '<div style="font-size: 12px; opacity: 0.7;">Today 10am</div>';
            html += '</div>';
            html += '</div></div></div>';
            html += '<p style="margin-top: 15px; font-weight: 600;">Dashboard View</p>';
            html += '</div>';
            
            // Task Details Mockup
            html += '<div style="text-align: center;">';
            html += '<div style="background: white; border-radius: 20px; padding: 15px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); display: inline-block;">';
            html += '<div style="width: 280px; height: 600px; background: white; border-radius: 15px; position: relative; overflow: hidden;">';
            html += '<div style="padding: 20px; background: linear-gradient(135deg, #6366F1 0%, #8B5CF6 100%); color: white;">';
            html += '<div style="display: flex; justify-content: space-between; margin-bottom: 20px;">';
            html += '<i class="fa fa-arrow-left" style="font-size: 18px;"></i>';
            html += '<div style="font-weight: 600;">Task Details</div>';
            html += '<i class="fa fa-edit" style="font-size: 16px;"></i>';
            html += '</div>';
            html += '<div style="font-size: 12px; opacity: 0.9; margin-bottom: 5px;">Priority: High</div>';
            html += '</div>';
            html += '<div style="padding: 20px;">';
            html += '<div style="font-size: 20px; font-weight: bold; margin-bottom: 15px; color: #1F2937;">Review Project Proposal</div>';
            html += '<div style="display: flex; align-items: center; margin-bottom: 20px; padding: 12px; background: #F9FAFB; border-radius: 10px;">';
            html += '<i class="fa fa-calendar" style="color: #6366F1; margin-right: 10px;"></i>';
            html += '<div><div style="font-weight: 600;">Due Today</div><div style="font-size: 14px; color: #6B7280;">March 15, 2025</div></div>';
            html += '</div>';
            html += '<div style="margin-bottom: 20px;">';
            html += '<div style="font-weight: 600; margin-bottom: 10px; color: #374151;">Description</div>';
            html += '<div style="color: #6B7280; line-height: 1.6;">Review the Q1 2025 budget proposal and provide feedback to finance team. Focus on marketing and engineering allocations.</div>';
            html += '</div>';
            html += '<div style="margin-bottom: 20px;">';
            html += '<div style="font-weight: 600; margin-bottom: 10px; color: #374151;">AI Suggestions</div>';
            html += '<div style="padding: 12px; background: #EEF2FF; border-left: 4px solid #6366F1; border-radius: 8px;">';
            html += '<i class="fa fa-magic" style="color: #6366F1; margin-right: 8px;"></i>';
            html += '<span style="color: #4338CA;">Suggested time: 45 minutes based on similar tasks</span>';
            html += '</div>';
            html += '</div>';
            html += '<div style="display: flex; gap: 10px; margin-top: auto; padding: 20px;">';
            html += '<button style="flex: 1; padding: 12px; background: #6366F1; color: white; border: none; border-radius: 10px; font-weight: 600;">Complete</button>';
            html += '<button style="width: 48px; padding: 12px; background: #F3F4F6; border: none; border-radius: 10px;"><i class="fa fa-flag"></i></button>';
            html += '</div>';
            html += '</div></div></div>';
            html += '<p style="margin-top: 15px; font-weight: 600;">Task Details View</p>';
            html += '</div>';
            
            html += '</div></div>';
            
            // Desktop Mockup
            html += '<div style="margin-top: 40px;">';
            html += '<h4 style="margin-bottom: 20px;">Desktop Application</h4>';
            html += '<div style="background: white; border-radius: 15px; padding: 30px; box-shadow: 0 4px 20px rgba(0,0,0,0.1);">';
            html += '<div style="width: 100%; max-width: 900px; margin: 0 auto; background: white; border-radius: 10px; overflow: hidden; border: 1px solid #e5e7eb;">';
            html += '<div style="background: #F9FAFB; padding: 15px; border-bottom: 1px solid #e5e7eb; display: flex; justify-content: space-between; align-items: center;">';
            html += '<div style="display: flex; align-items: center; gap: 20px;">';
            html += '<div style="width: 35px; height: 35px; border-radius: 8px; background: linear-gradient(135deg, #6366F1 0%, #8B5CF6 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">TP</div>';
            html += '<div style="font-weight: 600; font-size: 16px;">Taskify Pro</div>';
            html += '</div>';
            html += '<div style="display: flex; gap: 10px;">';
            html += '<span style="padding: 6px 12px; background: #EEF2FF; color: #6366F1; border-radius: 20px; font-size: 13px;"><i class="fa fa-signal"></i> My Tasks</span>';
            html += '<span style="padding: 6px 12px; background: white; color: #6B7280; border-radius: 20px; font-size: 13px;"><i class="fa fa-users"></i> Team</span>';
            html += '<span style="padding: 6px 12px; background: white; color: #6B7280; border-radius: 20px; font-size: 13px;"><i class="fa fa-chart-line"></i> Analytics</span>';
            html += '</div></div>';
            html += '<div style="display: flex; height: 500px;">';
            html += '<div style="width: 300px; border-right: 1px solid #e5e7eb; padding: 20px; background: #FAFAFA;">';
            html += '<div style="margin-bottom: 20px;">';
            html += '<div style="font-weight: 600; margin-bottom: 10px; color: #374151;">Filters</div>';
            html += '<div style="display: flex; gap: 5px; flex-wrap: wrap;">';
            html += '<span style="padding: 4px 10px; background: white; border: 1px solid #6366F1; color: #6366F1; border-radius: 15px; font-size: 12px;">Today</span>';
            html += '<span style="padding: 4px 10px; background: white; border: 1px solid #e5e7eb; color: #6B7280; border-radius: 15px; font-size: 12px;">This Week</span>';
            html += '<span style="padding: 4px 10px; background: white; border: 1px solid #e5e7eb; color: #6B7280; border-radius: 15px; font-size: 12px;">All Tasks</span>';
            html += '</div></div>';
            html += '<div>';
            html += '<div style="font-weight: 600; margin-bottom: 10px; color: #374151;">Categories</div>';
            html += '<div style="display: flex; flex-direction: column; gap: 8px;">';
            html += '<div style="padding: 10px; background: white; border-radius: 8px;"><i class="fa fa-inbox" style="color: #6366F1; margin-right: 10px;"></i>Inbox</div>';
            html += '<div style="padding: 10px; background: white; border-radius: 8px;"><i class="fa fa-star" style="color: #F59E0B; margin-right: 10px;"></i>Important</div>';
            html += '<div style="padding: 10px; background: white; border-radius: 8px;"><i class="fa fa-check-circle" style="color: #10B981; margin-right: 10px;"></i>Completed</div>';
            html += '</div></div></div>';
            html += '<div style="flex: 1; padding: 30px; overflow-y: auto;">';
            html += '<div style="margin-bottom: 20px;">';
            html += '<h3 style="font-size: 24px; font-weight: bold; margin-bottom: 5px; color: #1F2937;">My Tasks</h3>';
            html += '<p style="color: #6B7280;">8 tasks · 4 due today</p>';
            html += '</div>';
            html += '<div style="display: flex; flex-direction: column; gap: 15px;">';
            for (let i = 0; i < 3; i++) {
                html += '<div style="padding: 20px; background: white; border: 2px solid #e5e7eb; border-radius: 12px; display: flex; justify-content: space-between; align-items: center;">';
                html += '<div style="display: flex; gap: 15px; flex: 1;">';
                html += '<input type="checkbox" style="width: 20px; height: 20px; cursor: pointer;">';
                html += '<div>';
                html += '<div style="font-weight: 600; margin-bottom: 5px; color: #1F2937;">Task Title Example</div>';
                html += '<div style="font-size: 14px; color: #6B7280;"><i class="fa fa-clock-o" style="margin-right: 5px;"></i>Due Today · Project Alpha</div>';
                html += '</div></div>';
                html += '<div style="display: flex; gap: 5px;">';
                html += '<span style="padding: 4px 10px; background: #FEF3C7; color: #F59E0B; border-radius: 20px; font-size: 12px; font-weight: 600;">High</span>';
                html += '<i class="fa fa-ellipsis-v" style="color: #9CA3AF;"></i>';
                html += '</div></div>';
            }
            html += '</div></div></div></div>';
            html += '</div></div>';
            
            html += '</div>';
            html += '</div>';
            
            return html;
        }
        
        // Initialize Charts
        function initializeCharts(charts) {
            if (!charts) return;
            
            // Market Growth Chart
            if (charts.marketGrowth) {
                const ctx = document.getElementById('marketGrowthChart');
                if (ctx) {
                    new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: ['2024', '2025', '2026', '2027', '2028', '2029', '2030'],
                            datasets: [{
                                label: 'Market Size (Billions $)',
                                data: charts.marketGrowth.data,
                                borderColor: '#6366F1',
                                backgroundColor: 'rgba(99, 102, 241, 0.1)',
                                tension: 0.4,
                                fill: true,
                                pointRadius: 6,
                                pointHoverRadius: 8
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: true,
                            plugins: {
                                legend: { display: true },
                                title: { display: false }
                            },
                            scales: {
                                y: {
                                    beginAtZero: false,
                                    title: { display: true, text: 'Billions USD', font: { size: 14 } }
                                }
                            }
                        }
                    });
                }
            }
            
            // Search Trends Chart - Multi-line showing different keywords
            if (charts.searchTrends && charts.searchTrends.data) {
                const ctx = document.getElementById('searchTrendsChart');
                if (ctx) {
                    new Chart(ctx, {
                        type: 'line',
                        data: charts.searchTrends.data,
                        options: {
                            responsive: true,
                            maintainAspectRatio: true,
                            plugins: {
                                legend: { display: true, position: 'top' },
                                title: { display: false }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    max: 100,
                                    title: { 
                                        display: true, 
                                        text: 'Search Interest (0-100)', 
                                        font: { size: 14 }
                                    }
                                }
                            },
                            interaction: {
                                intersect: false,
                                mode: 'index'
                            }
                        }
                    });
                }
            }
            
            // Keyword Demand Bar Chart
            if (charts.keywordDemand && charts.keywordDemand.keywords) {
                const ctx = document.getElementById('keywordDemandChart');
                if (ctx) {
                    const labels = charts.keywordDemand.keywords.map(k => k.term);
                    const data = charts.keywordDemand.keywords.map(k => k.searches);
                    
                    new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Monthly Searches',
                                data: data,
                                backgroundColor: [
                                    'rgba(99, 102, 241, 0.8)',
                                    'rgba(16, 185, 129, 0.8)',
                                    'rgba(139, 92, 246, 0.8)',
                                    'rgba(245, 158, 11, 0.8)',
                                    'rgba(236, 72, 153, 0.8)'
                                ],
                                borderColor: [
                                    '#6366F1',
                                    '#10B981',
                                    '#8B5CF6',
                                    '#F59E0B',
                                    '#EC4899'
                                ],
                                borderWidth: 2
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: true,
                            plugins: {
                                legend: { display: false },
                                title: { display: false }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    title: { 
                                        display: true, 
                                        text: 'Monthly Searches', 
                                        font: { size: 14 }
                                    }
                                },
                                x: {
                                    ticks: {
                                        maxRotation: 45,
                                        minRotation: 45
                                    }
                                }
                            }
                        }
                    });
                }
            }
        }
        
        // Initialize Chat UI
        function initializeChatUI() {
            const chatContent = document.getElementById('chat');
            chatContent.innerHTML = `
                <div class="chat-container">
                    <div class="chat-messages" id="chat-messages">
                        <div class="chat-welcome">
                            <i class="fas fa-comments"></i>
                            <h3>Welcome to AI Chat</h3>
                            <p>Ask me anything about this specification. I can help explain, clarify, or provide more details about any section.</p>
                            <p style="font-size: 14px; color: #999; margin-top: 10px;">Demo Mode - Chat is available to everyone without login</p>
                        </div>
                    </div>
                    <div class="chat-input-container">
                        <input type="text" class="chat-input" id="chat-input" placeholder="Ask a question about the specification..." />
                        <button class="chat-send-btn" onclick="sendChatMessage()">
                            <i class="fas fa-paper-plane"></i> Send
                        </button>
                    </div>
                </div>
            `;
            
            // Allow Enter key to send
            const input = document.getElementById('chat-input');
            if (input) {
                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendChatMessage();
                    }
                });
            }
        }

        // Send chat message
        async function sendChatMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            
            if (!message) return;
            
            if (!chatInitialized) {
                // No need to initialize - we can send directly
                chatInitialized = true;
            }
            
            // Add user message to UI
            addChatMessage('user', message);
            input.value = '';
            
            // Show loading
            showChatLoading('AI is thinking...');
            
            try {
                const response = await fetch(`${window.API_BASE_URL || 'http://localhost:3002'}/api/chat/demo`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        threadId: chatThreadId,
                        assistantId: chatAssistantId,
                        message: message
                    })
                });
                
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || 'Failed to get response');
                }
                
                const data = await response.json();
                
                // Store thread and assistant IDs
                if (data.threadId) {
                    chatThreadId = data.threadId;
                }
                if (data.assistantId) {
                    chatAssistantId = data.assistantId;
                }
                
                // Add assistant response to UI
                addChatMessage('assistant', data.response);
                
            } catch (error) {
                console.error('Error sending message:', error);
                addChatMessage('assistant', 'Sorry, I encountered an error: ' + error.message);
            } finally {
                hideChatLoading();
            }
        }

        // Add chat message to UI
        function addChatMessage(role, content) {
            const messagesContainer = document.getElementById('chat-messages');
            if (!messagesContainer) return;
            
            // Remove welcome message
            const welcome = messagesContainer.querySelector('.chat-welcome');
            if (welcome) {
                welcome.remove();
            }
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${role}`;
            
            const bubble = document.createElement('div');
            bubble.className = 'chat-message-bubble';
            
            // Parse markdown if available
            if (typeof marked !== 'undefined') {
                bubble.innerHTML = marked.parse(content);
            } else {
                bubble.textContent = content;
            }
            
            messageDiv.appendChild(bubble);
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Show chat loading
        function showChatLoading(message) {
            const container = document.getElementById('chat-messages');
            const loadingDiv = document.createElement('div');
            loadingDiv.className = 'chat-message assistant';
            loadingDiv.id = 'chat-loading';
            loadingDiv.innerHTML = `
                <div class="chat-message-bubble">
                    <i class="fas fa-spinner fa-spin"></i> ${message}
                </div>
            `;
            container.appendChild(loadingDiv);
            container.scrollTop = container.scrollHeight;
        }

        // Hide chat loading
        function hideChatLoading() {
            const loading = document.getElementById('chat-loading');
            if (loading) {
                loading.remove();
            }
        }

        // Tab switching
        document.querySelectorAll('.spec-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const targetTab = this.getAttribute('data-tab');
                
                // Update tabs
                document.querySelectorAll('.spec-tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                // Update content
                document.querySelectorAll('.spec-content').forEach(c => c.classList.remove('active'));
                document.getElementById(targetTab).classList.add('active');
                
                // Initialize mermaid if viewing diagrams
                if (targetTab === 'diagrams') {
                    setTimeout(() => {
                        mermaid.init(undefined, document.querySelectorAll('#diagrams .mermaid'));
                    }, 100);
                }
            });
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', loadSpec);

        // Auth UI functions
        function updateAuthUI(user) {
            const authButtons = document.getElementById('auth-buttons');
            if (!authButtons) return;
            
            if (user) {
                // User is logged in
                const displayName = user.displayName || user.email.split('@')[0];
                const firstLetter = displayName.charAt(0).toUpperCase();
                
                authButtons.innerHTML = `
                    <a href="/pages/profile.html" class="user-info" style="text-decoration: none;">
                        <div class="user-avatar">${firstLetter}</div>
                        <span>${displayName}</span>
                    </a>
                `;
            } else {
                // User is not logged in
                authButtons.innerHTML = `
                    <button class="auth-btn" onclick="window.location.href='/pages/auth.html'">Login</button>
                `;
            }
        }

        // Global auth functions
        window.showLoginModal = function() {
            window.location.href = '/pages/auth.html';
        };

        window.logout = function() {
            auth.signOut()
                .then(() => {
                    console.log('Logged out successfully');
                })
                .catch(error => {
                    console.error('Error logging out:', error);
                });
        };

        // Listen to auth state changes
        auth.onAuthStateChanged((user) => {
            updateAuthUI(user);
        });

        // Initialize auth buttons with default state
        document.addEventListener('DOMContentLoaded', function() {
            const authButtons = document.getElementById('auth-buttons');
            if (authButtons && !authButtons.innerHTML.trim()) {
                authButtons.innerHTML = `
                    <button class="auth-btn" onclick="window.location.href='/pages/auth.html'">Login</button>
                `;
            }
        });
    </script>
    
    <!-- Credits Display Script -->
    <script src="/assets/js/credits-display.js"></script>
</body>
</html>

