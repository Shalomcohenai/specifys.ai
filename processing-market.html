<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Analyze your app idea's market potential with specifys.ai.">
  <meta name="keywords" content="market research, app idea, specifys.ai">
  <meta name="author" content="specifys.ai Team">
  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow">
  <meta name="bingbot" content="index, follow">
  <meta name="revisit-after" content="7 days">
  <meta name="language" content="English">
  <meta name="copyright" content="© 2025 specifys.ai">
  <meta name="publisher" content="specifys.ai">
  <meta name="distribution" content="global">
  <meta name="rating" content="general">
  <meta name="theme-color" content="#0078d4">
  <meta property="og:title" content="specifys.ai - Market Research Mode">
  <meta property="og:description" content="Analyze your app idea's market potential with specifys.ai.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://specifys.ai/processing-market.html">
  <meta property="og:image" content="https://specifys.ai/assets/og-image.jpg">
  <meta property="og:image:alt" content="Market Research Mode with specifys.ai">
  <meta property="og:site_name" content="Specifys.ai">
  <meta property="og:locale" content="en_US">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="specifys.ai - Market Research Mode">
  <meta name="twitter:description" content="Analyze your app idea's market potential with specifys.ai.">
  <meta name="twitter:image" content="https://specifys.ai/assets/og-image.jpg">
  <meta name="twitter:site" content="@specifys_ai">
  <meta name="twitter:creator" content="@specifys_ai">
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "headline": "specifys.ai - Market Research Mode",
      "description": "Analyze your app idea's market potential with specifys.ai.",
      "image": "https://specifys.ai/assets/og-image.jpg",
      "author": {
        "@type": "Organization",
        "name": "specifys.ai Team"
      },
      "publisher": {
        "@type": "Organization",
        "name": "Specifys.ai",
        "logo": {
          "@type": "ImageObject",
          "url": "https://specifys.ai/assets/logo.png"
        }
      },
      "url": "https://specifys.ai/processing-market.html",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://specifys.ai/processing-market.html"
      },
      "keywords": "market research, app idea, specifys.ai"
    }
  </script>
  <title>specifys.ai - Market Research Mode</title>
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <script defer src="https://unpkg.com/jspdf@latest/dist/jspdf.umd.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <script defer src="processing-market.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;700&display=swap');

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      height: 100%;
    }

    body {
      font-family: 'Montserrat', sans-serif;
      display: flex;
      flex-direction: column;
      min-height: 100%;
      background: #f5f5f5;
      overflow-x: hidden;
    }

    .thematic-header {
      position: fixed;
      top: 0;
      width: 100%;
      padding: 15px 20px;
      display: flex;
      justify-content: center;
      z-index: 1000;
      background: rgba(255, 255, 255, 0.9);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .thematic-header .logo a {
      text-decoration: none;
      color: #333;
      font-size: 1.6rem;
      font-weight: 700;
      transition: color 0.3s ease;
    }

    .thematic-header .logo a:hover {
      color: #0078d4;
    }

    .carousel-container {
      flex-grow: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 5rem 1rem;
      position: relative;
    }

    .carousel-content {
      background: #fff;
      border-radius: 20px;
      padding: 2rem;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      width: 100%;
      max-width: 900px;
      min-height: 400px;
      z-index: 1000;
      position: relative;
    }

    .step-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    #stepTitle {
      font-size: 2.2rem;
      font-weight: 700;
      color: #333;
      margin-bottom: 1rem;
      transition: color 0.3s ease;
    }

    #stepTitle:hover {
      color: #0078d4;
    }

    .question-wrapper {
      display: flex;
      align-items: center;
      width: 100%;
      justify-content: center;
      position: relative;
      margin-bottom: 1.5rem;
    }

    .question-label {
      font-size: 1.2rem;
      color: #333;
      line-height: 1.5;
      flex: 1;
    }

    .tip-icon {
      color: #666;
      font-size: 1.4rem;
      cursor: pointer;
      margin-left: 0.8rem;
      transition: color 0.3s ease, transform 0.3s ease;
    }

    .tip-icon:hover {
      color: #0078d4;
      transform: scale(1.2);
    }

    .tip-tooltip {
      display: none;
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      font-size: 0.85rem;
      color: #fff;
      background: #333;
      padding: 0.8rem;
      border-radius: 8px;
      width: 90%;
      max-width: 400px;
      text-align: left;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      z-index: 10;
      max-height: 200px;
      overflow-y: auto;
    }

    .tip-icon:hover + .tip-tooltip,
    .tip-tooltip:hover {
      display: block;
    }

    .close-tip {
      position: absolute;
      top: 5px;
      right: 10px;
      font-size: 1.2rem;
      cursor: pointer;
      color: #fff;
    }

    .step-textarea {
      width: 100%;
      min-height: 160px;
      padding: 1rem;
      border: 2px solid #ddd;
      border-radius: 12px;
      font-size: 1rem;
      resize: vertical;
      background: #fff;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
    }

    .step-textarea:focus {
      outline: none;
      border-color: #0078d4;
      box-shadow: 0 0 8px rgba(0, 120, 212, 0.2);
    }

    .example-button {
      background: #fff;
      color: #333;
      border: 2px solid #ddd;
      border-radius: 20px;
      padding: 0.5rem 1.2rem;
      font-size: 0.9rem;
      font-weight: 700;
      cursor: pointer;
      transition: background-color 0.3s ease, color 0.3s ease, transform 0.3s ease;
      margin-top: 0.5rem;
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
    }

    .example-button:hover {
      background: #0078d4;
      color: #fff;
      border-color: #0078d4;
      transform: translateY(-2px);
    }

    .example-button i {
      font-size: 0.9rem;
    }

    .char-count {
      font-size: 0.85rem;
      color: #666;
      margin-top: 0.5rem;
      align-self: flex-end;
    }

    .error-message {
      font-size: 0.9rem;
      color: #fff;
      margin-top: 1rem;
      background-color: #d32f2f;
      padding: 0.5rem;
      border-radius: 4px;
      display: none;
    }

    .progress-container {
      width: 100%;
      margin: 2rem 0;
    }

    .progress-bar {
      width: 100%;
      background: #ddd;
      border-radius: 12px;
      overflow: hidden;
      height: 12px;
      box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
    }

    .progress-fill {
      height: 100%;
      background: #0078d4;
      transition: width 0.5s ease;
    }

    .discipline-indicators {
      display: flex;
      justify-content: space-around;
      margin-top: 1.2rem;
      flex-wrap: wrap;
      gap: 0.8rem;
    }

    .indicator-item {
      display: flex;
      align-items: center;
      margin: 0.5rem;
      color: #333;
      font-size: 0.9rem;
      font-weight: 600;
    }

    .indicator-circle {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: #ddd;
      margin-right: 0.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-color 0.3s ease;
    }

    .indicator-circle.active {
      background: #0078d4;
    }

    .indicator-circle::before {
      font-family: 'Font Awesome 6 Free';
      font-weight: 900;
      color: #fff;
      font-size: 1rem;
    }

    #name-indicator::before { content: '\f111'; }
    #description-indicator::before { content: '\f15c'; }
    #features-indicator::before { content: '\f0c3'; }

    .carousel-button-left, .carousel-button-right, .generate-spec-button {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: #0078d4;
      color: #fff;
      border: none;
      border-radius: 50%;
      width: 45px;
      height: 45px;
      font-size: 1.4rem;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      z-index: 1100;
    }

    .carousel-button-left {
      left: -22.5px;
    }

    .carousel-button-right {
      right: -22.5px;
    }

    .carousel-button-left:hover, .carousel-button-right:hover, .generate-spec-button:hover {
      background: #005ea2;
      transform: translateY(-50%) translateY(-3px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }

    .generate-spec-button {
      right: -22.5px;
    }

    .generate-spec-button:disabled {
      background: #ddd;
      color: #666;
      cursor: not-allowed;
      transform: translateY(-50%);
      box-shadow: none;
    }

    .loading-spinner {
      position: absolute;
      top: 50%;
      right: -22.5px;
      transform: translateY(-50%);
      width: 45px;
      height: 45px;
      border: 4px solid #f3f3f3;
      border-top: 4px solid #0078d4;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      display: none;
      z-index: 1100;
    }

    @keyframes spin {
      0% { transform: translateY(-50%) rotate(0deg); }
      100% { transform: translateY(-50%) rotate(360deg); }
    }

    footer {
      padding: 20px;
      text-align: center;
      color: #333;
      flex-shrink: 0;
      background: #fff;
      box-shadow: 0 -2px 4px rgba(0, 0, 0, 0.1);
    }

    .footer-content {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
      gap: 15px;
      margin-bottom: 10px;
    }

    .footer-links a {
      color: #333;
      text-decoration: none;
      font-weight: 600;
      margin: 0 10px;
      transition: color 0.3s ease;
    }

    .footer-links a:hover {
      color: #0078d4;
    }

    .footer-divider {
      color: #333;
      font-size: 1.2rem;
      font-weight: 300;
    }

    .footer-social a {
      color: #333;
      font-size: 1.2rem;
      margin: 0 10px;
      transition: color 0.3s ease, transform 0.3s ease;
    }

    .footer-social a:hover {
      color: #0078d4;
      transform: scale(1.2);
    }

    .footer-copyright {
      font-size: 0.9rem;
      color: #666;
      margin-top: 10px;
    }

    @media (max-width: 768px) {
      .thematic-header .logo a {
        font-size: 1.4rem;
      }

      .carousel-content {
        padding: 1.5rem;
        min-height: 350px;
        max-width: 95%;
      }

      #stepTitle {
        font-size: 1.8rem;
      }

      .question-label {
        font-size: 1rem;
      }

      .tip-icon {
        font-size: 1.2rem;
      }

      .tip-tooltip {
        font-size: 0.8rem;
        padding: 0.6rem;
        width: 95%;
      }

      .step-textarea {
        min-height: 140px;
        font-size: 0.9rem;
      }

      .char-count {
        font-size: 0.8rem;
      }

      .carousel-button-left, .carousel-button-right, .generate-spec-button {
        width: 40px;
        height: 40px;
        font-size: 1.2rem;
      }

      .carousel-button-left {
        left: -20px;
      }

      .carousel-button-right, .generate-spec-button {
        right: -20px;
      }

      .progress-bar {
        height: 10px;
      }

      .indicator-item {
        font-size: 0.8rem;
      }

      .indicator-circle {
        width: 20px;
        height: 20px;
      }

      .indicator-circle::before {
        font-size: 0.9rem;
      }

      .loading-spinner {
        width: 40px;
        height: 40px;
        right: -20px;
      }

      .footer-content {
        flex-direction: column;
        gap: 10px;
      }
    }

    @media (max-width: 480px) {
      .thematic-header .logo a {
        font-size: 1.2rem;
      }

      .carousel-container {
        padding: 4rem 0.5rem;
      }

      .carousel-content {
        padding: 1rem;
        min-height: 300px;
      }

      #stepTitle {
        font-size: 1.6rem;
      }

      .question-label {
        font-size: 0.9rem;
      }

      .tip-icon {
        font-size: 1.1rem;
      }

      .tip-tooltip {
        font-size: 0.75rem;
        padding: 0.5rem;
        width: 95%;
      }

      .step-textarea {
        min-height: 120px;
        font-size: 0.85rem;
      }

      .char-count {
        font-size: 0.75rem;
      }

      .carousel-button-left, .carousel-button-right, .generate-spec-button {
        width: 35px;
        height: 35px;
        font-size: 1rem;
      }

      .carousel-button-left {
        left: -17.5px;
      }

      .carousel-button-right, .generate-spec-button {
        right: -17.5px;
      }

      .indicator-item {
        font-size: 0.75rem;
      }

      .indicator-circle {
        width: 18px;
        height: 18px;
      }

      .indicator-circle::before {
        font-size: 0.8rem;
      }

      .loading-spinner {
        width: 35px;
        height: 35px;
        right: -17.5px;
      }

      .footer-content {
        gap: 5px;
      }
    }

    @media (prefers-reduced-motion: reduce) {
      .carousel-button-left, .carousel-button-right, .generate-spec-button, .tip-icon, .example-button, .loading-spinner {
        animation: none;
        transition: none;
      }
    }
  </style>
</head>
<body class="page-default market">
  <header class="thematic-header" role="banner">
    <div class="logo">
      <a href="index.html" aria-label="specifys.ai homepage">specifys.ai</a>
    </div>
  </header>

  <div class="carousel-container">
    <div id="carouselContent" class="carousel-content">
      <button id="prevButton" class="carousel-button-left" onclick="prevStep()" aria-label="Previous step" style="display: none;">
        <i class="fas fa-arrow-left"></i>
      </button>
      <div class="step-container">
        <h3 id="stepTitle">Name</h3>
        <div class="question-wrapper">
          <p id="stepQuestion" class="question-label"></p>
          <i class="fas fa-lightbulb tip-icon" aria-label="Show tip"></i>
          <div id="tipText0" class="tip-tooltip"><span class="close-tip" onclick="this.parentElement.style.display='none'">×</span></div>
        </div>
        <textarea id="stepTextarea0" class="step-textarea" maxlength="2500" placeholder="Enter your app name and platform..." aria-label="Answer the current question"></textarea>
        <span id="charCount0" class="char-count">0/2500</span>
        <button id="exampleButton0" class="example-button" onmouseover="showExample(0)" onmouseout="restoreAnswer(0)" aria-label="Show example answer">
          <i class="fas fa-eye"></i> Example
        </button>
        <div id="errorMessage0" class="error-message" role="alert"></div>
        <div class="progress-container">
          <div class="progress-bar">
            <div class="progress-fill"></div>
          </div>
          <div class="discipline-indicators" role="group" aria-label="Progress indicators by category">
            <div class="indicator-item">
              <span class="indicator-circle" id="name-indicator" aria-label="Name progress"></span>
              <span>Name</span>
            </div>
            <div class="indicator-item">
              <span class="indicator-circle" id="description-indicator" aria-label="Description progress"></span>
              <span>Description</span>
            </div>
            <div class="indicator-item">
              <span class="indicator-circle" id="features-indicator" aria-label="Features progress"></span>
              <span>Features</span>
            </div>
          </div>
        </div>
      </div>
      <div class="step-container" style="display: none;">
        <h3 id="stepTitle">Description</h3>
        <div class="question-wrapper">
          <p id="stepQuestion" class="question-label"></p>
          <i class="fas fa-lightbulb tip-icon" aria-label="Show tip"></i>
          <div id="tipText1" class="tip-tooltip"><span class="close-tip" onclick="this.parentElement.style.display='none'">×</span></div>
        </div>
        <textarea id="stepTextarea1" class="step-textarea" maxlength="2500" placeholder="Enter your app description, features, and audience..." aria-label="Answer the current question"></textarea>
        <span id="charCount1" class="char-count">0/2500</span>
        <button id="exampleButton1" class="example-button" onmouseover="showExample(1)" onmouseout="restoreAnswer(1)" aria-label="Show example answer">
          <i class="fas fa-eye"></i> Example
        </button>
        <div id="errorMessage1" class="error-message" role="alert"></div>
        <div class="progress-container">
          <div class="progress-bar">
            <div class="progress-fill"></div>
          </div>
          <div class="discipline-indicators" role="group" aria-label="Progress indicators by category">
            <div class="indicator-item">
              <span class="indicator-circle" id="name-indicator" aria-label="Name progress"></span>
              <span>Name</span>
            </div>
            <div class="indicator-item">
              <span class="indicator-circle" id="description-indicator" aria-label="Description progress"></span>
              <span>Description</span>
            </div>
            <div class="indicator-item">
              <span class="indicator-circle" id="features-indicator" aria-label="Features progress"></span>
              <span>Features</span>
            </div>
          </div>
        </div>
      </div>
      <div class="step-container" style="display: none;">
        <h3 id="stepTitle">Features</h3>
        <div class="question-wrapper">
          <p id="stepQuestion" class="question-label"></p>
          <i class="fas fa-lightbulb tip-icon" aria-label="Show tip"></i>
          <div id="tipText2" class="tip-tooltip"><span class="close-tip" onclick="this.parentElement.style.display='none'">×</span></div>
        </div>
        <textarea id="stepTextarea2" class="step-textarea" maxlength="2500" placeholder="Enter your app’s key features..." aria-label="Answer the current question"></textarea>
        <span id="charCount2" class="char-count">0/2500</span>
        <button id="exampleButton2" class="example-button" onmouseover="showExample(2)" onmouseout="restoreAnswer(2)" aria-label="Show example answer">
          <i class="fas fa-eye"></i> Example
        </button>
        <div id="errorMessage2" class="error-message" role="alert"></div>
        <div class="progress-container">
          <div class="progress-bar">
            <div class="progress-fill"></div>
          </div>
          <div class="discipline-indicators" role="group" aria-label="Progress indicators by category">
            <div class="indicator-item">
              <span class="indicator-circle" id="name-indicator" aria-label="Name progress"></span>
              <span>Name</span>
            </div>
            <div class="indicator-item">
              <span class="indicator-circle" id="description-indicator" aria-label="Description progress"></span>
              <span>Description</span>
            </div>
            <div class="indicator-item">
              <span class="indicator-circle" id="features-indicator" aria-label="Features progress"></span>
              <span>Features</span>
            </div>
          </div>
        </div>
      </div>
      <button id="nextButton" class="carousel-button-right" onclick="nextStep()" aria-label="Next step">
        <i class="fas fa-arrow-right"></i>
      </button>
      <button id="goButton" class="carousel-button-right generate-spec-button" onclick="generateSpecification()" style="display: none;" disabled aria-label="Go to generate market research">
        <i class="fas fa-rocket"></i>
      </button>
      <div id="loadingSpinner" class="loading-spinner"></div>
    </div>
  </div>

  <footer>
    <div class="footer-content">
      <div class="footer-links">
        <a href="how.html" aria-label="Learn how specifys.ai works">How It Works</a>
        <a href="about.html" aria-label="Learn more about specifys.ai">About Us</a>
        <a href="/blog.html" aria-label="Visit our blog">Blog</a>
        <a href="map/vibe-coding-tools-map.html" aria-label="Explore Vibe Coding Tools Map">Vibe Coding Tools Map</a>
      </div>
      <span class="footer-divider">|</span>
      <div class="footer-social">
        <a href="https://www.linkedin.com/company/specifys-ai/" aria-label="Follow us on LinkedIn"><i class="fab fa-linkedin-in"></i></a>
        <a href="https://www.facebook.com/profile.php?id=61576402600129&locale=he_IL" target="_blank" aria-label="Follow us on Facebook"><i class="fab fa-facebook-f"></i></a>
        <a href="https://www.instagram.com/YOUR_PROFILE" aria-label="Follow us on Instagram"><i class="fab fa-instagram"></i></a>
        <a href="mailto:specifysai@gmail.com" aria-label="Send us an email"><i class="fas fa-envelope"></i></a>
        <a href="https://www.producthunt.com/products/specifys-ai" target="_blank" aria-label="Check us out on Product Hunt"><i class="fab fa-product-hunt"></i></a>
      </div>
    </div>
    <div class="footer-copyright">
      © 2025 specifys.ai. All rights reserved.
    </div>
  </footer>

  <script>
    const stepTitles = ["Name", "Description", "Features"];

    const questions = [
      "What is the name of your app idea and which platform will it be on (e.g., iOS, Android, Web)?",
      "What is the purpose of your app, its key features, and who is the target audience (e.g., age, interests, needs)?",
      "What are the key features that make your app unique or valuable in the market?"
    ];

    const tips = [
      "Choose a clear, memorable name that reflects your app’s purpose. Specify the platform (e.g., iOS, Android, Web) to guide market analysis.",
      "Explain the core problem your app solves, list 2-3 key features, and identify the target audience (e.g., age, interests, needs).",
      "List specific features that make your app unique, such as real-time tracking, social integration, or personalized recommendations."
    ];

    const exampleAnswers = [
      "FitTrack, a mobile app for iOS and Android, focused on fitness tracking.",
      "FitTrack helps fitness enthusiasts track workouts and progress. Features: workout logging, progress charts, community challenges. Target: adults 18-40 who exercise regularly.",
      "Workout logging with voice input, real-time progress charts, social sharing, personalized plans, and integration with wearables."
    ];

    let currentStep = 0;
    const totalSteps = questions.length;
    let textareas, charCounts, prevButton, nextButton, goButton, tipTexts, exampleButtons, errorMessages, loadingSpinner;
    const storageKey = "marketAnswers";
    let answers = JSON.parse(localStorage.getItem(storageKey)) || {};
    let originalAnswers = ["", "", ""];
    const indicators = ["name-indicator", "description-indicator", "features-indicator"];

    function showExample(index) {
      originalAnswers[index] = textareas[index].value;
      textareas[index].value = exampleAnswers[index];
      charCounts[index].textContent = `${textareas[index].value.length}/2500`;
    }

    function restoreAnswer(index) {
      textareas[index].value = originalAnswers[index];
      charCounts[index].textContent = `${textareas[index].value.length}/2500`;
    }

    function updateUI() {
      document.getElementById("stepTitle").textContent = stepTitles[currentStep];
      document.getElementById("stepQuestion").textContent = questions[currentStep];
      tipTexts[currentStep].innerHTML = tips[currentStep] + '<span class="close-tip" onclick="this.parentElement.style.display=\'none\'">×</span>';
      textareas[currentStep].value = answers[currentStep] || "";
      charCounts[currentStep].textContent = `${textareas[currentStep].value.length}/2500`;

      const progress = ((currentStep + 1) / totalSteps) * 100;
      document.querySelectorAll(".progress-fill").forEach((fill) => {
        fill.style.width = `${progress}%`;
      });

      indicators.forEach((indicator, index) => {
        const element = document.getElementById(indicator);
        if (answers[index] && answers[index].trim()) {
          element.classList.add("active");
        } else {
          element.classList.remove("active");
        }
      });

      prevButton.style.display = currentStep === 0 ? "none" : "flex";
      nextButton.style.display = currentStep === totalSteps - 1 ? "none" : "flex";
      goButton.style.display = currentStep === totalSteps - 1 ? "flex" : "none";

      document.querySelectorAll(".step-container").forEach((step, index) => {
        step.style.display = index === currentStep ? "block" : "none";
      });

      const allIndicatorsGreen = indicators.every((indicator) => {
        const element = document.getElementById(indicator);
        return element.classList.contains("active");
      });
      goButton.disabled = !allIndicatorsGreen;
    }

    document.addEventListener("DOMContentLoaded", () => {
      if (localStorage.getItem("currentMode") !== "market") {
        localStorage.removeItem("processingAnswers");
        localStorage.removeItem("noCodeAnswers");
        localStorage.setItem("currentMode", "market");
        answers = {};
        localStorage.setItem(storageKey, JSON.stringify(answers));
      }

      textareas = [
        document.getElementById("stepTextarea0"),
        document.getElementById("stepTextarea1"),
        document.getElementById("stepTextarea2")
      ];
      charCounts = [
        document.getElementById("charCount0"),
        document.getElementById("charCount1"),
        document.getElementById("charCount2")
      ];
      tipTexts = [
        document.getElementById("tipText0"),
        document.getElementById("tipText1"),
        document.getElementById("tipText2")
      ];
      exampleButtons = [
        document.getElementById("exampleButton0"),
        document.getElementById("exampleButton1"),
        document.getElementById("exampleButton2")
      ];
      errorMessages = [
        document.getElementById("errorMessage0"),
        document.getElementById("errorMessage1"),
        document.getElementById("errorMessage2")
      ];
      prevButton = document.getElementById("prevButton");
      nextButton = document.getElementById("nextButton");
      goButton = document.getElementById("goButton");
      loadingSpinner = document.getElementById("loadingSpinner");

      updateUI();

      textareas.forEach((textarea, index) => {
        textarea.addEventListener("input", () => {
          answers[index] = textarea.value;
          localStorage.setItem(storageKey, JSON.stringify(answers));
          charCounts[index].textContent = `${textarea.value.length}/2500`;
          const currentIndicator = document.getElementById(indicators[index]);
          if (textarea.value.trim()) {
            currentIndicator.classList.add("active");
          } else {
            currentIndicator.classList.remove("active");
          }
          updateUI();
        });
      });
    });

    window.prevStep = function() {
      if (currentStep > 0) {
        errorMessages[currentStep].style.display = "none";
        currentStep--;
        updateUI();
      }
    };

    window.nextStep = function() {
      const textareaValue = textareas[currentStep].value.trim();
      if (!textareaValue) {
        errorMessages[currentStep].textContent = "Please answer the current question before proceeding.";
        errorMessages[currentStep].style.display = "block";
        return;
      }

      errorMessages[currentStep].style.display = "none";
      answers[currentStep] = textareaValue;
      localStorage.setItem(storageKey, JSON.stringify(answers));
      if (currentStep < totalSteps - 1) {
        currentStep++;
        updateUI();
      }
    };

    window.generateSpecification = async function() {
      const answers = JSON.parse(localStorage.getItem(storageKey)) || {};
      if (Object.keys(answers).length < totalSteps) {
        errorMessages[currentStep].textContent = "Please complete all steps before generating the market research.";
        errorMessages[currentStep].style.display = "block";
        return;
      }

      errorMessages[currentStep].style.display = "none";
      goButton.style.display = "none";
      loadingSpinner.style.display = "block";

      try {
        if (typeof window.generateSpecificationOriginal !== "function") {
          throw new Error("External script (processing-market.js) failed to load or function is missing.");
        }
        await window.generateSpecificationOriginal();
      } catch (error) {
        console.error("Error calling API:", error);
        errorMessages[currentStep].textContent = `Failed to generate market research: ${error.message}.`;
        errorMessages[currentStep].style.display = "block";
        localStorage.setItem("generatedContent", JSON.stringify(answers));
      }
      loadingSpinner.style.display = "none";
      window.location.href = "result-market.html";
    };
  </script>

  <noscript>
    <div style="text-align: center; padding: 10px; background: #fff; color: #333;">
      <p>This website requires JavaScript to function properly. Please enable JavaScript in your browser.</p>
    </div>
  </noscript>
</body>
</html>